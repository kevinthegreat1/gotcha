/*! For license information please see app.bundle.js.LICENSE.txt */
(()=>{"use strict";var e={};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}();const t=function(e){const t=[];let n=0;for(let i=0;i<e.length;i++){let r=e.charCodeAt(i);r<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=63&r|128):55296==(64512&r)&&i+1<e.length&&56320==(64512&e.charCodeAt(i+1))?(r=65536+((1023&r)<<10)+(1023&e.charCodeAt(++i)),t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=63&r|128):(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=63&r|128)}return t},n={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let t=0;t<e.length;t+=3){const r=e[t],s=t+1<e.length,o=s?e[t+1]:0,a=t+2<e.length,c=a?e[t+2]:0,u=r>>2,l=(3&r)<<4|o>>4;let h=(15&o)<<2|c>>6,d=63&c;a||(d=64,s||(h=64)),i.push(n[u],n[l],n[h],n[d])}return i.join("")},encodeString(e,n){return this.HAS_NATIVE_SUPPORT&&!n?btoa(e):this.encodeByteArray(t(e),n)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,i=0;for(;n<e.length;){const r=e[n++];if(r<128)t[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=e[n++];t[i++]=String.fromCharCode((31&r)<<6|63&s)}else if(r>239&&r<365){const s=((7&r)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[i++]=String.fromCharCode(55296+(s>>10)),t[i++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],o=e[n++];t[i++]=String.fromCharCode((15&r)<<12|(63&s)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let t=0;t<e.length;){const s=n[e.charAt(t++)],o=t<e.length?n[e.charAt(t)]:0;++t;const a=t<e.length?n[e.charAt(t)]:64;++t;const c=t<e.length?n[e.charAt(t)]:64;if(++t,null==s||null==o||null==a||null==c)throw new i;const u=s<<2|o>>4;if(r.push(u),64!==a){const e=o<<4&240|a>>2;if(r.push(e),64!==c){const e=a<<6&192|c;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class i extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const r=function(e){return function(e){const i=t(e);return n.encodeByteArray(i,!0)}(e).replace(/\./g,"")},s=function(e){try{return n.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null},o=()=>{try{return function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==e.g)return e.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if("undefined"==typeof process||void 0===process.env)return;const e=process.env.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"==typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(e){return}const t=e&&s(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`)}},a=e=>{var t,n;return null===(n=null===(t=o())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},c=e=>{const t=a(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const i=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),i]:[t.substring(0,n),i]},u=()=>{var e;return null===(e=o())||void 0===e?void 0:e.config},l=e=>{var t;return null===(t=o())||void 0===t?void 0:t[`_${e}`]};class h{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function d(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function f(){const e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function p(){try{return"object"==typeof indexedDB}catch(e){return!1}}function g(){return new Promise(((e,t)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(i),e(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var e;t((null===(e=r.error)||void 0===e?void 0:e.message)||"")}}catch(e){t(e)}}))}class m extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,m.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,y.prototype.create)}}class y{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},i=`${this.service}/${e}`,r=this.errors[e],s=r?function(e,t){return e.replace(v,((e,n)=>{const i=t[n];return null!=i?String(i):`<${n}?>`}))}(r,n):"Error",o=`${this.serviceName}: ${s} (${i}).`;return new m(i,o,n)}}const v=/\{\$([^}]+)}/g;function w(e,t){if(e===t)return!0;const n=Object.keys(e),i=Object.keys(t);for(const r of n){if(!i.includes(r))return!1;const n=e[r],s=t[r];if(I(n)&&I(s)){if(!w(n,s))return!1}else if(n!==s)return!1}for(const e of i)if(!n.includes(e))return!1;return!0}function I(e){return null!==e&&"object"==typeof e}function E(e){const t=[];for(const[n,i]of Object.entries(e))Array.isArray(i)?i.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return t.length?"&"+t.join("&"):""}function b(e){const t={};return e.replace(/^\?/,"").split("&").forEach((e=>{if(e){const[n,i]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(i)}})),t}function T(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class _{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let i;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");i=function(e,t){if("object"!=typeof e||null===e)return!1;for(const t of["next","error","complete"])if(t in e&&"function"==typeof e[t])return!0;return!1}(e)?e:{next:e,error:t,complete:n},void 0===i.next&&(i.next=C),void 0===i.error&&(i.error=C),void 0===i.complete&&(i.complete=C);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch(e){}})),this.observers.push(i),r}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function C(){}const S=1e3,k=2,A=144e5,N=.5;function D(e,t=S,n=k){const i=t*Math.pow(n,e),r=Math.round(N*i*(Math.random()-.5)*2);return Math.min(A,i+r)}function R(e){return e&&e._delegate?e._delegate:e}class O{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const P="[DEFAULT]";class L{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new h;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(e){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),i=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(e){if(i)return null;throw e}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:P})}catch(e){}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(e){}}}}clearInstance(e=P){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(e=P){return this.instances.has(e)}getOptions(e=P){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[e,t]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(e)&&t.resolve(i);return i}onInit(e,t){var n;const i=this.normalizeInstanceIdentifier(t),r=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;r.add(e),this.onInitCallbacks.set(i,r);const s=this.instances.get(i);return s&&e(s,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch(e){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(i=e,i===P?void 0:i),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch(e){}var i;return n||null}normalizeInstanceIdentifier(e=P){return this.component?this.component.multipleInstances?e:P:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class M{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new L(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const x=[];var F,U;(U=F||(F={}))[U.DEBUG=0]="DEBUG",U[U.VERBOSE=1]="VERBOSE",U[U.INFO=2]="INFO",U[U.WARN=3]="WARN",U[U.ERROR=4]="ERROR",U[U.SILENT=5]="SILENT";const V={debug:F.DEBUG,verbose:F.VERBOSE,info:F.INFO,warn:F.WARN,error:F.ERROR,silent:F.SILENT},B=F.INFO,j={[F.DEBUG]:"log",[F.VERBOSE]:"log",[F.INFO]:"info",[F.WARN]:"warn",[F.ERROR]:"error"},$=(e,t,...n)=>{if(t<e.logLevel)return;const i=(new Date).toISOString(),r=j[t];if(!r)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[r](`[${i}]  ${e.name}:`,...n)};class q{constructor(e){this.name=e,this._logLevel=B,this._logHandler=$,this._userLogHandler=null,x.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in F))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?V[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,F.DEBUG,...e),this._logHandler(this,F.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,F.VERBOSE,...e),this._logHandler(this,F.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,F.INFO,...e),this._logHandler(this,F.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,F.WARN,...e),this._logHandler(this,F.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,F.ERROR,...e),this._logHandler(this,F.ERROR,...e)}}const z=(e,t)=>t.some((t=>e instanceof t));let H,K;const G=new WeakMap,W=new WeakMap,Q=new WeakMap,J=new WeakMap,X=new WeakMap;let Y={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return W.get(e);if("objectStoreNames"===t)return e.objectStoreNames||Q.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ee(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function Z(e){return"function"==typeof e?(t=e)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(K||(K=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(te(this),e),ee(G.get(this))}:function(...e){return ee(t.apply(te(this),e))}:function(e,...n){const i=t.call(te(this),e,...n);return Q.set(i,e.sort?e.sort():[e]),ee(i)}:(e instanceof IDBTransaction&&function(e){if(W.has(e))return;const t=new Promise(((t,n)=>{const i=()=>{e.removeEventListener("complete",r),e.removeEventListener("error",s),e.removeEventListener("abort",s)},r=()=>{t(),i()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",r),e.addEventListener("error",s),e.addEventListener("abort",s)}));W.set(e,t)}(e),z(e,H||(H=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,Y):e);var t}function ee(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const i=()=>{e.removeEventListener("success",r),e.removeEventListener("error",s)},r=()=>{t(ee(e.result)),i()},s=()=>{n(e.error),i()};e.addEventListener("success",r),e.addEventListener("error",s)}));return t.then((t=>{t instanceof IDBCursor&&G.set(t,e)})).catch((()=>{})),X.set(t,e),t}(e);if(J.has(e))return J.get(e);const t=Z(e);return t!==e&&(J.set(e,t),X.set(t,e)),t}const te=e=>X.get(e),ne=["get","getKey","getAll","getAllKeys","count"],ie=["put","add","delete","clear"],re=new Map;function se(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(re.get(t))return re.get(t);const n=t.replace(/FromIndex$/,""),i=t!==n,r=ie.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!r&&!ne.includes(n))return;const s=async function(e,...t){const s=this.transaction(e,r?"readwrite":"readonly");let o=s.store;return i&&(o=o.index(t.shift())),(await Promise.all([o[n](...t),r&&s.done]))[0]};return re.set(t,s),s}var oe;oe=Y,Y={...oe,get:(e,t,n)=>se(e,t)||oe.get(e,t,n),has:(e,t)=>!!se(e,t)||oe.has(e,t)};class ae{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const ce="@firebase/app",ue="0.9.13",le=new q("@firebase/app"),he="[DEFAULT]",de={[ce]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},fe=new Map,pe=new Map;function ge(e,t){try{e.container.addComponent(t)}catch(n){le.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function me(e){const t=e.name;if(pe.has(t))return le.debug(`There were multiple attempts to register component ${t}.`),!1;pe.set(t,e);for(const t of fe.values())ge(t,e);return!0}function ye(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}const ve=new y("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class we{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new O("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ve.create("app-deleted",{appName:this._name})}}const Ie="9.23.0";function Ee(e,t={}){let n=e;"object"!=typeof t&&(t={name:t});const i=Object.assign({name:he,automaticDataCollectionEnabled:!1},t),r=i.name;if("string"!=typeof r||!r)throw ve.create("bad-app-name",{appName:String(r)});if(n||(n=u()),!n)throw ve.create("no-options");const s=fe.get(r);if(s){if(w(n,s.options)&&w(i,s.config))return s;throw ve.create("duplicate-app",{appName:r})}const o=new M(r);for(const e of pe.values())o.addComponent(e);const a=new we(n,i,o);return fe.set(r,a),a}function be(e=he){const t=fe.get(e);if(!t&&e===he&&u())return Ee();if(!t)throw ve.create("no-app",{appName:e});return t}function Te(e,t,n){var i;let r=null!==(i=de[e])&&void 0!==i?i:e;n&&(r+=`-${n}`);const s=r.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const e=[`Unable to register library "${r}" with version "${t}":`];return s&&e.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&e.push("and"),o&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void le.warn(e.join(" "))}me(new O(`${r}-version`,(()=>({library:r,version:t})),"VERSION"))}const _e="firebase-heartbeat-database",Ce=1,Se="firebase-heartbeat-store";let ke=null;function Ae(){return ke||(ke=function(e,t,{blocked:n,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(e,t),a=ee(o);return i&&o.addEventListener("upgradeneeded",(e=>{i(ee(o.result),e.oldVersion,e.newVersion,ee(o.transaction),e)})),n&&o.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),a.then((e=>{s&&e.addEventListener("close",(()=>s())),r&&e.addEventListener("versionchange",(e=>r(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),a}(_e,Ce,{upgrade:(e,t)=>{0===t&&e.createObjectStore(Se)}}).catch((e=>{throw ve.create("idb-open",{originalErrorMessage:e.message})}))),ke}async function Ne(e,t){try{const n=(await Ae()).transaction(Se,"readwrite"),i=n.objectStore(Se);await i.put(t,De(e)),await n.done}catch(e){if(e instanceof m)le.warn(e.message);else{const t=ve.create("idb-set",{originalErrorMessage:null==e?void 0:e.message});le.warn(t.message)}}}function De(e){return`${e.name}!${e.options.appId}`}class Re{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Pe(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),t=Oe();if(null===this._heartbeatsCache&&(this._heartbeatsCache=await this._heartbeatsCachePromise),this._heartbeatsCache.lastSentHeartbeatDate!==t&&!this._heartbeatsCache.heartbeats.some((e=>e.date===t)))return this._heartbeatsCache.heartbeats.push({date:t,agent:e}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null===this._heartbeatsCache||0===this._heartbeatsCache.heartbeats.length)return"";const e=Oe(),{heartbeatsToSend:t,unsentEntries:n}=function(e,t=1024){const n=[];let i=e.slice();for(const r of e){const e=n.find((e=>e.agent===r.agent));if(e){if(e.dates.push(r.date),Le(n)>t){e.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),Le(n)>t){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}(this._heartbeatsCache.heartbeats),i=r(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}}function Oe(){return(new Date).toISOString().substring(0,10)}class Pe{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!p()&&g().then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=await Ae();return await t.transaction(Se).objectStore(Se).get(De(e))}catch(e){if(e instanceof m)le.warn(e.message);else{const t=ve.create("idb-get",{originalErrorMessage:null==e?void 0:e.message});le.warn(t.message)}}}(this.app);return e||{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return Ne(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return Ne(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function Le(e){return r(JSON.stringify({version:2,heartbeats:e})).length}me(new O("platform-logger",(e=>new ae(e)),"PRIVATE")),me(new O("heartbeat",(e=>new Re(e)),"PRIVATE")),Te(ce,ue,""),Te(ce,ue,"esm2017"),Te("fire-js",""),Te("firebase","9.23.0","app");const Me=(e,t)=>t.some((t=>e instanceof t));let xe,Fe;const Ue=new WeakMap,Ve=new WeakMap,Be=new WeakMap,je=new WeakMap,$e=new WeakMap;let qe={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return Ve.get(e);if("objectStoreNames"===t)return e.objectStoreNames||Be.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return He(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function ze(e){return"function"==typeof e?(t=e)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(Fe||(Fe=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(Ke(this),e),He(Ue.get(this))}:function(...e){return He(t.apply(Ke(this),e))}:function(e,...n){const i=t.call(Ke(this),e,...n);return Be.set(i,e.sort?e.sort():[e]),He(i)}:(e instanceof IDBTransaction&&function(e){if(Ve.has(e))return;const t=new Promise(((t,n)=>{const i=()=>{e.removeEventListener("complete",r),e.removeEventListener("error",s),e.removeEventListener("abort",s)},r=()=>{t(),i()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",r),e.addEventListener("error",s),e.addEventListener("abort",s)}));Ve.set(e,t)}(e),Me(e,xe||(xe=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,qe):e);var t}function He(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const i=()=>{e.removeEventListener("success",r),e.removeEventListener("error",s)},r=()=>{t(He(e.result)),i()},s=()=>{n(e.error),i()};e.addEventListener("success",r),e.addEventListener("error",s)}));return t.then((t=>{t instanceof IDBCursor&&Ue.set(t,e)})).catch((()=>{})),$e.set(t,e),t}(e);if(je.has(e))return je.get(e);const t=ze(e);return t!==e&&(je.set(e,t),$e.set(t,e)),t}const Ke=e=>$e.get(e),Ge=["get","getKey","getAll","getAllKeys","count"],We=["put","add","delete","clear"],Qe=new Map;function Je(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(Qe.get(t))return Qe.get(t);const n=t.replace(/FromIndex$/,""),i=t!==n,r=We.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!r&&!Ge.includes(n))return;const s=async function(e,...t){const s=this.transaction(e,r?"readwrite":"readonly");let o=s.store;return i&&(o=o.index(t.shift())),(await Promise.all([o[n](...t),r&&s.done]))[0]};return Qe.set(t,s),s}qe=(e=>({...e,get:(t,n,i)=>Je(t,n)||e.get(t,n,i),has:(t,n)=>!!Je(t,n)||e.has(t,n)}))(qe);const Xe="@firebase/installations",Ye="0.6.4",Ze=1e4,et=`w:${Ye}`,tt="FIS_v2",nt="https://firebaseinstallations.googleapis.com/v1",it=36e5,rt=new y("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function st(e){return e instanceof m&&e.code.includes("request-failed")}function ot({projectId:e}){return`${nt}/projects/${e}/installations`}function at(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}async function ct(e,t){const n=(await t.json()).error;return rt.create("request-failed",{requestName:e,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function ut({apiKey:e}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}async function lt(e){const t=await e();return t.status>=500&&t.status<600?e():t}function ht(e){return new Promise((t=>{setTimeout(t,e)}))}const dt=/^[cdef][\w-]{21}$/,ft="";function pt(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const t=function(e){var t;return(t=e,btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22)}(e);return dt.test(t)?t:ft}catch(e){return ft}}function gt(e){return`${e.appName}!${e.appId}`}const mt=new Map;function yt(e,t){const n=gt(e);vt(n,t),function(e,t){const n=(!wt&&"BroadcastChannel"in self&&(wt=new BroadcastChannel("[Firebase] FID Change"),wt.onmessage=e=>{vt(e.data.key,e.data.fid)}),wt);n&&n.postMessage({key:e,fid:t}),0===mt.size&&wt&&(wt.close(),wt=null)}(n,t)}function vt(e,t){const n=mt.get(e);if(n)for(const e of n)e(t)}let wt=null;const It="firebase-installations-database",Et=1,bt="firebase-installations-store";let Tt=null;function _t(){return Tt||(Tt=function(e,t,{blocked:n,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(e,t),a=He(o);return i&&o.addEventListener("upgradeneeded",(e=>{i(He(o.result),e.oldVersion,e.newVersion,He(o.transaction))})),n&&o.addEventListener("blocked",(()=>n())),a.then((e=>{s&&e.addEventListener("close",(()=>s())),r&&e.addEventListener("versionchange",(()=>r()))})).catch((()=>{})),a}(It,Et,{upgrade:(e,t)=>{0===t&&e.createObjectStore(bt)}})),Tt}async function Ct(e,t){const n=gt(e),i=(await _t()).transaction(bt,"readwrite"),r=i.objectStore(bt),s=await r.get(n);return await r.put(t,n),await i.done,s&&s.fid===t.fid||yt(e,t.fid),t}async function St(e){const t=gt(e),n=(await _t()).transaction(bt,"readwrite");await n.objectStore(bt).delete(t),await n.done}async function kt(e,t){const n=gt(e),i=(await _t()).transaction(bt,"readwrite"),r=i.objectStore(bt),s=await r.get(n),o=t(s);return void 0===o?await r.delete(n):await r.put(o,n),await i.done,!o||s&&s.fid===o.fid||yt(e,o.fid),o}async function At(e){let t;const n=await kt(e.appConfig,(n=>{const i=function(e){return Rt(e||{fid:pt(),registrationStatus:0})}(n),r=function(e,t){if(0===t.registrationStatus){if(!navigator.onLine)return{installationEntry:t,registrationPromise:Promise.reject(rt.create("app-offline"))};const n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},i=async function(e,t){try{const n=await async function({appConfig:e,heartbeatServiceProvider:t},{fid:n}){const i=ot(e),r=ut(e),s=t.getImmediate({optional:!0});if(s){const e=await s.getHeartbeatsHeader();e&&r.append("x-firebase-client",e)}const o={fid:n,authVersion:tt,appId:e.appId,sdkVersion:et},a={method:"POST",headers:r,body:JSON.stringify(o)},c=await lt((()=>fetch(i,a)));if(c.ok){const e=await c.json();return{fid:e.fid||n,registrationStatus:2,refreshToken:e.refreshToken,authToken:at(e.authToken)}}throw await ct("Create Installation",c)}(e,t);return Ct(e.appConfig,n)}catch(n){throw st(n)&&409===n.customData.serverCode?await St(e.appConfig):await Ct(e.appConfig,{fid:t.fid,registrationStatus:0}),n}}(e,n);return{installationEntry:n,registrationPromise:i}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:Nt(e)}:{installationEntry:t}}(e,i);return t=r.registrationPromise,r.installationEntry}));return n.fid===ft?{installationEntry:await t}:{installationEntry:n,registrationPromise:t}}async function Nt(e){let t=await Dt(e.appConfig);for(;1===t.registrationStatus;)await ht(100),t=await Dt(e.appConfig);if(0===t.registrationStatus){const{installationEntry:t,registrationPromise:n}=await At(e);return n||t}return t}function Dt(e){return kt(e,(e=>{if(!e)throw rt.create("installation-not-found");return Rt(e)}))}function Rt(e){return 1===(t=e).registrationStatus&&t.registrationTime+Ze<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t}async function Ot({appConfig:e,heartbeatServiceProvider:t},n){const i=function(e,{fid:t}){return`${ot(e)}/${t}/authTokens:generate`}(e,n),r=function(e,{refreshToken:t}){const n=ut(e);return n.append("Authorization",function(e){return`${tt} ${e}`}(t)),n}(e,n),s=t.getImmediate({optional:!0});if(s){const e=await s.getHeartbeatsHeader();e&&r.append("x-firebase-client",e)}const o={installation:{sdkVersion:et,appId:e.appId}},a={method:"POST",headers:r,body:JSON.stringify(o)},c=await lt((()=>fetch(i,a)));if(c.ok)return at(await c.json());throw await ct("Generate Auth Token",c)}async function Pt(e,t=!1){let n;const i=await kt(e.appConfig,(i=>{if(!Mt(i))throw rt.create("not-registered");const r=i.authToken;if(!t&&(2===(s=r).requestStatus&&!function(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+it}(s)))return i;var s;if(1===r.requestStatus)return n=async function(e,t){let n=await Lt(e.appConfig);for(;1===n.authToken.requestStatus;)await ht(100),n=await Lt(e.appConfig);const i=n.authToken;return 0===i.requestStatus?Pt(e,t):i}(e,t),i;{if(!navigator.onLine)throw rt.create("app-offline");const t=function(e){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}(i);return n=async function(e,t){try{const n=await Ot(e,t),i=Object.assign(Object.assign({},t),{authToken:n});return await Ct(e.appConfig,i),n}catch(n){if(!st(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});await Ct(e.appConfig,n)}else await St(e.appConfig);throw n}}(e,t),t}}));return n?await n:i.authToken}function Lt(e){return kt(e,(e=>{if(!Mt(e))throw rt.create("not-registered");return 1===(t=e.authToken).requestStatus&&t.requestTime+Ze<Date.now()?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e;var t}))}function Mt(e){return void 0!==e&&2===e.registrationStatus}function xt(e){return rt.create("missing-app-config-values",{valueName:e})}const Ft="installations";me(new O(Ft,(e=>{const t=e.getProvider("app").getImmediate(),n=function(e){if(!e||!e.options)throw xt("App Configuration");if(!e.name)throw xt("App Name");const t=["projectId","apiKey","appId"];for(const n of t)if(!e.options[n])throw xt(n);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:n,heartbeatServiceProvider:ye(t,"heartbeat"),_delete:()=>Promise.resolve()}}),"PUBLIC")),me(new O("installations-internal",(e=>{const t=ye(e.getProvider("app").getImmediate(),Ft).getImmediate();return{getId:()=>async function(e){const t=e,{installationEntry:n,registrationPromise:i}=await At(t);return i?i.catch(console.error):Pt(t).catch(console.error),n.fid}(t),getToken:e=>async function(e,t=!1){const n=e;return await async function(e){const{registrationPromise:t}=await At(e);t&&await t}(n),(await Pt(n,t)).token}(t,e)}}),"PRIVATE")),Te(Xe,Ye),Te(Xe,Ye,"esm2017");const Ut="analytics",Vt="firebase_id",Bt="origin",jt=6e4,$t="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",qt="https://www.googletagmanager.com/gtag/js",zt=new q("@firebase/analytics"),Ht=new y("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."});function Kt(e){if(!e.startsWith(qt)){const t=Ht.create("invalid-gtag-resource",{gtagURL:e});return zt.warn(t.message),""}return e}function Gt(e){return Promise.all(e.map((e=>e.catch((e=>e)))))}const Wt=30,Qt=new class{constructor(e={},t=1e3){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};function Jt(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}async function Xt(e,t=Qt,n){const{appId:i,apiKey:r,measurementId:s}=e.options;if(!i)throw Ht.create("no-app-id");if(!r){if(s)return{measurementId:s,appId:i};throw Ht.create("no-api-key")}const o=t.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new Zt;return setTimeout((async()=>{a.abort()}),void 0!==n?n:jt),Yt({appId:i,apiKey:r,measurementId:s},o,a,t)}async function Yt(e,{throttleEndTimeMillis:t,backoffCount:n},i,r=Qt){var s;const{appId:o,measurementId:a}=e;try{await function(e,t){return new Promise(((n,i)=>{const r=Math.max(t-Date.now(),0),s=setTimeout(n,r);e.addEventListener((()=>{clearTimeout(s),i(Ht.create("fetch-throttle",{throttleEndTimeMillis:t}))}))}))}(i,t)}catch(e){if(a)return zt.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${null==e?void 0:e.message}]`),{appId:o,measurementId:a};throw e}try{const t=await async function(e){var t;const{appId:n,apiKey:i}=e,r={method:"GET",headers:Jt(i)},s=$t.replace("{app-id}",n),o=await fetch(s,r);if(200!==o.status&&304!==o.status){let e="";try{const n=await o.json();(null===(t=n.error)||void 0===t?void 0:t.message)&&(e=n.error.message)}catch(e){}throw Ht.create("config-fetch-failed",{httpStatus:o.status,responseMessage:e})}return o.json()}(e);return r.deleteThrottleMetadata(o),t}catch(t){const c=t;if(!function(e){if(!(e instanceof m&&e.customData))return!1;const t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(c)){if(r.deleteThrottleMetadata(o),a)return zt.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${null==c?void 0:c.message}]`),{appId:o,measurementId:a};throw t}const u=503===Number(null===(s=null==c?void 0:c.customData)||void 0===s?void 0:s.httpStatus)?D(n,r.intervalMillis,Wt):D(n,r.intervalMillis),l={throttleEndTimeMillis:Date.now()+u,backoffCount:n+1};return r.setThrottleMetadata(o,l),zt.debug(`Calling attemptFetch again in ${u} millis`),Yt(e,l,i,r)}}class Zt{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach((e=>e()))}}let en,tn;async function nn(e,t,n,i,r,s,o){var a;const c=Xt(e);c.then((t=>{n[t.measurementId]=t.appId,e.options.measurementId&&t.measurementId!==e.options.measurementId&&zt.warn(`The measurement ID in the local Firebase config (${e.options.measurementId}) does not match the measurement ID fetched from the server (${t.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)})).catch((e=>zt.error(e))),t.push(c);const u=async function(){if(!p())return zt.warn(Ht.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await g()}catch(e){return zt.warn(Ht.create("indexeddb-unavailable",{errorInfo:null==e?void 0:e.toString()}).message),!1}return!0}().then((e=>e?i.getId():void 0)),[l,h]=await Promise.all([c,u]);(function(e){const t=window.document.getElementsByTagName("script");for(const n of Object.values(t))if(n.src&&n.src.includes(qt)&&n.src.includes(e))return n;return null})(s)||function(e,t){const n=function(e,t){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy("firebase-js-sdk-policy",t)),n}(0,{createScriptURL:Kt}),i=document.createElement("script"),r=`${qt}?l=${e}&id=${t}`;i.src=n?null==n?void 0:n.createScriptURL(r):r,i.async=!0,document.head.appendChild(i)}(s,l.measurementId),tn&&(r("consent","default",tn),tn=void 0),r("js",new Date);const d=null!==(a=null==o?void 0:o.config)&&void 0!==a?a:{};return d[Bt]="firebase",d.update=!0,null!=h&&(d[Vt]=h),r("config",l.measurementId,d),en&&(r("set",en),en=void 0),l.measurementId}class rn{constructor(e){this.app=e}_delete(){return delete sn[this.app.options.appId],Promise.resolve()}}let sn={},on=[];const an={};let cn,un,ln="dataLayer",hn=!1;function dn(e,t,n){!function(){const e=[];if(f()&&e.push("This is a browser extension environment."),"undefined"!=typeof navigator&&navigator.cookieEnabled||e.push("Cookies are not available."),e.length>0){const t=e.map(((e,t)=>`(${t+1}) ${e}`)).join(" "),n=Ht.create("invalid-analytics-context",{errorInfo:t});zt.warn(n.message)}}();const i=e.options.appId;if(!i)throw Ht.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw Ht.create("no-api-key");zt.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${e.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=sn[i])throw Ht.create("already-exists",{id:i});if(!hn){!function(e){let t=[];Array.isArray(window[e])?t=window[e]:window[e]=t}(ln);const{wrappedGtag:e,gtagCore:t}=function(e,t,n,i,r){let s=function(...e){window[i].push(arguments)};return window[r]&&"function"==typeof window[r]&&(s=window[r]),window[r]=function(e,t,n,i){return async function(r,...s){try{if("event"===r){const[i,r]=s;await async function(e,t,n,i,r){try{let s=[];if(r&&r.send_to){let e=r.send_to;Array.isArray(e)||(e=[e]);const i=await Gt(n);for(const n of e){const e=i.find((e=>e.measurementId===n)),r=e&&t[e.appId];if(!r){s=[];break}s.push(r)}}0===s.length&&(s=Object.values(t)),await Promise.all(s),e("event",i,r||{})}catch(e){zt.error(e)}}(e,t,n,i,r)}else if("config"===r){const[r,o]=s;await async function(e,t,n,i,r,s){const o=i[r];try{if(o)await t[o];else{const e=(await Gt(n)).find((e=>e.measurementId===r));e&&await t[e.appId]}}catch(e){zt.error(e)}e("config",r,s)}(e,t,n,i,r,o)}else if("consent"===r){const[t]=s;e("consent","update",t)}else if("get"===r){const[t,n,i]=s;e("get",t,n,i)}else if("set"===r){const[t]=s;e("set",t)}else e(r,...s)}catch(e){zt.error(e)}}}(s,e,t,n),{gtagCore:s,wrappedGtag:window[r]}}(sn,on,an,ln,"gtag");un=e,cn=t,hn=!0}return sn[i]=nn(e,on,an,t,cn,ln,n),new rn(e)}const fn="@firebase/analytics",pn="0.10.0";me(new O(Ut,((e,{options:t})=>dn(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),t)),"PUBLIC")),me(new O("analytics-internal",(function(e){try{const t=e.getProvider(Ut).getImmediate();return{logEvent:(e,n,i)=>function(e,t,n,i){e=R(e),async function(e,t,n,i,r){if(r&&r.global)e("event",n,i);else{const r=await t;e("event",n,Object.assign(Object.assign({},i),{send_to:r}))}}(un,sn[e.app.options.appId],t,n,i).catch((e=>zt.error(e)))}(t,e,n,i)}}catch(e){throw Ht.create("interop-component-reg-failed",{reason:e})}}),"PRIVATE")),Te(fn,pn),Te(fn,pn,"esm2017");const gn="type.googleapis.com/google.protobuf.Int64Value",mn="type.googleapis.com/google.protobuf.UInt64Value";function yn(e,t){const n={};for(const i in e)e.hasOwnProperty(i)&&(n[i]=t(e[i]));return n}function vn(e){if(null==e)return null;if(e instanceof Number&&(e=e.valueOf()),"number"==typeof e&&isFinite(e))return e;if(!0===e||!1===e)return e;if("[object String]"===Object.prototype.toString.call(e))return e;if(e instanceof Date)return e.toISOString();if(Array.isArray(e))return e.map((e=>vn(e)));if("function"==typeof e||"object"==typeof e)return yn(e,(e=>vn(e)));throw new Error("Data cannot be encoded in JSON: "+e)}function wn(e){if(null==e)return e;if(e["@type"])switch(e["@type"]){case gn:case mn:{const t=Number(e.value);if(isNaN(t))throw new Error("Data cannot be decoded from JSON: "+e);return t}default:throw new Error("Data cannot be decoded from JSON: "+e)}return Array.isArray(e)?e.map((e=>wn(e))):"function"==typeof e||"object"==typeof e?yn(e,(e=>wn(e))):e}const In="functions",En={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class bn extends m{constructor(e,t,n){super(`${In}/${e}`,t||""),this.details=n}}class Tn{constructor(e,t,n){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=t.getImmediate({optional:!0}),this.auth||e.get().then((e=>this.auth=e),(()=>{})),this.messaging||t.get().then((e=>this.messaging=e),(()=>{})),this.appCheck||n.get().then((e=>this.appCheck=e),(()=>{}))}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return null==e?void 0:e.accessToken}catch(e){return}}async getMessagingToken(){if(this.messaging&&"Notification"in self&&"granted"===Notification.permission)try{return await this.messaging.getToken()}catch(e){return}}async getAppCheckToken(e){if(this.appCheck){const t=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return t.error?null:t.token}return null}async getContext(e){return{authToken:await this.getAuthToken(),messagingToken:await this.getMessagingToken(),appCheckToken:await this.getAppCheckToken(e)}}}const _n="us-central1";class Cn{constructor(e,t,n,i,r=_n,s){this.app=e,this.fetchImpl=s,this.emulatorOrigin=null,this.contextProvider=new Tn(t,n,i),this.cancelAllRequests=new Promise((e=>{this.deleteService=()=>Promise.resolve(e())}));try{const e=new URL(r);this.customDomain=e.origin,this.region=_n}catch(e){this.customDomain=null,this.region=r}}_delete(){return this.deleteService()}_url(e){const t=this.app.options.projectId;return null!==this.emulatorOrigin?`${this.emulatorOrigin}/${t}/${this.region}/${e}`:null!==this.customDomain?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}}function Sn(e,t,n){return i=>function(e,t,n,i){const r=e._url(t);return async function(e,t,n,i){const r={data:n=vn(n)},s={},o=await e.contextProvider.getContext(i.limitedUseAppCheckTokens);o.authToken&&(s.Authorization="Bearer "+o.authToken),o.messagingToken&&(s["Firebase-Instance-ID-Token"]=o.messagingToken),null!==o.appCheckToken&&(s["X-Firebase-AppCheck"]=o.appCheckToken);const a=function(e){let t=null;return{promise:new Promise(((n,i)=>{t=setTimeout((()=>{i(new bn("deadline-exceeded","deadline-exceeded"))}),e)})),cancel:()=>{t&&clearTimeout(t)}}}(i.timeout||7e4),c=await Promise.race([kn(t,r,s,e.fetchImpl),a.promise,e.cancelAllRequests]);if(a.cancel(),!c)throw new bn("cancelled","Firebase Functions instance was deleted.");const u=function(e,t){let n,i=function(e){if(e>=200&&e<300)return"ok";switch(e){case 0:case 500:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(e),r=i;try{const e=t&&t.error;if(e){const t=e.status;if("string"==typeof t){if(!En[t])return new bn("internal","internal");i=En[t],r=t}const s=e.message;"string"==typeof s&&(r=s),n=e.details,void 0!==n&&(n=wn(n))}}catch(e){}return"ok"===i?null:new bn(i,r,n)}(c.status,c.json);if(u)throw u;if(!c.json)throw new bn("internal","Response is not valid JSON object.");let l=c.json.data;if(void 0===l&&(l=c.json.result),void 0===l)throw new bn("internal","Response is missing data field.");return{data:wn(l)}}(e,r,n,i)}(e,t,i,n||{})}async function kn(e,t,n,i){let r;n["Content-Type"]="application/json";try{r=await i(e,{method:"POST",body:JSON.stringify(t),headers:n})}catch(e){return{status:0,json:null}}let s=null;try{s=await r.json()}catch(e){}return{status:r.status,json:s}}const An="@firebase/functions",Nn="0.10.0";function Dn(e,t,n){return Sn(R(e),t,n)}var Rn;function On(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}Rn=fetch.bind(self),me(new O(In,((e,{instanceIdentifier:t})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),r=e.getProvider("messaging-internal"),s=e.getProvider("app-check-internal");return new Cn(n,i,r,s,t,Rn)}),"PUBLIC").setMultipleInstances(!0)),Te(An,Nn,void 0),Te(An,Nn,"esm2017"),Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;const Pn=function(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},Ln=new y("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Mn=new q("@firebase/auth");function xn(e,...t){Mn.logLevel<=F.ERROR&&Mn.error(`Auth (${Ie}): ${e}`,...t)}function Fn(e,...t){throw Bn(e,...t)}function Un(e,...t){return Bn(e,...t)}function Vn(e,t,n){const i=Object.assign(Object.assign({},Pn()),{[t]:n});return new y("auth","Firebase",i).create(t,{appName:e.name})}function Bn(e,...t){if("string"!=typeof e){const n=t[0],i=[...t.slice(1)];return i[0]&&(i[0].appName=e.name),e._errorFactory.create(n,...i)}return Ln.create(e,...t)}function jn(e,t,...n){if(!e)throw Bn(t,...n)}function $n(e){const t="INTERNAL ASSERTION FAILED: "+e;throw xn(t),new Error(t)}function qn(e,t){e||$n(t)}function zn(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function Hn(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}class Kn{constructor(e,t){this.shortDelay=e,this.longDelay=t,qn(t>e,"Short delay should be less than long delay!"),this.isMobile="undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(d())||"object"==typeof navigator&&"ReactNative"===navigator.product}get(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===Hn()||"https:"===Hn()||f()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function Gn(e,t){qn(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class Wn{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void $n("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void $n("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void $n("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Qn={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Jn=new Kn(3e4,6e4);function Xn(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function Yn(e,t,n,i,r={}){return Zn(e,r,(async()=>{let r={},s={};i&&("GET"===t?s=i:r={body:JSON.stringify(i)});const o=E(Object.assign({key:e.config.apiKey},s)).slice(1),a=await e._getAdditionalHeaders();return a["Content-Type"]="application/json",e.languageCode&&(a["X-Firebase-Locale"]=e.languageCode),Wn.fetch()(ti(e,e.config.apiHost,n,o),Object.assign({method:t,headers:a,referrerPolicy:"no-referrer"},r))}))}async function Zn(e,t,n){e._canInitEmulator=!1;const i=Object.assign(Object.assign({},Qn),t);try{const t=new ni(e),r=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const s=await r.json();if("needConfirmation"in s)throw ii(e,"account-exists-with-different-credential",s);if(r.ok&&!("errorMessage"in s))return s;{const t=r.ok?s.errorMessage:s.error.message,[n,o]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw ii(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw ii(e,"email-already-in-use",s);if("USER_DISABLED"===n)throw ii(e,"user-disabled",s);const a=i[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw Vn(e,a,o);Fn(e,a)}}catch(t){if(t instanceof m)throw t;Fn(e,"network-request-failed",{message:String(t)})}}async function ei(e,t,n,i,r={}){const s=await Yn(e,t,n,i,r);return"mfaPendingCredential"in s&&Fn(e,"multi-factor-auth-required",{_serverResponse:s}),s}function ti(e,t,n,i){const r=`${t}${n}?${i}`;return e.config.emulator?Gn(e.config,r):`${e.config.apiScheme}://${r}`}class ni{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(Un(this.auth,"network-request-failed"))),Jn.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function ii(e,t,n){const i={appName:e.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const r=Un(e,t,i);return r.customData._tokenResponse=n,r}function ri(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(e){}}function si(e){return 1e3*Number(e)}function oi(e){const[t,n,i]=e.split(".");if(void 0===t||void 0===n||void 0===i)return xn("JWT malformed, contained fewer than 3 sections"),null;try{const e=s(n);return e?JSON.parse(e):(xn("Failed to decode base64 JWT payload"),null)}catch(e){return xn("Caught error parsing JWT payload as JSON",null==e?void 0:e.toString()),null}}async function ai(e,t,n=!1){if(n)return t;try{return await t}catch(t){throw t instanceof m&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}(t)&&e.auth.currentUser===e&&await e.auth.signOut(),t}}class ci{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===(null==e?void 0:e.code)&&this.schedule(!0))}this.schedule()}}class ui{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=ri(this.lastLoginAt),this.creationTime=ri(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function li(e){var t;const n=e.auth,i=await e.getIdToken(),r=await ai(e,async function(e,t){return Yn(e,"POST","/v1/accounts:lookup",t)}(n,{idToken:i}));jn(null==r?void 0:r.users.length,n,"internal-error");const s=r.users[0];e._notifyReloadListener(s);const o=(null===(t=s.providerUserInfo)||void 0===t?void 0:t.length)?s.providerUserInfo.map((e=>{var{providerId:t}=e,n=On(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})):[],a=(c=e.providerData,u=o,[...c.filter((e=>!u.some((t=>t.providerId===e.providerId)))),...u]);var c,u;const l=e.isAnonymous,h=!(e.email&&s.passwordHash||(null==a?void 0:a.length)),d=!!l&&h,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new ui(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(e,f)}class hi{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){jn(e.idToken,"internal-error"),jn(void 0!==e.idToken,"internal-error"),jn(void 0!==e.refreshToken,"internal-error");const t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):function(e){const t=oi(e);return jn(t,"internal-error"),jn(void 0!==t.exp,"internal-error"),jn(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}async getToken(e,t=!1){return jn(!this.accessToken||this.refreshToken,e,"user-token-expired"),t||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:i,expiresIn:r}=await async function(e,t){const n=await Zn(e,{},(async()=>{const n=E({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:i,apiKey:r}=e.config,s=ti(e,i,"/v1/token",`key=${r}`),o=await e._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",Wn.fetch()(s,{method:"POST",headers:o,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,i,Number(r))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:i,expirationTime:r}=t,s=new hi;return n&&(jn("string"==typeof n,"internal-error",{appName:e}),s.refreshToken=n),i&&(jn("string"==typeof i,"internal-error",{appName:e}),s.accessToken=i),r&&(jn("number"==typeof r,"internal-error",{appName:e}),s.expirationTime=r),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new hi,this.toJSON())}_performRefresh(){return $n("not implemented")}}function di(e,t){jn("string"==typeof e||void 0===e,"internal-error",{appName:t})}class fi{constructor(e){var{uid:t,auth:n,stsTokenManager:i}=e,r=On(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new ci(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new ui(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await ai(this,this.stsTokenManager.getToken(this.auth,e));return jn(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e,t=!1){const n=R(e),i=await n.getIdToken(t),r=oi(i);jn(r&&r.exp&&r.auth_time&&r.iat,n.auth,"internal-error");const s="object"==typeof r.firebase?r.firebase:void 0,o=null==s?void 0:s.sign_in_provider;return{claims:r,token:i,authTime:ri(si(r.auth_time)),issuedAtTime:ri(si(r.iat)),expirationTime:ri(si(r.exp)),signInProvider:o||null,signInSecondFactor:(null==s?void 0:s.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=R(e);await li(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(jn(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new fi(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){jn(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await li(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await ai(this,async function(e,t){return Yn(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,i,r,s,o,a,c,u;const l=null!==(n=t.displayName)&&void 0!==n?n:void 0,h=null!==(i=t.email)&&void 0!==i?i:void 0,d=null!==(r=t.phoneNumber)&&void 0!==r?r:void 0,f=null!==(s=t.photoURL)&&void 0!==s?s:void 0,p=null!==(o=t.tenantId)&&void 0!==o?o:void 0,g=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,m=null!==(c=t.createdAt)&&void 0!==c?c:void 0,y=null!==(u=t.lastLoginAt)&&void 0!==u?u:void 0,{uid:v,emailVerified:w,isAnonymous:I,providerData:E,stsTokenManager:b}=t;jn(v&&b,e,"internal-error");const T=hi.fromJSON(this.name,b);jn("string"==typeof v,e,"internal-error"),di(l,e.name),di(h,e.name),jn("boolean"==typeof w,e,"internal-error"),jn("boolean"==typeof I,e,"internal-error"),di(d,e.name),di(f,e.name),di(p,e.name),di(g,e.name),di(m,e.name),di(y,e.name);const _=new fi({uid:v,auth:e,email:h,emailVerified:w,displayName:l,isAnonymous:I,photoURL:f,phoneNumber:d,tenantId:p,stsTokenManager:T,createdAt:m,lastLoginAt:y});return E&&Array.isArray(E)&&(_.providerData=E.map((e=>Object.assign({},e)))),g&&(_._redirectEventId=g),_}static async _fromIdTokenResponse(e,t,n=!1){const i=new hi;i.updateFromServerResponse(t);const r=new fi({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await li(r),r}}const pi=new Map;function gi(e){qn(e instanceof Function,"Expected a class definition");let t=pi.get(e);return t?(qn(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,pi.set(e,t),t)}class mi{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}mi.type="NONE";const yi=mi;function vi(e,t,n){return`firebase:${e}:${t}:${n}`}class wi{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:i,name:r}=this.auth;this.fullUserKey=vi(this.userKey,i.apiKey,r),this.fullPersistenceKey=vi("persistence",i.apiKey,r),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?fi._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new wi(gi(yi),e,n);const i=(await Promise.all(t.map((async e=>{if(await e._isAvailable())return e})))).filter((e=>e));let r=i[0]||gi(yi);const s=vi(n,e.config.apiKey,e.name);let o=null;for(const n of t)try{const t=await n._get(s);if(t){const i=fi._fromJSON(e,t);n!==r&&(o=i),r=n;break}}catch(e){}const a=i.filter((e=>e._shouldAllowMigration));return r._shouldAllowMigration&&a.length?(r=a[0],o&&await r._set(s,o.toJSON()),await Promise.all(t.map((async e=>{if(e!==r)try{await e._remove(s)}catch(e){}}))),new wi(r,e,n)):new wi(r,e,n)}}function Ii(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(_i(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(Ei(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(Si(t))return"Blackberry";if(ki(t))return"Webos";if(bi(t))return"Safari";if((t.includes("chrome/")||Ti(t))&&!t.includes("edge/"))return"Chrome";if(Ci(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function Ei(e=d()){return/firefox\//i.test(e)}function bi(e=d()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function Ti(e=d()){return/crios\//i.test(e)}function _i(e=d()){return/iemobile/i.test(e)}function Ci(e=d()){return/android/i.test(e)}function Si(e=d()){return/blackberry/i.test(e)}function ki(e=d()){return/webos/i.test(e)}function Ai(e=d()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function Ni(e=d()){return Ai(e)||Ci(e)||ki(e)||Si(e)||/windows phone/i.test(e)||_i(e)}function Di(e,t=[]){let n;switch(e){case"Browser":n=Ii(d());break;case"Worker":n=`${Ii(d())}-${e}`;break;default:n=e}const i=t.length?t.join(","):"FirebaseCore-web";return`${n}/JsCore/${Ie}/${i}`}async function Ri(e,t){return Yn(e,"GET","/v2/recaptchaConfig",Xn(e,t))}function Oi(e){return void 0!==e&&void 0!==e.enterprise}class Pi{constructor(e){if(this.siteKey="",this.emailPasswordEnabled=!1,void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.emailPasswordEnabled=e.recaptchaEnforcementState.some((e=>"EMAIL_PASSWORD_PROVIDER"===e.provider&&"OFF"!==e.enforcementState))}}function Li(e){return new Promise(((t,n)=>{const i=document.createElement("script");var r,s;i.setAttribute("src",e),i.onload=t,i.onerror=e=>{const t=Un("internal-error");t.customData=e,n(t)},i.type="text/javascript",i.charset="UTF-8",(null!==(s=null===(r=document.getElementsByTagName("head"))||void 0===r?void 0:r[0])&&void 0!==s?s:document).appendChild(i)}))}function Mi(e){return`__${e}${Math.floor(1e6*Math.random())}`}class xi{constructor(e){this.type="recaptcha-enterprise",this.auth=Bi(e)}async verify(e="verify",t=!1){function n(t,n,i){const r=window.grecaptcha;Oi(r)?r.enterprise.ready((()=>{r.enterprise.execute(t,{action:e}).then((e=>{n(e)})).catch((()=>{n("NO_RECAPTCHA")}))})):i(Error("No reCAPTCHA enterprise script loaded."))}return new Promise(((e,i)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise((async(t,n)=>{Ri(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((i=>{if(void 0!==i.recaptchaKey){const n=new Pi(i);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))})).catch((e=>{n(e)}))}))})(this.auth).then((r=>{if(!t&&Oi(window.grecaptcha))n(r,e,i);else{if("undefined"==typeof window)return void i(new Error("RecaptchaVerifier is only supported in browser"));Li("https://www.google.com/recaptcha/enterprise.js?render="+r).then((()=>{n(r,e,i)})).catch((e=>{i(e)}))}})).catch((e=>{i(e)}))}))}}async function Fi(e,t,n,i=!1){const r=new xi(e);let s;try{s=await r.verify(n)}catch(e){s=await r.verify(n,!0)}const o=Object.assign({},t);return i?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}class Ui{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise(((n,i)=>{try{n(e(t))}catch(e){i(e)}}));n.onAbort=t,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(e){t.reverse();for(const e of t)try{e()}catch(e){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null==e?void 0:e.message})}}}class Vi{constructor(e,t,n,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ji(this),this.idTokenSubscription=new ji(this),this.beforeStateQueue=new Ui(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Ln,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=gi(t)),this._initializationPromise=this.queue((async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await wi.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(e){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(i=this.currentUser)||void 0===i?void 0:i.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUser(e){var t;const n=await this.assertedPersistence.getCurrentUser();let i=n,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,s=null==i?void 0:i._redirectEventId,o=await this.tryRedirectSignIn(e);n&&n!==s||!(null==o?void 0:o.user)||(i=o.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(e){i=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(e)))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return jn(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(e){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await li(e)}catch(e){if("auth/network-request-failed"!==(null==e?void 0:e.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const t=e?R(e):null;return t&&jn(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&jn(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue((async()=>{await this.assertedPersistence.setPersistence(gi(e))}))}async initializeRecaptchaConfig(){const e=await Ri(this,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),t=new Pi(e);null==this.tenantId?this._agentRecaptchaConfig=t:this._tenantRecaptchaConfigs[this.tenantId]=t,t.emailPasswordEnabled&&new xi(this).verify()}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new y("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&gi(e)||this._popupRedirectResolver;jn(t,this,"argument-error"),this.redirectPersistenceManager=await wi.create(this,[gi(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,i){if(this._deleted)return()=>{};const r="function"==typeof t?t:t.next.bind(t),s=this._isInitialized?Promise.resolve():this._initializationPromise;return jn(s,this,"internal-error"),s.then((()=>r(this.currentUser))),"function"==typeof t?e.addObserver(t,n,i):e.addObserver(t)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return jn(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Di(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){var e;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null==t?void 0:t.error)&&function(e,...t){Mn.logLevel<=F.WARN&&Mn.warn(`Auth (${Ie}): ${e}`,...t)}(`Error while retrieving App Check token: ${t.error}`),null==t?void 0:t.token}}function Bi(e){return R(e)}class ji{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new _(e,void 0);return n.subscribe.bind(n)}((e=>this.observer=e))}get next(){return jn(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function $i(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function qi(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class zi{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return $n("not implemented")}_getIdTokenResponse(e){return $n("not implemented")}_linkToIdToken(e,t){return $n("not implemented")}_getReauthenticationResolver(e){return $n("not implemented")}}async function Hi(e,t){return ei(e,"POST","/v1/accounts:signInWithPassword",Xn(e,t))}class Ki extends zi{constructor(e,t,n,i=null){super("password",n),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new Ki(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new Ki(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){var t;switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};if(null===(t=e._getRecaptchaConfig())||void 0===t?void 0:t.emailPasswordEnabled){const t=await Fi(e,n,"signInWithPassword");return Hi(e,t)}return Hi(e,n).catch((async t=>{if("auth/missing-recaptcha-token"===t.code){console.log("Sign-in with email address and password is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const t=await Fi(e,n,"signInWithPassword");return Hi(e,t)}return Promise.reject(t)}));case"emailLink":return async function(e,t){return ei(e,"POST","/v1/accounts:signInWithEmailLink",Xn(e,t))}(e,{email:this._email,oobCode:this._password});default:Fn(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return async function(e,t){return Yn(e,"POST","/v1/accounts:update",t)}(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(e,t){return ei(e,"POST","/v1/accounts:signInWithEmailLink",Xn(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:Fn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Gi(e,t){return ei(e,"POST","/v1/accounts:signInWithIdp",Xn(e,t))}class Wi extends zi{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Wi(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Fn("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:i}=t,r=On(t,["providerId","signInMethod"]);if(!n||!i)return null;const s=new Wi(n,i);return s.idToken=r.idToken||void 0,s.accessToken=r.accessToken||void 0,s.secret=r.secret,s.nonce=r.nonce,s.pendingToken=r.pendingToken||null,s}_getIdTokenResponse(e){return Gi(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Gi(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Gi(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=E(t)}return e}}const Qi={USER_NOT_FOUND:"user-not-found"};class Ji extends zi{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Ji({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Ji({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return ei(e,"POST","/v1/accounts:signInWithPhoneNumber",Xn(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await ei(e,"POST","/v1/accounts:signInWithPhoneNumber",Xn(e,t));if(n.temporaryProof)throw ii(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return ei(e,"POST","/v1/accounts:signInWithPhoneNumber",Xn(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),Qi)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:i}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"==typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:i,temporaryProof:r}=e;return n||t||i||r?new Ji({verificationId:t,verificationCode:n,phoneNumber:i,temporaryProof:r}):null}}class Xi{constructor(e){var t,n,i,r,s,o;const a=b(T(e)),c=null!==(t=a.apiKey)&&void 0!==t?t:null,u=null!==(n=a.oobCode)&&void 0!==n?n:null,l=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=a.mode)&&void 0!==i?i:null);jn(c&&u&&l,"argument-error"),this.apiKey=c,this.operation=l,this.code=u,this.continueUrl=null!==(r=a.continueUrl)&&void 0!==r?r:null,this.languageCode=null!==(s=a.languageCode)&&void 0!==s?s:null,this.tenantId=null!==(o=a.tenantId)&&void 0!==o?o:null}static parseLink(e){const t=function(e){const t=b(T(e)).link,n=t?b(T(t)).deep_link_id:null,i=b(T(e)).deep_link_id;return(i?b(T(i)).link:null)||i||n||t||e}(e);try{return new Xi(t)}catch(e){return null}}}class Yi{constructor(){this.providerId=Yi.PROVIDER_ID}static credential(e,t){return Ki._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Xi.parseLink(t);return jn(n,"argument-error"),Ki._fromEmailAndCode(e,n.code,n.tenantId)}}Yi.PROVIDER_ID="password",Yi.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Yi.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Zi{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class er extends Zi{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class tr extends er{constructor(){super("facebook.com")}static credential(e){return Wi._fromParams({providerId:tr.PROVIDER_ID,signInMethod:tr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return tr.credentialFromTaggedObject(e)}static credentialFromError(e){return tr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return tr.credential(e.oauthAccessToken)}catch(e){return null}}}tr.FACEBOOK_SIGN_IN_METHOD="facebook.com",tr.PROVIDER_ID="facebook.com";class nr extends er{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Wi._fromParams({providerId:nr.PROVIDER_ID,signInMethod:nr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return nr.credentialFromTaggedObject(e)}static credentialFromError(e){return nr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return nr.credential(t,n)}catch(e){return null}}}nr.GOOGLE_SIGN_IN_METHOD="google.com",nr.PROVIDER_ID="google.com";class ir extends er{constructor(){super("github.com")}static credential(e){return Wi._fromParams({providerId:ir.PROVIDER_ID,signInMethod:ir.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ir.credentialFromTaggedObject(e)}static credentialFromError(e){return ir.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return ir.credential(e.oauthAccessToken)}catch(e){return null}}}ir.GITHUB_SIGN_IN_METHOD="github.com",ir.PROVIDER_ID="github.com";class rr extends er{constructor(){super("twitter.com")}static credential(e,t){return Wi._fromParams({providerId:rr.PROVIDER_ID,signInMethod:rr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return rr.credentialFromTaggedObject(e)}static credentialFromError(e){return rr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return rr.credential(t,n)}catch(e){return null}}}rr.TWITTER_SIGN_IN_METHOD="twitter.com",rr.PROVIDER_ID="twitter.com";class sr{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,i=!1){const r=await fi._fromIdTokenResponse(e,n,i),s=or(n);return new sr({user:r,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const i=or(n);return new sr({user:e,providerId:i,_tokenResponse:n,operationType:t})}}function or(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class ar extends m{constructor(e,t,n,i){var r;super(t.code,t.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,ar.prototype),this.customData={appName:e.name,tenantId:null!==(r=e.tenantId)&&void 0!==r?r:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,i){return new ar(e,t,n,i)}}function cr(e,t,n,i){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw ar._fromErrorAndOperation(e,n,t,i);throw n}))}new WeakMap;const ur="__sak";class lr{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(ur,"1"),this.storage.removeItem(ur),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class hr extends lr{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const e=d();return bi(e)||Ai(e)}()&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),this.fallbackToPolling=Ni(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),i=this.localCache[t];n!==i&&e(t,i,n)}}onStorageEvent(e,t=!1){if(!e.key)return void this.forAllChangedKeys(((e,t,n)=>{this.notifyListeners(e,n)}));const n=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const i=this.storage.getItem(n);if(e.newValue!==i)null!==e.newValue?this.storage.setItem(n,e.newValue):this.storage.removeItem(n);else if(this.localCache[n]===e.newValue&&!t)return}const i=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},r=this.storage.getItem(n);!function(){const e=d();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()||10!==document.documentMode||r===e.newValue||e.newValue===e.oldValue?i():setTimeout(i,10)}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}hr.type="LOCAL";const dr=hr;class fr extends lr{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(e,t){}_removeListener(e,t){}}fr.type="SESSION";const pr=fr;class gr{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new gr(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:i,data:r}=t.data,s=this.handlersMap[i];if(!(null==s?void 0:s.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(s).map((async e=>e(t.origin,r))),a=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(e){return{fulfilled:!1,reason:e}}})))}(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function mr(e="",t=10){let n="";for(let e=0;e<t;e++)n+=Math.floor(10*Math.random());return e+n}gr.receivers=[];class yr{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const i="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let r,s;return new Promise(((o,a)=>{const c=mr("",20);i.port1.start();const u=setTimeout((()=>{a(new Error("unsupported_event"))}),n);s={messageChannel:i,onMessage(e){const t=e;if(t.data.eventId===c)switch(t.data.status){case"ack":clearTimeout(u),r=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(r),o(t.data.response);break;default:clearTimeout(u),clearTimeout(r),a(new Error("invalid_response"))}}},this.handlers.add(s),i.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[i.port2])})).finally((()=>{s&&this.removeMessageHandler(s)}))}}function vr(){return window}function wr(){return void 0!==vr().WorkerGlobalScope&&"function"==typeof vr().importScripts}const Ir="firebaseLocalStorageDb",Er="firebaseLocalStorage",br="fbase_key";class Tr{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function _r(e,t){return e.transaction([Er],t?"readwrite":"readonly").objectStore(Er)}function Cr(){const e=indexedDB.open(Ir,1);return new Promise(((t,n)=>{e.addEventListener("error",(()=>{n(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(Er,{keyPath:br})}catch(e){n(e)}})),e.addEventListener("success",(async()=>{const n=e.result;n.objectStoreNames.contains(Er)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(Ir);return new Tr(e).toPromise()}(),t(await Cr()))}))}))}async function Sr(e,t,n){const i=_r(e,!0).put({[br]:t,value:n});return new Tr(i).toPromise()}function kr(e,t){const n=_r(e,!0).delete(t);return new Tr(n).toPromise()}class Ar{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await Cr()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(e){if(t++>3)throw e;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return wr()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=gr._getInstance(wr()?self:null),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new yr(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&((null===(t=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===t?void 0:t.controller)||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}var t}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Cr();return await Sr(e,ur,"1"),await kr(e,ur),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((n=>Sr(n,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){const t=await this._withRetries((t=>async function(e,t){const n=_r(e,!1).get(t),i=await new Tr(n).toPromise();return void 0===i?null:i.value}(t,e)));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>kr(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){const e=await this._withRetries((e=>{const t=_r(e,!1).getAll();return new Tr(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;for(const{fbase_key:i,value:r}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(r)&&(this.notifyListeners(i,r),t.push(i));for(const e of Object.keys(this.localCache))this.localCache[e]&&!n.has(e)&&(this.notifyListeners(e,null),t.push(e));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Ar.type="LOCAL";const Nr=Ar;Mi("rcb"),new Kn(3e4,6e4);class Dr{constructor(e){this.providerId=Dr.PROVIDER_ID,this.auth=Bi(e)}verifyPhoneNumber(e,t){return async function(e,t,n){var i;const r=await n.verify();try{let s;if(jn("string"==typeof r,e,"argument-error"),jn("recaptcha"===n.type,e,"argument-error"),s="string"==typeof t?{phoneNumber:t}:t,"session"in s){const t=s.session;if("phoneNumber"in s){jn("enroll"===t.type,e,"internal-error");const n=await function(e,t){return Yn(e,"POST","/v2/accounts/mfaEnrollment:start",Xn(e,t))}(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:r}});return n.phoneSessionInfo.sessionInfo}{jn("signin"===t.type,e,"internal-error");const n=(null===(i=s.multiFactorHint)||void 0===i?void 0:i.uid)||s.multiFactorUid;jn(n,e,"missing-multi-factor-info");const o=await function(e,t){return Yn(e,"POST","/v2/accounts/mfaSignIn:start",Xn(e,t))}(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:r}});return o.phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await async function(e,t){return Yn(e,"POST","/v1/accounts:sendVerificationCode",Xn(e,t))}(e,{phoneNumber:s.phoneNumber,recaptchaToken:r});return t}}finally{n._reset()}}(this.auth,e,R(t))}static credential(e,t){return Ji._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Dr.credentialFromTaggedObject(t)}static credentialFromError(e){return Dr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:n}=e;return t&&n?Ji._fromTokenResponse(t,n):null}}function Rr(e,t){return t?gi(t):(jn(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}Dr.PROVIDER_ID="phone",Dr.PHONE_SIGN_IN_METHOD="phone";class Or extends zi{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Gi(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Gi(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Gi(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Pr(e){return async function(e,t,n=!1){const i="signIn",r=await cr(e,i,t),s=await sr._fromIdTokenResponse(e,i,r);return n||await e._updateCurrentUser(s.user),s}(e.auth,new Or(e),e.bypassAuthState)}function Lr(e){const{auth:t,user:n}=e;return jn(n,t,"internal-error"),async function(e,t,n=!1){const{auth:i}=e,r="reauthenticate";try{const s=await ai(e,cr(i,r,t,e),n);jn(s.idToken,i,"internal-error");const o=oi(s.idToken);jn(o,i,"internal-error");const{sub:a}=o;return jn(e.uid===a,i,"user-mismatch"),sr._forOperation(e,r,s)}catch(e){throw"auth/user-not-found"===(null==e?void 0:e.code)&&Fn(i,"user-mismatch"),e}}(n,new Or(e),e.bypassAuthState)}async function Mr(e){const{auth:t,user:n}=e;return jn(n,t,"internal-error"),async function(e,t,n=!1){const i=await ai(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return sr._forOperation(e,"link",i)}(n,new Or(e),e.bypassAuthState)}class xr{constructor(e,t,n,i,r=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(e){this.reject(e)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:i,tenantId:r,error:s,type:o}=e;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:r||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(e){this.reject(e)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Pr;case"linkViaPopup":case"linkViaRedirect":return Mr;case"reauthViaPopup":case"reauthViaRedirect":return Lr;default:Fn(this.auth,"internal-error")}}resolve(e){qn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){qn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Fr=new Kn(2e3,1e4);class Ur extends xr{constructor(e,t,n,i,r){super(e,t,i,r),this.provider=n,this.authWindow=null,this.pollId=null,Ur.currentPopupAction&&Ur.currentPopupAction.cancel(),Ur.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return jn(e,this.auth,"internal-error"),e}async onExecution(){qn(1===this.filter.length,"Popup operations only handle one event");const e=mr();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(Un(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(Un(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ur.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(Un(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(e,Fr.get())};e()}}Ur.currentPopupAction=null;const Vr="pendingRedirect",Br=new Map;class jr extends xr{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=Br.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=zr(t),i=qr(e);if(!await i._isAvailable())return!1;const r="true"===await i._get(n);return await i._remove(n),r}(this.resolver,this.auth),n=t?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}Br.set(this.auth._key(),e)}return this.bypassAuthState||Br.set(this.auth._key(),(()=>Promise.resolve(null))),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function $r(e,t){Br.set(e._key(),t)}function qr(e){return gi(e._redirectPersistence)}function zr(e){return vi(Vr,e.config.apiKey,e.name)}function Hr(e,t,n){return async function(e,t,n){const i=Bi(e);(function(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&Fn(e,"argument-error"),Vn(e,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)})(e,t,Zi),await i._initializationPromise;const r=Rr(i,n);return await async function(e,t){return qr(e)._set(zr(t),"true")}(r,i),r._openRedirect(i,t,"signInViaRedirect")}(e,t,n)}async function Kr(e,t,n=!1){const i=Bi(e),r=Rr(i,t),s=new jr(i,r,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,t)),o}class Gr{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Qr(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!Qr(e)){const i=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(Un(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Wr(e))}saveEventToCache(e){this.cachedEventUids.add(Wr(e)),this.lastProcessedEventTime=Date.now()}}function Wr(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function Qr({type:e,error:t}){return"unknown"===e&&"auth/no-auth-event"===(null==t?void 0:t.code)}const Jr=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Xr=/^https?/;function Yr(e){const t=zn(),{protocol:n,hostname:i}=new URL(t);if(e.startsWith("chrome-extension://")){const r=new URL(e);return""===r.hostname&&""===i?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&r.hostname===i}if(!Xr.test(n))return!1;if(Jr.test(e))return i===e;const r=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}const Zr=new Kn(3e4,6e4);function es(){const e=vr().___jsl;if(null==e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let t=0;t<e.CP.length;t++)e.CP[t]=null}let ts=null;function ns(e){return ts=ts||function(e){return new Promise(((t,n)=>{var i,r,s;function o(){es(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{es(),n(Un(e,"network-request-failed"))},timeout:Zr.get()})}if(null===(r=null===(i=vr().gapi)||void 0===i?void 0:i.iframes)||void 0===r?void 0:r.Iframe)t(gapi.iframes.getContext());else{if(!(null===(s=vr().gapi)||void 0===s?void 0:s.load)){const t=Mi("iframefcb");return vr()[t]=()=>{gapi.load?o():n(Un(e,"network-request-failed"))},Li(`https://apis.google.com/js/api.js?onload=${t}`).catch((e=>n(e)))}o()}})).catch((e=>{throw ts=null,e}))}(e),ts}const is=new Kn(5e3,15e3),rs={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},ss=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function os(e){const t=e.config;jn(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?Gn(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,i={apiKey:t.apiKey,appName:e.name,v:Ie},r=ss.get(e.config.apiHost);r&&(i.eid=r);const s=e._getFrameworks();return s.length&&(i.fw=s.join(",")),`${n}?${E(i).slice(1)}`}const as={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class cs{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}const us=encodeURIComponent("fac");async function ls(e,t,n,i,r,s){jn(e.config.authDomain,e,"auth-domain-config-required"),jn(e.config.apiKey,e,"invalid-api-key");const o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:i,v:Ie,eventId:r};if(t instanceof Zi){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(s||{}))o[e]=t}if(t instanceof er){const e=t.getScopes().filter((e=>""!==e));e.length>0&&(o.scopes=e.join(","))}e.tenantId&&(o.tid=e.tenantId);const a=o;for(const e of Object.keys(a))void 0===a[e]&&delete a[e];const c=await e._getAppCheckToken(),u=c?`#${us}=${encodeURIComponent(c)}`:"";return`${function({config:e}){return e.emulator?Gn(e,"emulator/auth/handler"):`https://${e.authDomain}/__/auth/handler`}(e)}?${E(a).slice(1)}${u}`}const hs="webStorageSupport",ds=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=pr,this._completeRedirectFn=Kr,this._overrideRedirectResult=$r}async _openPopup(e,t,n,i){var r;return qn(null===(r=this.eventManagers[e._key()])||void 0===r?void 0:r.manager,"_initialize() not called before _openPopup()"),function(e,t,n,i=500,r=600){const s=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let a="";const c=Object.assign(Object.assign({},as),{width:i.toString(),height:r.toString(),top:s,left:o}),u=d().toLowerCase();n&&(a=Ti(u)?"_blank":n),Ei(u)&&(t=t||"http://localhost",c.scrollbars="yes");const l=Object.entries(c).reduce(((e,[t,n])=>`${e}${t}=${n},`),"");if(function(e=d()){var t;return Ai(e)&&!!(null===(t=window.navigator)||void 0===t?void 0:t.standalone)}(u)&&"_self"!==a)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}(t||"",a),new cs(null);const h=window.open(t||"",a,l);jn(h,e,"popup-blocked");try{h.focus()}catch(e){}return new cs(h)}(e,await ls(e,t,n,zn(),i),mr())}async _openRedirect(e,t,n,i){return await this._originValidation(e),r=await ls(e,t,n,zn(),i),vr().location.href=r,new Promise((()=>{}));var r}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(qn(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch((()=>{delete this.eventManagers[t]})),n}async initAndGetManager(e){const t=await async function(e){const t=await ns(e),n=vr().gapi;return jn(n,e,"internal-error"),t.open({where:document.body,url:os(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:rs,dontclear:!0},(t=>new Promise((async(n,i)=>{await t.restyle({setHideOnLeave:!1});const r=Un(e,"network-request-failed"),s=vr().setTimeout((()=>{i(r)}),is.get());function o(){vr().clearTimeout(s),n(t)}t.ping(o).then(o,(()=>{i(r)}))}))))}(e),n=new Gr(e);return t.register("authEvent",(t=>(jn(null==t?void 0:t.authEvent,e,"invalid-auth-event"),{status:n.onEvent(t.authEvent)?"ACK":"ERROR"})),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(hs,{type:hs},(n=>{var i;const r=null===(i=null==n?void 0:n[0])||void 0===i?void 0:i[hs];void 0!==r&&t(!!r),Fn(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=async function(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e,t={}){return Yn(e,"GET","/v1/projects",t)}(e);for(const e of t)try{if(Yr(e))return}catch(e){}Fn(e,"unauthorized-domain")}(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Ni()||bi()||Ai()}};var fs="@firebase/auth",ps="0.23.2";class gs{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{e((null==t?void 0:t.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){jn(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const ms=l("authIdTokenMaxAge")||300;let ys=null;var vs;vs="Browser",me(new O("auth",((e,{options:t})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),r=e.getProvider("app-check-internal"),{apiKey:s,authDomain:o}=n.options;jn(s&&!s.includes(":"),"invalid-api-key",{appName:n.name});const a={apiKey:s,authDomain:o,clientPlatform:vs,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Di(vs)},c=new Vi(n,i,r,a);return function(e,t){const n=(null==t?void 0:t.persistence)||[],i=(Array.isArray(n)?n:[n]).map(gi);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(i,null==t?void 0:t.popupRedirectResolver)}(c,t),c}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider("auth-internal").initialize()}))),me(new O("auth-internal",(e=>(e=>new gs(e))(Bi(e.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),Te(fs,ps,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(vs)),Te(fs,ps,"esm2017");var ws,Is="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Es={},bs=bs||{},Ts=Is||self;function _s(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function Cs(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var Ss="closure_uid_"+(1e9*Math.random()>>>0),ks=0;function As(e,t,n){return e.call.apply(e.bind,arguments)}function Ns(e,t,n){if(!e)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function Ds(e,t,n){return(Ds=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?As:Ns).apply(null,arguments)}function Rs(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function Os(e,t){function n(){}n.prototype=t.prototype,e.$=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.ac=function(e,n,i){for(var r=Array(arguments.length-2),s=2;s<arguments.length;s++)r[s-2]=arguments[s];return t.prototype[n].apply(e,r)}}function Ps(){this.s=this.s,this.o=this.o}Ps.prototype.s=!1,Ps.prototype.sa=function(){var e;!this.s&&(this.s=!0,this.N(),0)&&(e=this,Object.prototype.hasOwnProperty.call(e,Ss)&&e[Ss]||(e[Ss]=++ks))},Ps.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Ls=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(let n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1};function Ms(e){const t=e.length;if(0<t){const n=Array(t);for(let i=0;i<t;i++)n[i]=e[i];return n}return[]}function xs(e,t){for(let t=1;t<arguments.length;t++){const n=arguments[t];if(_s(n)){const t=e.length||0,i=n.length||0;e.length=t+i;for(let r=0;r<i;r++)e[t+r]=n[r]}else e.push(n)}}function Fs(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}Fs.prototype.h=function(){this.defaultPrevented=!0};var Us=function(){if(!Ts.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{Ts.addEventListener("test",(()=>{}),t),Ts.removeEventListener("test",(()=>{}),t)}catch(e){}return e}();function Vs(e){return/^[\s\xa0]*$/.test(e)}function Bs(){var e=Ts.navigator;return e&&(e=e.userAgent)?e:""}function js(e){return-1!=Bs().indexOf(e)}function $s(e){return $s[" "](e),e}$s[" "]=function(){};var qs,zs,Hs,Ks=js("Opera"),Gs=js("Trident")||js("MSIE"),Ws=js("Edge"),Qs=Ws||Gs,Js=js("Gecko")&&!(-1!=Bs().toLowerCase().indexOf("webkit")&&!js("Edge"))&&!(js("Trident")||js("MSIE"))&&!js("Edge"),Xs=-1!=Bs().toLowerCase().indexOf("webkit")&&!js("Edge");function Ys(){var e=Ts.document;return e?e.documentMode:void 0}e:{var Zs="",eo=(zs=Bs(),Js?/rv:([^\);]+)(\)|;)/.exec(zs):Ws?/Edge\/([\d\.]+)/.exec(zs):Gs?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(zs):Xs?/WebKit\/(\S+)/.exec(zs):Ks?/(?:Version)[ \/]?(\S+)/.exec(zs):void 0);if(eo&&(Zs=eo?eo[1]:""),Gs){var to=Ys();if(null!=to&&to>parseFloat(Zs)){qs=String(to);break e}}qs=Zs}Ts.document&&Gs?Hs=Ys()||parseInt(qs,10)||void 0:Hs=void 0;var no=Hs;function io(e,t){if(Fs.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,i=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(Js){e:{try{$s(t.nodeName);var r=!0;break e}catch(e){}r=!1}r||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:ro[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&io.$.h.call(this)}}Os(io,Fs);var ro={2:"touch",3:"pen",4:"mouse"};io.prototype.h=function(){io.$.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var so="closure_listenable_"+(1e6*Math.random()|0),oo=0;function ao(e,t,n,i,r){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!i,this.la=r,this.key=++oo,this.fa=this.ia=!1}function co(e){e.fa=!0,e.listener=null,e.proxy=null,e.src=null,e.la=null}function uo(e,t,n){for(const i in e)t.call(n,e[i],i,e)}function lo(e){const t={};for(const n in e)t[n]=e[n];return t}const ho="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function fo(e,t){let n,i;for(let t=1;t<arguments.length;t++){for(n in i=arguments[t],i)e[n]=i[n];for(let t=0;t<ho.length;t++)n=ho[t],Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}}function po(e){this.src=e,this.g={},this.h=0}function go(e,t){var n=t.type;if(n in e.g){var i,r=e.g[n],s=Ls(r,t);(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(co(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function mo(e,t,n,i){for(var r=0;r<e.length;++r){var s=e[r];if(!s.fa&&s.listener==t&&s.capture==!!n&&s.la==i)return r}return-1}po.prototype.add=function(e,t,n,i,r){var s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);var o=mo(e,t,i,r);return-1<o?(t=e[o],n||(t.ia=!1)):((t=new ao(t,this.src,s,!!i,r)).ia=n,e.push(t)),t};var yo="closure_lm_"+(1e6*Math.random()|0),vo={};function wo(e,t,n,i,r){if(i&&i.once)return Eo(e,t,n,i,r);if(Array.isArray(t)){for(var s=0;s<t.length;s++)wo(e,t[s],n,i,r);return null}return n=Ao(n),e&&e[so]?e.O(t,n,Cs(i)?!!i.capture:!!i,r):Io(e,t,n,!1,i,r)}function Io(e,t,n,i,r,s){if(!t)throw Error("Invalid event type");var o=Cs(r)?!!r.capture:!!r,a=So(e);if(a||(e[yo]=a=new po(e)),(n=a.add(t,n,i,o,s)).proxy)return n;if(i=function(){const e=Co;return function t(n){return e.call(t.src,t.listener,n)}}(),n.proxy=i,i.src=e,i.listener=n,e.addEventListener)Us||(r=o),void 0===r&&(r=!1),e.addEventListener(t.toString(),i,r);else if(e.attachEvent)e.attachEvent(_o(t.toString()),i);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(i)}return n}function Eo(e,t,n,i,r){if(Array.isArray(t)){for(var s=0;s<t.length;s++)Eo(e,t[s],n,i,r);return null}return n=Ao(n),e&&e[so]?e.P(t,n,Cs(i)?!!i.capture:!!i,r):Io(e,t,n,!0,i,r)}function bo(e,t,n,i,r){if(Array.isArray(t))for(var s=0;s<t.length;s++)bo(e,t[s],n,i,r);else i=Cs(i)?!!i.capture:!!i,n=Ao(n),e&&e[so]?(e=e.i,(t=String(t).toString())in e.g&&-1<(n=mo(s=e.g[t],n,i,r))&&(co(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete e.g[t],e.h--))):e&&(e=So(e))&&(t=e.g[t.toString()],e=-1,t&&(e=mo(t,n,i,r)),(n=-1<e?t[e]:null)&&To(n))}function To(e){if("number"!=typeof e&&e&&!e.fa){var t=e.src;if(t&&t[so])go(t.i,e);else{var n=e.type,i=e.proxy;t.removeEventListener?t.removeEventListener(n,i,e.capture):t.detachEvent?t.detachEvent(_o(n),i):t.addListener&&t.removeListener&&t.removeListener(i),(n=So(t))?(go(n,e),0==n.h&&(n.src=null,t[yo]=null)):co(e)}}}function _o(e){return e in vo?vo[e]:vo[e]="on"+e}function Co(e,t){if(e.fa)e=!0;else{t=new io(t,this);var n=e.listener,i=e.la||e.src;e.ia&&To(e),e=n.call(i,t)}return e}function So(e){return(e=e[yo])instanceof po?e:null}var ko="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ao(e){return"function"==typeof e?e:(e[ko]||(e[ko]=function(t){return e.handleEvent(t)}),e[ko])}function No(){Ps.call(this),this.i=new po(this),this.S=this,this.J=null}function Do(e,t){var n,i=e.J;if(i)for(n=[];i;i=i.J)n.push(i);if(e=e.S,i=t.type||t,"string"==typeof t)t=new Fs(t,e);else if(t instanceof Fs)t.target=t.target||e;else{var r=t;fo(t=new Fs(i,e),r)}if(r=!0,n)for(var s=n.length-1;0<=s;s--){var o=t.g=n[s];r=Ro(o,i,!0,t)&&r}if(r=Ro(o=t.g=e,i,!0,t)&&r,r=Ro(o,i,!1,t)&&r,n)for(s=0;s<n.length;s++)r=Ro(o=t.g=n[s],i,!1,t)&&r}function Ro(e,t,n,i){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var r=!0,s=0;s<t.length;++s){var o=t[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,c=o.la||o.src;o.ia&&go(e.i,o),r=!1!==a.call(c,i)&&r}}return r&&!i.defaultPrevented}Os(No,Ps),No.prototype[so]=!0,No.prototype.removeEventListener=function(e,t,n,i){bo(this,e,t,n,i)},No.prototype.N=function(){if(No.$.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],i=0;i<n.length;i++)co(n[i]);delete t.g[e],t.h--}}this.J=null},No.prototype.O=function(e,t,n,i){return this.i.add(String(e),t,!1,n,i)},No.prototype.P=function(e,t,n,i){return this.i.add(String(e),t,!0,n,i)};var Oo=Ts.JSON.stringify;function Po(){var e=Bo;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var Lo=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}((()=>new Mo),(e=>e.reset()));class Mo{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function xo(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function Fo(e){Ts.setTimeout((()=>{throw e}),0)}let Uo,Vo=!1,Bo=new class{constructor(){this.h=this.g=null}add(e,t){const n=Lo.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},jo=()=>{const e=Ts.Promise.resolve(void 0);Uo=()=>{e.then($o)}};var $o=()=>{for(var e;e=Po();){try{e.h.call(e.g)}catch(e){Fo(e)}var t=Lo;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}Vo=!1};function qo(e,t){No.call(this),this.h=e||1,this.g=t||Ts,this.j=Ds(this.qb,this),this.l=Date.now()}function zo(e){e.ga=!1,e.T&&(e.g.clearTimeout(e.T),e.T=null)}function Ho(e,t,n){if("function"==typeof e)n&&(e=Ds(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=Ds(e.handleEvent,e)}return 2147483647<Number(t)?-1:Ts.setTimeout(e,t||0)}function Ko(e){e.g=Ho((()=>{e.g=null,e.i&&(e.i=!1,Ko(e))}),e.j);const t=e.h;e.h=null,e.m.apply(null,t)}Os(qo,No),(ws=qo.prototype).ga=!1,ws.T=null,ws.qb=function(){if(this.ga){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-e):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Do(this,"tick"),this.ga&&(zo(this),this.start()))}},ws.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},ws.N=function(){qo.$.N.call(this),zo(this),delete this.g};class Go extends Ps{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:Ko(this)}N(){super.N(),this.g&&(Ts.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Wo(e){Ps.call(this),this.h=e,this.g={}}Os(Wo,Ps);var Qo=[];function Jo(e,t,n,i){Array.isArray(n)||(n&&(Qo[0]=n.toString()),n=Qo);for(var r=0;r<n.length;r++){var s=wo(t,n[r],i||e.handleEvent,!1,e.h||e);if(!s)break;e.g[s.key]=s}}function Xo(e){uo(e.g,(function(e,t){this.g.hasOwnProperty(t)&&To(e)}),e),e.g={}}function Yo(){this.g=!0}function Zo(e,t,n,i){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var i=n[e];if(!(2>i.length)){var r=i[1];if(Array.isArray(r)&&!(1>r.length)){var s=r[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<r.length;o++)r[o]=""}}}return Oo(n)}catch(e){return t}}(e,n)+(i?" "+i:"")}))}Wo.prototype.N=function(){Wo.$.N.call(this),Xo(this)},Wo.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Yo.prototype.Ea=function(){this.g=!1},Yo.prototype.info=function(){};var ea={},ta=null;function na(){return ta=ta||new No}function ia(e){Fs.call(this,ea.Ta,e)}function ra(e){const t=na();Do(t,new ia(t))}function sa(e,t){Fs.call(this,ea.STAT_EVENT,e),this.stat=t}function oa(e){const t=na();Do(t,new sa(t,e))}function aa(e,t){Fs.call(this,ea.Ua,e),this.size=t}function ca(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return Ts.setTimeout((function(){e()}),t)}ea.Ta="serverreachability",Os(ia,Fs),ea.STAT_EVENT="statevent",Os(sa,Fs),ea.Ua="timingevent",Os(aa,Fs);var ua={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},la={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function ha(){}function da(e){return e.h||(e.h=e.i())}function fa(){}ha.prototype.h=null;var pa,ga={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function ma(){Fs.call(this,"d")}function ya(){Fs.call(this,"c")}function va(){}function wa(e,t,n,i){this.l=e,this.j=t,this.m=n,this.W=i||1,this.U=new Wo(this),this.P=Ea,e=Qs?125:void 0,this.V=new qo(e),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new Ia}function Ia(){this.i=null,this.g="",this.h=!1}Os(ma,Fs),Os(ya,Fs),Os(va,ha),va.prototype.g=function(){return new XMLHttpRequest},va.prototype.i=function(){return{}},pa=new va;var Ea=45e3,ba={},Ta={};function _a(e,t,n){e.L=1,e.v=qa(Ua(t)),e.s=n,e.S=!0,Ca(e,null)}function Ca(e,t){e.G=Date.now(),Na(e),e.A=Ua(e.v);var n=e.A,i=e.W;Array.isArray(i)||(i=[String(i)]),nc(n.i,"t",i),e.C=0,n=e.l.J,e.h=new Ia,e.g=nu(e.l,n?t:null,!e.s),0<e.O&&(e.M=new Go(Ds(e.Pa,e,e.g),e.O)),Jo(e.U,e.g,"readystatechange",e.nb),t=e.I?lo(e.I):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ha(e.A,e.u,e.s,t)):(e.u="GET",e.g.ha(e.A,e.u,null,t)),ra(),function(e,t,n,i,r,s){e.info((function(){if(e.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var u=a[c].split("=");if(1<u.length){var l=u[0];u=u[1];var h=l.split("_");o=2<=h.length&&"type"==h[1]?o+(l+"=")+u+"&":o+(l+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+i+") [attempt "+r+"]: "+t+"\n"+n+"\n"+o}))}(e.j,e.u,e.A,e.m,e.W,e.s)}function Sa(e){return!!e.g&&"GET"==e.u&&2!=e.L&&e.l.Ha}function ka(e,t,n){let i,r=!0;for(;!e.J&&e.C<n.length;){if(i=Aa(e,n),i==Ta){4==t&&(e.o=4,oa(14),r=!1),Zo(e.j,e.m,null,"[Incomplete Response]");break}if(i==ba){e.o=4,oa(15),Zo(e.j,e.m,n,"[Invalid Chunk]"),r=!1;break}Zo(e.j,e.m,i,null),La(e,i)}Sa(e)&&i!=Ta&&i!=ba&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,oa(16),r=!1),e.i=e.i&&r,r?0<n.length&&!e.ba&&(e.ba=!0,(t=e.l).g==e&&t.ca&&!t.M&&(t.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),Wc(t),t.M=!0,oa(11))):(Zo(e.j,e.m,n,"[Invalid Chunked Response]"),Pa(e),Oa(e))}function Aa(e,t){var n=e.C,i=t.indexOf("\n",n);return-1==i?Ta:(n=Number(t.substring(n,i)),isNaN(n)?ba:(i+=1)+n>t.length?Ta:(t=t.slice(i,i+n),e.C=i+n,t))}function Na(e){e.Y=Date.now()+e.P,Da(e,e.P)}function Da(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=ca(Ds(e.lb,e),t)}function Ra(e){e.B&&(Ts.clearTimeout(e.B),e.B=null)}function Oa(e){0==e.l.H||e.J||Xc(e.l,e)}function Pa(e){Ra(e);var t=e.M;t&&"function"==typeof t.sa&&t.sa(),e.M=null,zo(e.V),Xo(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.sa())}function La(e,t){try{var n=e.l;if(0!=n.H&&(n.g==e||uc(n.i,e)))if(!e.K&&uc(n.i,e)&&3==n.H){try{var i=n.Ja.g.parse(t)}catch(e){i=null}if(Array.isArray(i)&&3==i.length){var r=i;if(0==r[0]){e:if(!n.u){if(n.g){if(!(n.g.G+3e3<e.G))break e;Jc(n),Bc(n)}Gc(n),oa(18)}}else n.Fa=r[1],0<n.Fa-n.V&&37500>r[2]&&n.G&&0==n.A&&!n.v&&(n.v=ca(Ds(n.ib,n),6e3));if(1>=cc(n.i)&&n.oa){try{n.oa()}catch(e){}n.oa=void 0}}else Zc(n,11)}else if((e.K||n.g==e)&&Jc(n),!Vs(t))for(r=n.Ja.g.parse(t),t=0;t<r.length;t++){let u=r[t];if(n.V=u[0],u=u[1],2==n.H)if("c"==u[0]){n.K=u[1],n.pa=u[2];const t=u[3];null!=t&&(n.ra=t,n.l.info("VER="+n.ra));const r=u[4];null!=r&&(n.Ga=r,n.l.info("SVER="+n.Ga));const l=u[5];null!=l&&"number"==typeof l&&0<l&&(i=1.5*l,n.L=i,n.l.info("backChannelRequestTimeoutMs_="+i)),i=n;const h=e.g;if(h){const e=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=i.i;s.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(lc(s,s.h),s.h=null))}if(i.F){const e=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(i.Da=e,$a(i.I,i.F,e))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-e.G,n.l.info("Handshake RTT: "+n.S+"ms"));var o=e;if((i=n).wa=tu(i,i.J?i.pa:null,i.Y),o.K){hc(i.i,o);var a=o,c=i.L;c&&a.setTimeout(c),a.B&&(Ra(a),Na(a)),i.g=o}else Kc(i);0<n.j.length&&$c(n)}else"stop"!=u[0]&&"close"!=u[0]||Zc(n,7);else 3==n.H&&("stop"==u[0]||"close"==u[0]?"stop"==u[0]?Zc(n,7):Vc(n):"noop"!=u[0]&&n.h&&n.h.Aa(u),n.A=0)}ra()}catch(e){}}function Ma(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(_s(e)||"string"==typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.ta&&"function"==typeof e.ta)return e.ta();if(!e.Z||"function"!=typeof e.Z){if("undefined"!=typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!=typeof Set&&e instanceof Set)){if(_s(e)||"string"==typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const i in e)t[n++]=i;return t}}}(e),i=function(e){if(e.Z&&"function"==typeof e.Z)return e.Z();if("undefined"!=typeof Map&&e instanceof Map||"undefined"!=typeof Set&&e instanceof Set)return Array.from(e.values());if("string"==typeof e)return e.split("");if(_s(e)){for(var t=[],n=e.length,i=0;i<n;i++)t.push(e[i]);return t}for(i in t=[],n=0,e)t[n++]=e[i];return t}(e),r=i.length,s=0;s<r;s++)t.call(void 0,i[s],n&&n[s],e)}(ws=wa.prototype).setTimeout=function(e){this.P=e},ws.nb=function(e){e=e.target;const t=this.M;t&&3==Pc(e)?t.l():this.Pa(e)},ws.Pa=function(e){try{if(e==this.g)e:{const l=Pc(this.g);var t=this.g.Ia();if(this.g.da(),!(3>l)&&(3!=l||Qs||this.g&&(this.h.h||this.g.ja()||Lc(this.g)))){this.J||4!=l||7==t||ra(),Ra(this);var n=this.g.da();this.ca=n;t:if(Sa(this)){var i=Lc(this.g);e="";var r=i.length,s=4==Pc(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Pa(this),Oa(this);var o="";break t}this.h.i=new Ts.TextDecoder}for(t=0;t<r;t++)this.h.h=!0,e+=this.h.i.decode(i[t],{stream:s&&t==r-1});i.splice(0,r),this.h.g+=e,this.C=0,o=this.h.g}else o=this.g.ja();if(this.i=200==n,function(e,t,n,i,r,s,o){e.info((function(){return"XMLHTTP RESP ("+i+") [ attempt "+r+"]: "+t+"\n"+n+"\n"+s+" "+o}))}(this.j,this.u,this.A,this.m,this.W,l,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Vs(a)){var u=a;break t}}u=null}if(!(n=u)){this.i=!1,this.o=3,oa(12),Pa(this),Oa(this);break e}Zo(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,La(this,n)}this.S?(ka(this,l,o),Qs&&this.i&&3==l&&(Jo(this.U,this.V,"tick",this.mb),this.V.start())):(Zo(this.j,this.m,o,null),La(this,o)),4==l&&Pa(this),this.i&&!this.J&&(4==l?Xc(this.l,this):(this.i=!1,Na(this)))}else(function(e){const t={};e=(e.g&&2<=Pc(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let i=0;i<e.length;i++){if(Vs(e[i]))continue;var n=xo(e[i]);const r=n[0];if("string"!=typeof(n=n[1]))continue;n=n.trim();const s=t[r]||[];t[r]=s,s.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,(function(e){return e.join(", ")}))})(this.g),400==n&&0<o.indexOf("Unknown SID")?(this.o=3,oa(12)):(this.o=0,oa(13)),Pa(this),Oa(this)}}}catch(e){}},ws.mb=function(){if(this.g){var e=Pc(this.g),t=this.g.ja();this.C<t.length&&(Ra(this),ka(this,e,t),this.i&&4!=e&&Na(this))}},ws.cancel=function(){this.J=!0,Pa(this)},ws.lb=function(){this.B=null;const e=Date.now();0<=e-this.Y?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.j,this.A),2!=this.L&&(ra(),oa(17)),Pa(this),this.o=2,Oa(this)):Da(this,this.Y-e)};var xa=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Fa(e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,e instanceof Fa){this.h=e.h,Va(this,e.j),this.s=e.s,this.g=e.g,Ba(this,e.m),this.l=e.l;var t=e.i,n=new Ya;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),ja(this,n),this.o=e.o}else e&&(t=String(e).match(xa))?(this.h=!1,Va(this,t[1]||"",!0),this.s=za(t[2]||""),this.g=za(t[3]||"",!0),Ba(this,t[4]),this.l=za(t[5]||"",!0),ja(this,t[6]||"",!0),this.o=za(t[7]||"")):(this.h=!1,this.i=new Ya(null,this.h))}function Ua(e){return new Fa(e)}function Va(e,t,n){e.j=n?za(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function Ba(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function ja(e,t,n){t instanceof Ya?(e.i=t,function(e,t){t&&!e.j&&(Za(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(ec(this,t),nc(this,n,e))}),e)),e.j=t}(e.i,e.h)):(n||(t=Ha(t,Ja)),e.i=new Ya(t,e.h))}function $a(e,t,n){e.i.set(t,n)}function qa(e){return $a(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function za(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Ha(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,Ka),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Ka(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}Fa.prototype.toString=function(){var e=[],t=this.j;t&&e.push(Ha(t,Ga,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(Ha(t,Ga,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(Ha(n,"/"==n.charAt(0)?Qa:Wa,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.o)&&e.push("#",Ha(n,Xa)),e.join("")};var Ga=/[#\/\?@]/g,Wa=/[#\?:]/g,Qa=/[#\?]/g,Ja=/[#\?@]/g,Xa=/#/g;function Ya(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Za(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var i=e[n].indexOf("="),r=null;if(0<=i){var s=e[n].substring(0,i);r=e[n].substring(i+1)}else s=e[n];t(s,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function ec(e,t){Za(e),t=ic(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function tc(e,t){return Za(e),t=ic(e,t),e.g.has(t)}function nc(e,t,n){ec(e,t),0<n.length&&(e.i=null,e.g.set(ic(e,t),Ms(n)),e.h+=n.length)}function ic(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}(ws=Ya.prototype).add=function(e,t){Za(this),this.i=null,e=ic(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},ws.forEach=function(e,t){Za(this),this.g.forEach((function(n,i){n.forEach((function(n){e.call(t,n,i,this)}),this)}),this)},ws.ta=function(){Za(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let i=0;i<t.length;i++){const r=e[i];for(let e=0;e<r.length;e++)n.push(t[i])}return n},ws.Z=function(e){Za(this);let t=[];if("string"==typeof e)tc(this,e)&&(t=t.concat(this.g.get(ic(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},ws.set=function(e,t){return Za(this),this.i=null,tc(this,e=ic(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},ws.get=function(e,t){return e&&0<(e=this.Z(e)).length?String(e[0]):t},ws.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var i=t[n];const s=encodeURIComponent(String(i)),o=this.Z(i);for(i=0;i<o.length;i++){var r=s;""!==o[i]&&(r+="="+encodeURIComponent(String(o[i]))),e.push(r)}}return this.i=e.join("&")};var rc=class{constructor(e,t){this.g=e,this.map=t}};function sc(e){this.l=e||oc,e=Ts.PerformanceNavigationTiming?0<(e=Ts.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(Ts.g&&Ts.g.Ka&&Ts.g.Ka()&&Ts.g.Ka().ec),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var oc=10;function ac(e){return!!e.h||!!e.g&&e.g.size>=e.j}function cc(e){return e.h?1:e.g?e.g.size:0}function uc(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function lc(e,t){e.g?e.g.add(t):e.h=t}function hc(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function dc(e){if(null!=e.h)return e.i.concat(e.h.F);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.F);return t}return Ms(e.i)}sc.prototype.cancel=function(){if(this.i=dc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var fc=class{stringify(e){return Ts.JSON.stringify(e,void 0)}parse(e){return Ts.JSON.parse(e,void 0)}};function pc(){this.g=new fc}function gc(e,t,n){const i=n||"";try{Ma(e,(function(e,n){let r=e;Cs(e)&&(r=Oo(e)),t.push(i+n+"="+encodeURIComponent(r))}))}catch(e){throw t.push(i+"type="+encodeURIComponent("_badmap")),e}}function mc(e,t,n,i,r){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,r(i)}catch(e){}}function yc(e){this.l=e.fc||null,this.j=e.ob||!1}function vc(e,t){No.call(this),this.F=e,this.u=t,this.m=void 0,this.readyState=wc,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Os(yc,ha),yc.prototype.g=function(){return new vc(this.l,this.j)},yc.prototype.i=function(e){return function(){return e}}({}),Os(vc,No);var wc=0;function Ic(e){e.j.read().then(e.Xa.bind(e)).catch(e.ka.bind(e))}function Ec(e){e.readyState=4,e.l=null,e.j=null,e.A=null,bc(e)}function bc(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(ws=vc.prototype).open=function(e,t){if(this.readyState!=wc)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,bc(this)},ws.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.F||Ts).fetch(new Request(this.B,t)).then(this.$a.bind(this),this.ka.bind(this))},ws.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Ec(this)),this.readyState=wc},ws.$a=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,bc(this)),this.g&&(this.readyState=3,bc(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(void 0!==Ts.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Ic(this)}else e.text().then(this.Za.bind(this),this.ka.bind(this))},ws.Xa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Ec(this):bc(this),3==this.readyState&&Ic(this)}},ws.Za=function(e){this.g&&(this.response=this.responseText=e,Ec(this))},ws.Ya=function(e){this.g&&(this.response=e,Ec(this))},ws.ka=function(){this.g&&Ec(this)},ws.setRequestHeader=function(e,t){this.v.append(e,t)},ws.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},ws.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(vc.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var Tc=Ts.JSON.parse;function _c(e){No.call(this),this.headers=new Map,this.u=e||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=Cc,this.L=this.M=!1}Os(_c,No);var Cc="",Sc=/^https?$/i,kc=["POST","PUT"];function Ac(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,Nc(e),Rc(e)}function Nc(e){e.F||(e.F=!0,Do(e,"complete"),Do(e,"error"))}function Dc(e){if(e.h&&void 0!==bs&&(!e.C[1]||4!=Pc(e)||2!=e.da()))if(e.v&&4==Pc(e))Ho(e.La,0,e);else if(Do(e,"readystatechange"),4==Pc(e)){e.h=!1;try{const o=e.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var i;if(i=0===o){var r=String(e.I).match(xa)[1]||null;!r&&Ts.self&&Ts.self.location&&(r=Ts.self.location.protocol.slice(0,-1)),i=!Sc.test(r?r.toLowerCase():"")}n=i}if(n)Do(e,"complete"),Do(e,"success");else{e.m=6;try{var s=2<Pc(e)?e.g.statusText:""}catch(e){s=""}e.j=s+" ["+e.da()+"]",Nc(e)}}finally{Rc(e)}}}function Rc(e,t){if(e.g){Oc(e);const n=e.g,i=e.C[0]?()=>{}:null;e.g=null,e.C=null,t||Do(e,"ready");try{n.onreadystatechange=i}catch(e){}}}function Oc(e){e.g&&e.L&&(e.g.ontimeout=null),e.A&&(Ts.clearTimeout(e.A),e.A=null)}function Pc(e){return e.g?e.g.readyState:0}function Lc(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.K){case Cc:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(e){return null}}function Mc(e){let t="";return uo(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}function xc(e,t,n){e:{for(i in n){var i=!1;break e}i=!0}i||(n=Mc(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):$a(e,t,n))}function Fc(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Uc(e){this.Ga=0,this.j=[],this.l=new Yo,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Fc("failFast",!1,e),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Fc("baseRetryDelayMs",5e3,e),this.hb=Fc("retryDelaySeedMs",1e4,e),this.eb=Fc("forwardChannelMaxRetries",2,e),this.xa=Fc("forwardChannelRequestTimeoutMs",2e4,e),this.va=e&&e.xmlHttpFactory||void 0,this.Ha=e&&e.dc||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.i=new sc(e&&e.concurrentRequestLimit),this.Ja=new pc,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=e&&e.bc||!1,e&&e.Ea&&this.l.Ea(),e&&e.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&e&&e.detectBufferingProxy||!1,this.qa=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.qa=e.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function Vc(e){if(jc(e),3==e.H){var t=e.W++,n=Ua(e.I);if($a(n,"SID",e.K),$a(n,"RID",t),$a(n,"TYPE","terminate"),zc(e,n),(t=new wa(e,e.l,t)).L=2,t.v=qa(Ua(n)),n=!1,Ts.navigator&&Ts.navigator.sendBeacon)try{n=Ts.navigator.sendBeacon(t.v.toString(),"")}catch(e){}!n&&Ts.Image&&((new Image).src=t.v,n=!0),n||(t.g=nu(t.l,null),t.g.ha(t.v)),t.G=Date.now(),Na(t)}eu(e)}function Bc(e){e.g&&(Wc(e),e.g.cancel(),e.g=null)}function jc(e){Bc(e),e.u&&(Ts.clearTimeout(e.u),e.u=null),Jc(e),e.i.cancel(),e.m&&("number"==typeof e.m&&Ts.clearTimeout(e.m),e.m=null)}function $c(e){if(!ac(e.i)&&!e.m){e.m=!0;var t=e.Na;Uo||jo(),Vo||(Uo(),Vo=!0),Bo.add(t,e),e.C=0}}function qc(e,t){var n;n=t?t.m:e.W++;const i=Ua(e.I);$a(i,"SID",e.K),$a(i,"RID",n),$a(i,"AID",e.V),zc(e,i),e.o&&e.s&&xc(i,e.o,e.s),n=new wa(e,e.l,n,e.C+1),null===e.o&&(n.I=e.s),t&&(e.j=t.F.concat(e.j)),t=Hc(e,n,1e3),n.setTimeout(Math.round(.5*e.xa)+Math.round(.5*e.xa*Math.random())),lc(e.i,n),_a(n,i,t)}function zc(e,t){e.na&&uo(e.na,(function(e,n){$a(t,n,e)})),e.h&&Ma({},(function(e,n){$a(t,n,e)}))}function Hc(e,t,n){n=Math.min(e.j.length,n);var i=e.h?Ds(e.h.Va,e.h,e):null;e:{var r=e.j;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=r[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let s=!0;for(let o=0;o<n;o++){let n=r[o].g;const a=r[o].map;if(n-=t,0>n)t=Math.max(0,r[o].g-100),s=!1;else try{gc(a,e,"req"+n+"_")}catch(e){i&&i(a)}}if(s){i=e.join("&");break e}}}return e=e.j.splice(0,n),t.F=e,i}function Kc(e){if(!e.g&&!e.u){e.ba=1;var t=e.Ma;Uo||jo(),Vo||(Uo(),Vo=!0),Bo.add(t,e),e.A=0}}function Gc(e){return!(e.g||e.u||3<=e.A||(e.ba++,e.u=ca(Ds(e.Ma,e),Yc(e,e.A)),e.A++,0))}function Wc(e){null!=e.B&&(Ts.clearTimeout(e.B),e.B=null)}function Qc(e){e.g=new wa(e,e.l,"rpc",e.ba),null===e.o&&(e.g.I=e.s),e.g.O=0;var t=Ua(e.wa);$a(t,"RID","rpc"),$a(t,"SID",e.K),$a(t,"AID",e.V),$a(t,"CI",e.G?"0":"1"),!e.G&&e.qa&&$a(t,"TO",e.qa),$a(t,"TYPE","xmlhttp"),zc(e,t),e.o&&e.s&&xc(t,e.o,e.s),e.L&&e.g.setTimeout(e.L);var n=e.g;e=e.pa,n.L=1,n.v=qa(Ua(t)),n.s=null,n.S=!0,Ca(n,e)}function Jc(e){null!=e.v&&(Ts.clearTimeout(e.v),e.v=null)}function Xc(e,t){var n=null;if(e.g==t){Jc(e),Wc(e),e.g=null;var i=2}else{if(!uc(e.i,t))return;n=t.F,hc(e.i,t),i=1}if(0!=e.H)if(t.i)if(1==i){n=t.s?t.s.length:0,t=Date.now()-t.G;var r=e.C;Do(i=na(),new aa(i,n)),$c(e)}else Kc(e);else if(3==(r=t.o)||0==r&&0<t.ca||!(1==i&&function(e,t){return!(cc(e.i)>=e.i.j-(e.m?1:0)||(e.m?(e.j=t.F.concat(e.j),0):1==e.H||2==e.H||e.C>=(e.cb?0:e.eb)||(e.m=ca(Ds(e.Na,e,t),Yc(e,e.C)),e.C++,0)))}(e,t)||2==i&&Gc(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),r){case 1:Zc(e,5);break;case 4:Zc(e,10);break;case 3:Zc(e,6);break;default:Zc(e,2)}}function Yc(e,t){let n=e.ab+Math.floor(Math.random()*e.hb);return e.isActive()||(n*=2),n*t}function Zc(e,t){if(e.l.info("Error code "+t),2==t){var n=null;e.h&&(n=null);var i=Ds(e.pb,e);n||(n=new Fa("//www.google.com/images/cleardot.gif"),Ts.location&&"http"==Ts.location.protocol||Va(n,"https"),qa(n)),function(e,t){const n=new Yo;if(Ts.Image){const i=new Image;i.onload=Rs(mc,n,i,"TestLoadImage: loaded",!0,t),i.onerror=Rs(mc,n,i,"TestLoadImage: error",!1,t),i.onabort=Rs(mc,n,i,"TestLoadImage: abort",!1,t),i.ontimeout=Rs(mc,n,i,"TestLoadImage: timeout",!1,t),Ts.setTimeout((function(){i.ontimeout&&i.ontimeout()}),1e4),i.src=e}else t(!1)}(n.toString(),i)}else oa(2);e.H=0,e.h&&e.h.za(t),eu(e),jc(e)}function eu(e){if(e.H=0,e.ma=[],e.h){const t=dc(e.i);0==t.length&&0==e.j.length||(xs(e.ma,t),xs(e.ma,e.j),e.i.i.length=0,Ms(e.j),e.j.length=0),e.h.ya()}}function tu(e,t,n){var i=n instanceof Fa?Ua(n):new Fa(n);if(""!=i.g)t&&(i.g=t+"."+i.g),Ba(i,i.m);else{var r=Ts.location;i=r.protocol,t=t?t+"."+r.hostname:r.hostname,r=+r.port;var s=new Fa(null);i&&Va(s,i),t&&(s.g=t),r&&Ba(s,r),n&&(s.l=n),i=s}return n=e.F,t=e.Da,n&&t&&$a(i,n,t),$a(i,"VER",e.ra),zc(e,i),i}function nu(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=n&&e.Ha&&!e.va?new _c(new yc({ob:!0})):new _c(e.va)).Oa(e.J),t}function iu(){}function ru(){if(Gs&&!(10<=Number(no)))throw Error("Environmental error: no available transport.")}function su(e,t){No.call(this),this.g=new Uc(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.Ca&&(e?e["X-WebChannel-Client-Profile"]=t.Ca:e={"X-WebChannel-Client-Profile":t.Ca}),this.g.U=e,(e=t&&t.cc)&&!Vs(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!Vs(t)&&(this.g.F=t,null!==(e=this.h)&&t in e&&t in(e=this.h)&&delete e[t]),this.j=new cu(this)}function ou(e){ma.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function au(){ya.call(this),this.status=1}function cu(e){this.g=e}function uu(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function lu(e,t,n){n||(n=0);var i=Array(16);if("string"==typeof t)for(var r=0;16>r;++r)i[r]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(r=0;16>r;++r)i[r]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],r=e.g[2];var s=e.g[3],o=t+(s^n&(r^s))+i[0]+3614090360&4294967295;o=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=n+(o<<7&4294967295|o>>>25))+((o=s+(r^t&(n^r))+i[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(t^n))+i[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^r&(s^t))+i[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(r^s))+i[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^t&(n^r))+i[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(t^n))+i[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^r&(s^t))+i[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(r^s))+i[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^t&(n^r))+i[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(t^n))+i[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^r&(s^t))+i[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(r^s))+i[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^t&(n^r))+i[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(t^n))+i[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^r&(s^t))+i[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=t+(r^s&(n^r))+i[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(t^n))+i[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=r+(t^n&(s^t))+i[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(r^s))+i[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=t+(r^s&(n^r))+i[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(t^n))+i[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=r+(t^n&(s^t))+i[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(r^s))+i[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=t+(r^s&(n^r))+i[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(t^n))+i[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=r+(t^n&(s^t))+i[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(r^s))+i[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=t+(r^s&(n^r))+i[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(t^n))+i[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=r+(t^n&(s^t))+i[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(r^s))+i[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=t+(n^r^s)+i[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^r)+i[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^t^n)+i[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^t)+i[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^r^s)+i[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^r)+i[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^t^n)+i[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^t)+i[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^r^s)+i[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^r)+i[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^t^n)+i[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^t)+i[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^r^s)+i[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^r)+i[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^t^n)+i[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^t)+i[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=t+(r^(n|~s))+i[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~r))+i[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=r+(t^(s|~n))+i[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(r|~t))+i[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=t+(r^(n|~s))+i[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~r))+i[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=r+(t^(s|~n))+i[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(r|~t))+i[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=t+(r^(n|~s))+i[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~r))+i[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=r+(t^(s|~n))+i[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(r|~t))+i[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(t=n+((o=t+(r^(n|~s))+i[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~r))+i[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((r=s+((o=r+(t^(s|~n))+i[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~t))+i[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(r+(o<<21&4294967295|o>>>11))&4294967295,e.g[2]=e.g[2]+r&4294967295,e.g[3]=e.g[3]+s&4294967295}function hu(e,t){this.h=t;for(var n=[],i=!0,r=e.length-1;0<=r;r--){var s=0|e[r];i&&s==t||(n[r]=s,i=!1)}this.g=n}(ws=_c.prototype).Oa=function(e){this.M=e},ws.ha=function(e,t,n,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+e);t=t?t.toUpperCase():"GET",this.I=e,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():pa.g(),this.C=this.u?da(this.u):da(pa),this.g.onreadystatechange=Ds(this.La,this);try{this.G=!0,this.g.open(t,String(e),!0),this.G=!1}catch(e){return void Ac(this,e)}if(e=n||"",n=new Map(this.headers),i)if(Object.getPrototypeOf(i)===Object.prototype)for(var r in i)n.set(r,i[r]);else{if("function"!=typeof i.keys||"function"!=typeof i.get)throw Error("Unknown input type for opt_headers: "+String(i));for(const e of i.keys())n.set(e,i.get(e))}i=Array.from(n.keys()).find((e=>"content-type"==e.toLowerCase())),r=Ts.FormData&&e instanceof Ts.FormData,!(0<=Ls(kc,t))||i||r||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[e,t]of n)this.g.setRequestHeader(e,t);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{Oc(this),0<this.B&&((this.L=function(e){return Gs&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Ds(this.ua,this)):this.A=Ho(this.ua,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(e){Ac(this,e)}},ws.ua=function(){void 0!==bs&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Do(this,"timeout"),this.abort(8))},ws.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,Do(this,"complete"),Do(this,"abort"),Rc(this))},ws.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Rc(this,!0)),_c.$.N.call(this)},ws.La=function(){this.s||(this.G||this.v||this.l?Dc(this):this.kb())},ws.kb=function(){Dc(this)},ws.isActive=function(){return!!this.g},ws.da=function(){try{return 2<Pc(this)?this.g.status:-1}catch(e){return-1}},ws.ja=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},ws.Wa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),Tc(t)}},ws.Ia=function(){return this.m},ws.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(ws=Uc.prototype).ra=8,ws.H=1,ws.Na=function(e){if(this.m)if(this.m=null,1==this.H){if(!e){this.W=Math.floor(1e5*Math.random()),e=this.W++;const r=new wa(this,this.l,e);let s=this.s;if(this.U&&(s?(s=lo(s),fo(s,this.U)):s=this.U),null!==this.o||this.O||(r.I=s,s=null),this.P)e:{for(var t=0,n=0;n<this.j.length;n++){var i=this.j[n];if(void 0===(i="__data__"in i.map&&"string"==typeof(i=i.map.__data__)?i.length:void 0))break;if(4096<(t+=i)){t=n;break e}if(4096===t||n===this.j.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=Hc(this,r,t),$a(n=Ua(this.I),"RID",e),$a(n,"CVER",22),this.F&&$a(n,"X-HTTP-Session-Id",this.F),zc(this,n),s&&(this.O?t="headers="+encodeURIComponent(String(Mc(s)))+"&"+t:this.o&&xc(n,this.o,s)),lc(this.i,r),this.bb&&$a(n,"TYPE","init"),this.P?($a(n,"$req",t),$a(n,"SID","null"),r.aa=!0,_a(r,n,null)):_a(r,n,t),this.H=2}}else 3==this.H&&(e?qc(this,e):0==this.j.length||ac(this.i)||qc(this))},ws.Ma=function(){if(this.u=null,Qc(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var e=2*this.S;this.l.info("BP detection timer enabled: "+e),this.B=ca(Ds(this.jb,this),e)}},ws.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,oa(10),Bc(this),Qc(this))},ws.ib=function(){null!=this.v&&(this.v=null,Bc(this),Gc(this),oa(19))},ws.pb=function(e){e?(this.l.info("Successfully pinged google.com"),oa(2)):(this.l.info("Failed to ping google.com"),oa(1))},ws.isActive=function(){return!!this.h&&this.h.isActive(this)},(ws=iu.prototype).Ba=function(){},ws.Aa=function(){},ws.za=function(){},ws.ya=function(){},ws.isActive=function(){return!0},ws.Va=function(){},ru.prototype.g=function(e,t){return new su(e,t)},Os(su,No),su.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var e=this.g,t=this.l,n=this.h||void 0;oa(0),e.Y=t,e.na=n||{},e.G=e.aa,e.I=tu(e,null,e.Y),$c(e)},su.prototype.close=function(){Vc(this.g)},su.prototype.u=function(e){var t=this.g;if("string"==typeof e){var n={};n.__data__=e,e=n}else this.v&&((n={}).__data__=Oo(e),e=n);t.j.push(new rc(t.fb++,e)),3==t.H&&$c(t)},su.prototype.N=function(){this.g.h=null,delete this.j,Vc(this.g),delete this.g,su.$.N.call(this)},Os(ou,ma),Os(au,ya),Os(cu,iu),cu.prototype.Ba=function(){Do(this.g,"a")},cu.prototype.Aa=function(e){Do(this.g,new ou(e))},cu.prototype.za=function(e){Do(this.g,new au)},cu.prototype.ya=function(){Do(this.g,"b")},Os(uu,(function(){this.blockSize=-1})),uu.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},uu.prototype.j=function(e,t){void 0===t&&(t=e.length);for(var n=t-this.blockSize,i=this.m,r=this.h,s=0;s<t;){if(0==r)for(;s<=n;)lu(this,e,s),s+=this.blockSize;if("string"==typeof e){for(;s<t;)if(i[r++]=e.charCodeAt(s++),r==this.blockSize){lu(this,i),r=0;break}}else for(;s<t;)if(i[r++]=e[s++],r==this.blockSize){lu(this,i),r=0;break}}this.h=r,this.i+=t},uu.prototype.l=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.i;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.j(e),e=Array(16),t=n=0;4>t;++t)for(var i=0;32>i;i+=8)e[n++]=this.g[t]>>>i&255;return e};var du={};function fu(e){return-128<=e&&128>e?function(e,t){var n=du;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=function(e){return new hu([0|e],0>e?-1:0)}(e)}(e):new hu([0|e],0>e?-1:0)}function pu(e){if(isNaN(e)||!isFinite(e))return mu;if(0>e)return Eu(pu(-e));for(var t=[],n=1,i=0;e>=n;i++)t[i]=e/n|0,n*=gu;return new hu(t,0)}var gu=4294967296,mu=fu(0),yu=fu(1),vu=fu(16777216);function wu(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function Iu(e){return-1==e.h}function Eu(e){for(var t=e.g.length,n=[],i=0;i<t;i++)n[i]=~e.g[i];return new hu(n,~e.h).add(yu)}function bu(e,t){return e.add(Eu(t))}function Tu(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function _u(e,t){this.g=e,this.h=t}function Cu(e,t){if(wu(t))throw Error("division by zero");if(wu(e))return new _u(mu,mu);if(Iu(e))return t=Cu(Eu(e),t),new _u(Eu(t.g),Eu(t.h));if(Iu(t))return t=Cu(e,Eu(t)),new _u(Eu(t.g),t.h);if(30<e.g.length){if(Iu(e)||Iu(t))throw Error("slowDivide_ only works with positive integers.");for(var n=yu,i=t;0>=i.X(e);)n=Su(n),i=Su(i);var r=ku(n,1),s=ku(i,1);for(i=ku(i,2),n=ku(n,2);!wu(i);){var o=s.add(i);0>=o.X(e)&&(r=r.add(n),s=o),i=ku(i,1),n=ku(n,1)}return t=bu(e,r.R(t)),new _u(r,t)}for(r=mu;0<=e.X(t);){for(n=Math.max(1,Math.floor(e.ea()/t.ea())),i=48>=(i=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,i-48),o=(s=pu(n)).R(t);Iu(o)||0<o.X(e);)o=(s=pu(n-=i)).R(t);wu(s)&&(s=yu),r=r.add(s),e=bu(e,o)}return new _u(r,e)}function Su(e){for(var t=e.g.length+1,n=[],i=0;i<t;i++)n[i]=e.D(i)<<1|e.D(i-1)>>>31;return new hu(n,e.h)}function ku(e,t){var n=t>>5;t%=32;for(var i=e.g.length-n,r=[],s=0;s<i;s++)r[s]=0<t?e.D(s+n)>>>t|e.D(s+n+1)<<32-t:e.D(s+n);return new hu(r,e.h)}(ws=hu.prototype).ea=function(){if(Iu(this))return-Eu(this).ea();for(var e=0,t=1,n=0;n<this.g.length;n++){var i=this.D(n);e+=(0<=i?i:gu+i)*t,t*=gu}return e},ws.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(wu(this))return"0";if(Iu(this))return"-"+Eu(this).toString(e);for(var t=pu(Math.pow(e,6)),n=this,i="";;){var r=Cu(n,t).g,s=((0<(n=bu(n,r.R(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(wu(n=r))return s+i;for(;6>s.length;)s="0"+s;i=s+i}},ws.D=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},ws.X=function(e){return Iu(e=bu(this,e))?-1:wu(e)?0:1},ws.abs=function(){return Iu(this)?Eu(this):this},ws.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0,r=0;r<=t;r++){var s=i+(65535&this.D(r))+(65535&e.D(r)),o=(s>>>16)+(this.D(r)>>>16)+(e.D(r)>>>16);i=o>>>16,s&=65535,o&=65535,n[r]=o<<16|s}return new hu(n,-2147483648&n[n.length-1]?-1:0)},ws.R=function(e){if(wu(this)||wu(e))return mu;if(Iu(this))return Iu(e)?Eu(this).R(Eu(e)):Eu(Eu(this).R(e));if(Iu(e))return Eu(this.R(Eu(e)));if(0>this.X(vu)&&0>e.X(vu))return pu(this.ea()*e.ea());for(var t=this.g.length+e.g.length,n=[],i=0;i<2*t;i++)n[i]=0;for(i=0;i<this.g.length;i++)for(var r=0;r<e.g.length;r++){var s=this.D(i)>>>16,o=65535&this.D(i),a=e.D(r)>>>16,c=65535&e.D(r);n[2*i+2*r]+=o*c,Tu(n,2*i+2*r),n[2*i+2*r+1]+=s*c,Tu(n,2*i+2*r+1),n[2*i+2*r+1]+=o*a,Tu(n,2*i+2*r+1),n[2*i+2*r+2]+=s*a,Tu(n,2*i+2*r+2)}for(i=0;i<t;i++)n[i]=n[2*i+1]<<16|n[2*i];for(i=t;i<2*t;i++)n[i]=0;return new hu(n,0)},ws.gb=function(e){return Cu(this,e).h},ws.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.D(i)&e.D(i);return new hu(n,this.h&e.h)},ws.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.D(i)|e.D(i);return new hu(n,this.h|e.h)},ws.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.D(i)^e.D(i);return new hu(n,this.h^e.h)},ru.prototype.createWebChannel=ru.prototype.g,su.prototype.send=su.prototype.u,su.prototype.open=su.prototype.m,su.prototype.close=su.prototype.close,ua.NO_ERROR=0,ua.TIMEOUT=8,ua.HTTP_ERROR=6,la.COMPLETE="complete",fa.EventType=ga,ga.OPEN="a",ga.CLOSE="b",ga.ERROR="c",ga.MESSAGE="d",No.prototype.listen=No.prototype.O,_c.prototype.listenOnce=_c.prototype.P,_c.prototype.getLastError=_c.prototype.Sa,_c.prototype.getLastErrorCode=_c.prototype.Ia,_c.prototype.getStatus=_c.prototype.da,_c.prototype.getResponseJson=_c.prototype.Wa,_c.prototype.getResponseText=_c.prototype.ja,_c.prototype.send=_c.prototype.ha,_c.prototype.setWithCredentials=_c.prototype.Oa,uu.prototype.digest=uu.prototype.l,uu.prototype.reset=uu.prototype.reset,uu.prototype.update=uu.prototype.j,hu.prototype.add=hu.prototype.add,hu.prototype.multiply=hu.prototype.R,hu.prototype.modulo=hu.prototype.gb,hu.prototype.compare=hu.prototype.X,hu.prototype.toNumber=hu.prototype.ea,hu.prototype.toString=hu.prototype.toString,hu.prototype.getBits=hu.prototype.D,hu.fromNumber=pu,hu.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return Eu(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var i=pu(Math.pow(n,8)),r=mu,s=0;s<t.length;s+=8){var o=Math.min(8,t.length-s),a=parseInt(t.substring(s,s+o),n);8>o?(o=pu(Math.pow(n,o)),r=r.R(o).add(pu(a))):r=(r=r.R(i)).add(pu(a))}return r};var Au=Es.createWebChannelTransport=function(){return new ru},Nu=Es.getStatEventTarget=function(){return na()},Du=Es.ErrorCode=ua,Ru=Es.EventType=la,Ou=Es.Event=ea,Pu=Es.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},Lu=Es.FetchXmlHttpFactory=yc,Mu=Es.WebChannel=fa,xu=Es.XhrIo=_c,Fu=Es.Md5=uu,Uu=Es.Integer=hu;const Vu="@firebase/firestore";class Bu{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Bu.UNAUTHENTICATED=new Bu(null),Bu.GOOGLE_CREDENTIALS=new Bu("google-credentials-uid"),Bu.FIRST_PARTY=new Bu("first-party-uid"),Bu.MOCK_USER=new Bu("mock-user");let ju="9.23.0";const $u=new q("@firebase/firestore");function qu(){return $u.logLevel}function zu(e,...t){if($u.logLevel<=F.DEBUG){const n=t.map(Gu);$u.debug(`Firestore (${ju}): ${e}`,...n)}}function Hu(e,...t){if($u.logLevel<=F.ERROR){const n=t.map(Gu);$u.error(`Firestore (${ju}): ${e}`,...n)}}function Ku(e,...t){if($u.logLevel<=F.WARN){const n=t.map(Gu);$u.warn(`Firestore (${ju}): ${e}`,...n)}}function Gu(e){if("string"==typeof e)return e;try{return t=e,JSON.stringify(t)}catch(t){return e}var t}function Wu(e="Unexpected state"){const t=`FIRESTORE (${ju}) INTERNAL ASSERTION FAILED: `+e;throw Hu(t),new Error(t)}function Qu(e,t){e||Wu()}function Ju(e,t){return e}const Xu={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Yu extends m{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Zu{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class el{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class tl{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Bu.UNAUTHENTICATED)))}shutdown(){}}class nl{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class il{constructor(e){this.t=e,this.currentUser=Bu.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let n=this.i;const i=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let r=new Zu;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new Zu,e.enqueueRetryable((()=>i(this.currentUser)))};const s=()=>{const t=r;e.enqueueRetryable((async()=>{await t.promise,await i(this.currentUser)}))},o=e=>{zu("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.auth.addAuthTokenListener(this.o),s()};this.t.onInit((e=>o(e))),setTimeout((()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?o(e):(zu("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new Zu)}}),0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i!==e?(zu("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(Qu("string"==typeof t.accessToken),new el(t.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return Qu(null===e||"string"==typeof e),new Bu(e)}}class rl{constructor(e,t,n){this.h=e,this.l=t,this.m=n,this.type="FirstParty",this.user=Bu.FIRST_PARTY,this.g=new Map}p(){return this.m?this.m():null}get headers(){this.g.set("X-Goog-AuthUser",this.h);const e=this.p();return e&&this.g.set("Authorization",e),this.l&&this.g.set("X-Goog-Iam-Authorization-Token",this.l),this.g}}class sl{constructor(e,t,n){this.h=e,this.l=t,this.m=n}getToken(){return Promise.resolve(new rl(this.h,this.l,this.m))}start(e,t){e.enqueueRetryable((()=>t(Bu.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class ol{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class al{constructor(e){this.I=e,this.forceRefresh=!1,this.appCheck=null,this.T=null}start(e,t){const n=e=>{null!=e.error&&zu("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.T;return this.T=e.token,zu("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable((()=>n(t)))};const i=e=>{zu("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.appCheck.addTokenListener(this.o)};this.I.onInit((e=>i(e))),setTimeout((()=>{if(!this.appCheck){const e=this.I.getImmediate({optional:!0});e?i(e):zu("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((e=>e?(Qu("string"==typeof e.token),this.T=e.token,new ol(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function cl(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let t=0;t<e;t++)n[t]=Math.floor(256*Math.random());return n}class ul{static A(){const e=62*Math.floor(256/62);let t="";for(;t.length<20;){const n=cl(40);for(let i=0;i<n.length;++i)t.length<20&&n[i]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[i]%62))}return t}}function ll(e,t){return e<t?-1:e>t?1:0}function hl(e,t,n){return e.length===t.length&&e.every(((e,i)=>n(e,t[i])))}class dl{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Yu(Xu.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Yu(Xu.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Yu(Xu.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Yu(Xu.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return dl.fromMillis(Date.now())}static fromDate(e){return dl.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new dl(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ll(this.nanoseconds,e.nanoseconds):ll(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class fl{constructor(e){this.timestamp=e}static fromTimestamp(e){return new fl(e)}static min(){return new fl(new dl(0,0))}static max(){return new fl(new dl(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class pl{constructor(e,t,n){void 0===t?t=0:t>e.length&&Wu(),void 0===n?n=e.length-t:n>e.length-t&&Wu(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===pl.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof pl?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let i=0;i<n;i++){const n=e.get(i),r=t.get(i);if(n<r)return-1;if(n>r)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class gl extends pl{construct(e,t,n){return new gl(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new Yu(Xu.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter((e=>e.length>0)))}return new gl(t)}static emptyPath(){return new gl([])}}const ml=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class yl extends pl{construct(e,t,n){return new yl(e,t,n)}static isValidIdentifier(e){return ml.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),yl.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new yl(["__name__"])}static fromServerFormat(e){const t=[];let n="",i=0;const r=()=>{if(0===n.length)throw new Yu(Xu.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let s=!1;for(;i<e.length;){const t=e[i];if("\\"===t){if(i+1===e.length)throw new Yu(Xu.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[i+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new Yu(Xu.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,i+=2}else"`"===t?(s=!s,i++):"."!==t||s?(n+=t,i++):(r(),i++)}if(r(),s)throw new Yu(Xu.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new yl(t)}static emptyPath(){return new yl([])}}class vl{constructor(e){this.path=e}static fromPath(e){return new vl(gl.fromString(e))}static fromName(e){return new vl(gl.fromString(e).popFirst(5))}static empty(){return new vl(gl.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===gl.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return gl.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new vl(new gl(e.slice()))}}function wl(e){return new Il(e.readTime,e.key,-1)}class Il{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Il(fl.min(),vl.empty(),-1)}static max(){return new Il(fl.max(),vl.empty(),-1)}}function El(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=vl.comparator(e.documentKey,t.documentKey),0!==n?n:ll(e.largestBatchId,t.largestBatchId))}const bl="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Tl{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function _l(e){if(e.code!==Xu.FAILED_PRECONDITION||e.message!==bl)throw e;zu("LocalStore","Unexpectedly lost primary lease")}class Cl{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Wu(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Cl(((n,i)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,i)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,i)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Cl?t:Cl.resolve(t)}catch(e){return Cl.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Cl.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Cl.reject(t)}static resolve(e){return new Cl(((t,n)=>{t(e)}))}static reject(e){return new Cl(((t,n)=>{n(e)}))}static waitFor(e){return new Cl(((t,n)=>{let i=0,r=0,s=!1;e.forEach((e=>{++i,e.next((()=>{++r,s&&r===i&&t()}),(e=>n(e)))})),s=!0,r===i&&t()}))}static or(e){let t=Cl.resolve(!1);for(const n of e)t=t.next((e=>e?Cl.resolve(e):n()));return t}static forEach(e,t){const n=[];return e.forEach(((e,i)=>{n.push(t.call(this,e,i))})),this.waitFor(n)}static mapArray(e,t){return new Cl(((n,i)=>{const r=e.length,s=new Array(r);let o=0;for(let a=0;a<r;a++){const c=a;t(e[c]).next((e=>{s[c]=e,++o,o===r&&n(s)}),(e=>i(e)))}}))}static doWhile(e,t){return new Cl(((n,i)=>{const r=()=>{!0===e()?t().next((()=>{r()}),i):n()};r()}))}}function Sl(e){return"IndexedDbTransactionError"===e.name}class kl{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ot(e),this.ut=e=>t.writeSequenceNumber(e))}ot(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ut&&this.ut(e),e}}function Al(e){return null==e}function Nl(e){return 0===e&&1/e==-1/0}kl.ct=-1;function Dl(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Rl(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}class Ol{constructor(e,t){this.comparator=e,this.root=t||Ll.EMPTY}insert(e,t){return new Ol(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Ll.BLACK,null,null))}remove(e){return new Ol(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ll.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(0===i)return t+n.left.size;i<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Pl(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Pl(this.root,e,this.comparator,!1)}getReverseIterator(){return new Pl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Pl(this.root,e,this.comparator,!0)}}class Pl{constructor(e,t,n,i){this.isReverse=i,this.nodeStack=[];let r=1;for(;!e.isEmpty();)if(r=t?n(e.key,t):1,t&&i&&(r*=-1),r<0)e=this.isReverse?e.left:e.right;else{if(0===r){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ll{constructor(e,t,n,i,r){this.key=e,this.value=t,this.color=null!=n?n:Ll.RED,this.left=null!=i?i:Ll.EMPTY,this.right=null!=r?r:Ll.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,i,r){return new Ll(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this;const r=n(e,i.key);return i=r<0?i.copy(null,null,null,i.left.insert(e,t,n),null):0===r?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Ll.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===t(e,i.key)){if(i.right.isEmpty())return Ll.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ll.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ll.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Wu();if(this.right.isRed())throw Wu();const e=this.left.check();if(e!==this.right.check())throw Wu();return e+(this.isRed()?0:1)}}Ll.EMPTY=null,Ll.RED=!0,Ll.BLACK=!1,Ll.EMPTY=new class{constructor(){this.size=0}get key(){throw Wu()}get value(){throw Wu()}get color(){throw Wu()}get left(){throw Wu()}get right(){throw Wu()}copy(e,t,n,i,r){return this}insert(e,t,n){return new Ll(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Ml{constructor(e){this.comparator=e,this.data=new Ol(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new xl(this.data.getIterator())}getIteratorFrom(e){return new xl(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(e){if(!(e instanceof Ml))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,i=n.getNext().key;if(0!==this.comparator(e,i))return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Ml(this.comparator);return t.data=e,t}}class xl{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Fl{constructor(e){this.fields=e,e.sort(yl.comparator)}static empty(){return new Fl([])}unionWith(e){let t=new Ml(yl.comparator);for(const e of this.fields)t=t.add(e);for(const n of e)t=t.add(n);return new Fl(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return hl(this.fields,e.fields,((e,t)=>e.isEqual(t)))}}class Ul extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Vl{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new Ul("Invalid base64 string: "+e):e}}(e);return new Vl(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new Vl(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ll(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Vl.EMPTY_BYTE_STRING=new Vl("");const Bl=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function jl(e){if(Qu(!!e),"string"==typeof e){let t=0;const n=Bl.exec(e);if(Qu(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:$l(e.seconds),nanos:$l(e.nanos)}}function $l(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function ql(e){return"string"==typeof e?Vl.fromBase64String(e):Vl.fromUint8Array(e)}function zl(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Hl(e){const t=e.mapValue.fields.__previous_value__;return zl(t)?Hl(t):t}function Kl(e){const t=jl(e.mapValue.fields.__local_write_time__.timestampValue);return new dl(t.seconds,t.nanos)}class Gl{constructor(e,t,n,i,r,s,o,a,c){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=i,this.ssl=r,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=c}}class Wl{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Wl("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof Wl&&e.projectId===this.projectId&&e.database===this.database}}const Ql={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Jl(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?zl(e)?4:uh(e)?9007199254740991:10:Wu()}function Xl(e,t){if(e===t)return!0;const n=Jl(e);if(n!==Jl(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Kl(e).isEqual(Kl(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=jl(e.timestampValue),i=jl(t.timestampValue);return n.seconds===i.seconds&&n.nanos===i.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return ql(e.bytesValue).isEqual(ql(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return $l(e.geoPointValue.latitude)===$l(t.geoPointValue.latitude)&&$l(e.geoPointValue.longitude)===$l(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return $l(e.integerValue)===$l(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=$l(e.doubleValue),i=$l(t.doubleValue);return n===i?Nl(n)===Nl(i):isNaN(n)&&isNaN(i)}return!1}(e,t);case 9:return hl(e.arrayValue.values||[],t.arrayValue.values||[],Xl);case 10:return function(e,t){const n=e.mapValue.fields||{},i=t.mapValue.fields||{};if(Dl(n)!==Dl(i))return!1;for(const e in n)if(n.hasOwnProperty(e)&&(void 0===i[e]||!Xl(n[e],i[e])))return!1;return!0}(e,t);default:return Wu()}}function Yl(e,t){return void 0!==(e.values||[]).find((e=>Xl(e,t)))}function Zl(e,t){if(e===t)return 0;const n=Jl(e),i=Jl(t);if(n!==i)return ll(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return ll(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=$l(e.integerValue||e.doubleValue),i=$l(t.integerValue||t.doubleValue);return n<i?-1:n>i?1:n===i?0:isNaN(n)?isNaN(i)?0:-1:1}(e,t);case 3:return eh(e.timestampValue,t.timestampValue);case 4:return eh(Kl(e),Kl(t));case 5:return ll(e.stringValue,t.stringValue);case 6:return function(e,t){const n=ql(e),i=ql(t);return n.compareTo(i)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),i=t.split("/");for(let e=0;e<n.length&&e<i.length;e++){const t=ll(n[e],i[e]);if(0!==t)return t}return ll(n.length,i.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=ll($l(e.latitude),$l(t.latitude));return 0!==n?n:ll($l(e.longitude),$l(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){const n=e.values||[],i=t.values||[];for(let e=0;e<n.length&&e<i.length;++e){const t=Zl(n[e],i[e]);if(t)return t}return ll(n.length,i.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===Ql.mapValue&&t===Ql.mapValue)return 0;if(e===Ql.mapValue)return 1;if(t===Ql.mapValue)return-1;const n=e.fields||{},i=Object.keys(n),r=t.fields||{},s=Object.keys(r);i.sort(),s.sort();for(let e=0;e<i.length&&e<s.length;++e){const t=ll(i[e],s[e]);if(0!==t)return t;const o=Zl(n[i[e]],r[s[e]]);if(0!==o)return o}return ll(i.length,s.length)}(e.mapValue,t.mapValue);default:throw Wu()}}function eh(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return ll(e,t);const n=jl(e),i=jl(t),r=ll(n.seconds,i.seconds);return 0!==r?r:ll(n.nanos,i.nanos)}function th(e){return nh(e)}function nh(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=jl(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?ql(e.bytesValue).toBase64():"referenceValue"in e?(n=e.referenceValue,vl.fromName(n).toString()):"geoPointValue"in e?`geo(${(t=e.geoPointValue).latitude},${t.longitude})`:"arrayValue"in e?function(e){let t="[",n=!0;for(const i of e.values||[])n?n=!1:t+=",",t+=nh(i);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",i=!0;for(const r of t)i?i=!1:n+=",",n+=`${r}:${nh(e.fields[r])}`;return n+"}"}(e.mapValue):Wu();var t,n}function ih(e){return!!e&&"integerValue"in e}function rh(e){return!!e&&"arrayValue"in e}function sh(e){return!!e&&"nullValue"in e}function oh(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function ah(e){return!!e&&"mapValue"in e}function ch(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return Rl(e.mapValue.fields,((e,n)=>t.mapValue.fields[e]=ch(n))),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=ch(e.arrayValue.values[n]);return t}return Object.assign({},e)}function uh(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}class lh{constructor(e){this.value=e}static empty(){return new lh({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!ah(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ch(t)}setAll(e){let t=yl.emptyPath(),n={},i=[];e.forEach(((e,r)=>{if(!t.isImmediateParentOf(r)){const e=this.getFieldsMap(t);this.applyChanges(e,n,i),n={},i=[],t=r.popLast()}e?n[r.lastSegment()]=ch(e):i.push(r.lastSegment())}));const r=this.getFieldsMap(t);this.applyChanges(r,n,i)}delete(e){const t=this.field(e.popLast());ah(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Xl(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=t.mapValue.fields[e.get(n)];ah(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,n){Rl(t,((t,n)=>e[t]=n));for(const t of n)delete e[t]}clone(){return new lh(ch(this.value))}}class hh{constructor(e,t,n,i,r,s,o){this.key=e,this.documentType=t,this.version=n,this.readTime=i,this.createTime=r,this.data=s,this.documentState=o}static newInvalidDocument(e){return new hh(e,0,fl.min(),fl.min(),fl.min(),lh.empty(),0)}static newFoundDocument(e,t,n,i){return new hh(e,1,t,fl.min(),n,i,0)}static newNoDocument(e,t){return new hh(e,2,t,fl.min(),fl.min(),lh.empty(),0)}static newUnknownDocument(e,t){return new hh(e,3,t,fl.min(),fl.min(),lh.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(fl.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=lh.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=lh.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=fl.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof hh&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new hh(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class dh{constructor(e,t){this.position=e,this.inclusive=t}}function fh(e,t,n){let i=0;for(let r=0;r<e.position.length;r++){const s=t[r],o=e.position[r];if(i=s.field.isKeyField()?vl.comparator(vl.fromName(o.referenceValue),n.key):Zl(o,n.data.field(s.field)),"desc"===s.dir&&(i*=-1),0!==i)break}return i}function ph(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!Xl(e.position[n],t.position[n]))return!1;return!0}class gh{constructor(e,t="asc"){this.field=e,this.dir=t}}function mh(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class yh{}class vh extends yh{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new Ch(e,t,n):"array-contains"===t?new Nh(e,n):"in"===t?new Dh(e,n):"not-in"===t?new Rh(e,n):"array-contains-any"===t?new Oh(e,n):new vh(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new Sh(e,n):new kh(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(Zl(t,this.value)):null!==t&&Jl(this.value)===Jl(t)&&this.matchesComparison(Zl(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Wu()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class wh extends yh{constructor(e,t){super(),this.filters=e,this.op=t,this.lt=null}static create(e,t){return new wh(e,t)}matches(e){return Ih(this)?void 0===this.filters.find((t=>!t.matches(e))):void 0!==this.filters.find((t=>t.matches(e)))}getFlattenedFilters(){return null!==this.lt||(this.lt=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.lt}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.ft((e=>e.isInequality()));return null!==e?e.field:null}ft(e){for(const t of this.getFlattenedFilters())if(e(t))return t;return null}}function Ih(e){return"and"===e.op}function Eh(e){return function(e){for(const t of e.filters)if(t instanceof wh)return!1;return!0}(e)&&Ih(e)}function bh(e){if(e instanceof vh)return e.field.canonicalString()+e.op.toString()+th(e.value);if(Eh(e))return e.filters.map((e=>bh(e))).join(",");{const t=e.filters.map((e=>bh(e))).join(",");return`${e.op}(${t})`}}function Th(e,t){return e instanceof vh?function(e,t){return t instanceof vh&&e.op===t.op&&e.field.isEqual(t.field)&&Xl(e.value,t.value)}(e,t):e instanceof wh?function(e,t){return t instanceof wh&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce(((e,n,i)=>e&&Th(n,t.filters[i])),!0)}(e,t):void Wu()}function _h(e){return e instanceof vh?function(e){return`${e.field.canonicalString()} ${e.op} ${th(e.value)}`}(e):e instanceof wh?function(e){return e.op.toString()+" {"+e.getFilters().map(_h).join(" ,")+"}"}(e):"Filter"}class Ch extends vh{constructor(e,t,n){super(e,t,n),this.key=vl.fromName(n.referenceValue)}matches(e){const t=vl.comparator(e.key,this.key);return this.matchesComparison(t)}}class Sh extends vh{constructor(e,t){super(e,"in",t),this.keys=Ah(0,t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class kh extends vh{constructor(e,t){super(e,"not-in",t),this.keys=Ah(0,t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function Ah(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((e=>vl.fromName(e.referenceValue)))}class Nh extends vh{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return rh(t)&&Yl(t.arrayValue,this.value)}}class Dh extends vh{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Yl(this.value.arrayValue,t)}}class Rh extends vh{constructor(e,t){super(e,"not-in",t)}matches(e){if(Yl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!Yl(this.value.arrayValue,t)}}class Oh extends vh{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!rh(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>Yl(this.value.arrayValue,e)))}}class Ph{constructor(e,t=null,n=[],i=[],r=null,s=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=i,this.limit=r,this.startAt=s,this.endAt=o,this.dt=null}}function Lh(e,t=null,n=[],i=[],r=null,s=null,o=null){return new Ph(e,t,n,i,r,s,o)}function Mh(e){const t=Ju(e);if(null===t.dt){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((e=>bh(e))).join(","),e+="|ob:",e+=t.orderBy.map((e=>function(e){return e.field.canonicalString()+e.dir}(e))).join(","),Al(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((e=>th(e))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((e=>th(e))).join(",")),t.dt=e}return t.dt}function xh(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!mh(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!Th(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!ph(e.startAt,t.startAt)&&ph(e.endAt,t.endAt)}function Fh(e){return vl.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class Uh{constructor(e,t=null,n=[],i=[],r=null,s="F",o=null,a=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=i,this.limit=r,this.limitType=s,this.startAt=o,this.endAt=a,this.wt=null,this._t=null,this.startAt,this.endAt}}function Vh(e){return new Uh(e)}function Bh(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function jh(e){const t=Ju(e);if(null===t.wt){t.wt=[];const e=function(e){for(const t of e.filters){const e=t.getFirstInequalityField();if(null!==e)return e}return null}(t),n=function(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}(t);if(null!==e&&null===n)e.isKeyField()||t.wt.push(new gh(e)),t.wt.push(new gh(yl.keyField(),"asc"));else{let e=!1;for(const n of t.explicitOrderBy)t.wt.push(n),n.field.isKeyField()&&(e=!0);if(!e){const e=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.wt.push(new gh(yl.keyField(),e))}}}return t.wt}function $h(e){const t=Ju(e);if(!t._t)if("F"===t.limitType)t._t=Lh(t.path,t.collectionGroup,jh(t),t.filters,t.limit,t.startAt,t.endAt);else{const e=[];for(const n of jh(t)){const t="desc"===n.dir?"asc":"desc";e.push(new gh(n.field,t))}const n=t.endAt?new dh(t.endAt.position,t.endAt.inclusive):null,i=t.startAt?new dh(t.startAt.position,t.startAt.inclusive):null;t._t=Lh(t.path,t.collectionGroup,e,t.filters,t.limit,n,i)}return t._t}function qh(e,t,n){return new Uh(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function zh(e,t){return xh($h(e),$h(t))&&e.limitType===t.limitType}function Hh(e){return`${Mh($h(e))}|lt:${e.limitType}`}function Kh(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map((e=>_h(e))).join(", ")}]`),Al(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map((e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e))).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((e=>th(e))).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((e=>th(e))).join(",")),`Target(${t})`}($h(e))}; limitType=${e.limitType})`}function Gh(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):vl.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of jh(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const i=fh(e,t,n);return e.inclusive?i<=0:i<0}(e.startAt,jh(e),t)||e.endAt&&!function(e,t,n){const i=fh(e,t,n);return e.inclusive?i>=0:i>0}(e.endAt,jh(e),t))}(e,t)}function Wh(e){return(t,n)=>{let i=!1;for(const r of jh(e)){const e=Qh(r,t,n);if(0!==e)return e;i=i||r.field.isKeyField()}return 0}}function Qh(e,t,n){const i=e.field.isKeyField()?vl.comparator(t.key,n.key):function(e,t,n){const i=t.data.field(e),r=n.data.field(e);return null!==i&&null!==r?Zl(i,r):Wu()}(e.field,t,n);switch(e.dir){case"asc":return i;case"desc":return-1*i;default:return Wu()}}class Jh{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[t,i]of n)if(this.equalsFn(t,e))return i}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),i=this.inner[n];if(void 0===i)return this.inner[n]=[[e,t]],void this.innerSize++;for(let n=0;n<i.length;n++)if(this.equalsFn(i[n][0],e))return void(i[n]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return 1===n.length?delete this.inner[t]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Rl(this.inner,((t,n)=>{for(const[t,i]of n)e(t,i)}))}isEmpty(){return function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(this.inner)}size(){return this.innerSize}}const Xh=new Ol(vl.comparator);function Yh(){return Xh}const Zh=new Ol(vl.comparator);function ed(...e){let t=Zh;for(const n of e)t=t.insert(n.key,n);return t}function td(e){let t=Zh;return e.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function nd(){return rd()}function id(){return rd()}function rd(){return new Jh((e=>e.toString()),((e,t)=>e.isEqual(t)))}new Ol(vl.comparator);const sd=new Ml(vl.comparator);function od(...e){let t=sd;for(const n of e)t=t.add(n);return t}const ad=new Ml(ll);class cd{constructor(){this._=void 0}}function ud(e,t,n){return e instanceof hd?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&zl(t)&&(t=Hl(t)),t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof dd?fd(e,t):e instanceof pd?gd(e,t):function(e,t){const n=function(e,t){return e instanceof md?ih(n=t)||function(e){return!!e&&"doubleValue"in e}(n)?t:{integerValue:0}:null;var n}(e,t),i=yd(n)+yd(e.gt);return ih(n)&&ih(e.gt)?function(e){return{integerValue:""+e}}(i):function(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Nl(t)?"-0":t}}(e.serializer,i)}(e,t)}function ld(e,t,n){return e instanceof dd?fd(e,t):e instanceof pd?gd(e,t):n}class hd extends cd{}class dd extends cd{constructor(e){super(),this.elements=e}}function fd(e,t){const n=vd(t);for(const t of e.elements)n.some((e=>Xl(e,t)))||n.push(t);return{arrayValue:{values:n}}}class pd extends cd{constructor(e){super(),this.elements=e}}function gd(e,t){let n=vd(t);for(const t of e.elements)n=n.filter((e=>!Xl(e,t)));return{arrayValue:{values:n}}}class md extends cd{constructor(e,t){super(),this.serializer=e,this.gt=t}}function yd(e){return $l(e.integerValue||e.doubleValue)}function vd(e){return rh(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class wd{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new wd}static exists(e){return new wd(void 0,e)}static updateTime(e){return new wd(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Id(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class Ed{}function bd(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Rd(e.key,wd.none()):new Sd(e.key,e.data,wd.none());{const n=e.data,i=lh.empty();let r=new Ml(yl.comparator);for(let e of t.fields)if(!r.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?i.delete(e):i.set(e,t),r=r.add(e)}return new kd(e.key,i,new Fl(r.toArray()),wd.none())}}function Td(e,t,n){e instanceof Sd?function(e,t,n){const i=e.value.clone(),r=Nd(e.fieldTransforms,t,n.transformResults);i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):e instanceof kd?function(e,t,n){if(!Id(e.precondition,t))return void t.convertToUnknownDocument(n.version);const i=Nd(e.fieldTransforms,t,n.transformResults),r=t.data;r.setAll(Ad(e)),r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function _d(e,t,n,i){return e instanceof Sd?function(e,t,n,i){if(!Id(e.precondition,t))return n;const r=e.value.clone(),s=Dd(e.fieldTransforms,i,t);return r.setAll(s),t.convertToFoundDocument(t.version,r).setHasLocalMutations(),null}(e,t,n,i):e instanceof kd?function(e,t,n,i){if(!Id(e.precondition,t))return n;const r=Dd(e.fieldTransforms,i,t),s=t.data;return s.setAll(Ad(e)),s.setAll(r),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((e=>e.field)))}(e,t,n,i):function(e,t,n){return Id(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function Cd(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&hl(e,t,((e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof dd&&t instanceof dd||e instanceof pd&&t instanceof pd?hl(e.elements,t.elements,Xl):e instanceof md&&t instanceof md?Xl(e.gt,t.gt):e instanceof hd&&t instanceof hd}(e.transform,t.transform)}(e,t)))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Sd extends Ed{constructor(e,t,n,i=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class kd extends Ed{constructor(e,t,n,i,r=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=i,this.fieldTransforms=r,this.type=1}getFieldMask(){return this.fieldMask}}function Ad(e){const t=new Map;return e.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const i=e.data.field(n);t.set(n,i)}})),t}function Nd(e,t,n){const i=new Map;Qu(e.length===n.length);for(let r=0;r<n.length;r++){const s=e[r],o=s.transform,a=t.data.field(s.field);i.set(s.field,ld(o,a,n[r]))}return i}function Dd(e,t,n){const i=new Map;for(const r of e){const e=r.transform,s=n.data.field(r.field);i.set(r.field,ud(e,s,t))}return i}class Rd extends Ed{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Od{constructor(e,t,n,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let t=0;t<this.mutations.length;t++){const i=this.mutations[t];i.key.isEqual(e.key)&&Td(i,e,n[t])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=_d(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=_d(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=id();return this.mutations.forEach((i=>{const r=e.get(i.key),s=r.overlayedDocument;let o=this.applyToLocalView(s,r.mutatedFields);o=t.has(i.key)?null:o;const a=bd(s,o);null!==a&&n.set(i.key,a),s.isValidDocument()||s.convertToNoDocument(fl.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),od())}isEqual(e){return this.batchId===e.batchId&&hl(this.mutations,e.mutations,((e,t)=>Cd(e,t)))&&hl(this.baseMutations,e.baseMutations,((e,t)=>Cd(e,t)))}}class Pd{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class Ld{constructor(e,t){this.count=e,this.unchangedNames=t}}var Md,xd;function Fd(e){if(void 0===e)return Hu("GRPC error has no .code"),Xu.UNKNOWN;switch(e){case Md.OK:return Xu.OK;case Md.CANCELLED:return Xu.CANCELLED;case Md.UNKNOWN:return Xu.UNKNOWN;case Md.DEADLINE_EXCEEDED:return Xu.DEADLINE_EXCEEDED;case Md.RESOURCE_EXHAUSTED:return Xu.RESOURCE_EXHAUSTED;case Md.INTERNAL:return Xu.INTERNAL;case Md.UNAVAILABLE:return Xu.UNAVAILABLE;case Md.UNAUTHENTICATED:return Xu.UNAUTHENTICATED;case Md.INVALID_ARGUMENT:return Xu.INVALID_ARGUMENT;case Md.NOT_FOUND:return Xu.NOT_FOUND;case Md.ALREADY_EXISTS:return Xu.ALREADY_EXISTS;case Md.PERMISSION_DENIED:return Xu.PERMISSION_DENIED;case Md.FAILED_PRECONDITION:return Xu.FAILED_PRECONDITION;case Md.ABORTED:return Xu.ABORTED;case Md.OUT_OF_RANGE:return Xu.OUT_OF_RANGE;case Md.UNIMPLEMENTED:return Xu.UNIMPLEMENTED;case Md.DATA_LOSS:return Xu.DATA_LOSS;default:return Wu()}}(xd=Md||(Md={}))[xd.OK=0]="OK",xd[xd.CANCELLED=1]="CANCELLED",xd[xd.UNKNOWN=2]="UNKNOWN",xd[xd.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",xd[xd.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",xd[xd.NOT_FOUND=5]="NOT_FOUND",xd[xd.ALREADY_EXISTS=6]="ALREADY_EXISTS",xd[xd.PERMISSION_DENIED=7]="PERMISSION_DENIED",xd[xd.UNAUTHENTICATED=16]="UNAUTHENTICATED",xd[xd.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",xd[xd.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",xd[xd.ABORTED=10]="ABORTED",xd[xd.OUT_OF_RANGE=11]="OUT_OF_RANGE",xd[xd.UNIMPLEMENTED=12]="UNIMPLEMENTED",xd[xd.INTERNAL=13]="INTERNAL",xd[xd.UNAVAILABLE=14]="UNAVAILABLE",xd[xd.DATA_LOSS=15]="DATA_LOSS";class Ud{constructor(){this.onExistenceFilterMismatchCallbacks=new Map}static get instance(){return Vd}static getOrCreateInstance(){return null===Vd&&(Vd=new Ud),Vd}onExistenceFilterMismatch(e){const t=Symbol();return this.onExistenceFilterMismatchCallbacks.set(t,e),()=>this.onExistenceFilterMismatchCallbacks.delete(t)}notifyOnExistenceFilterMismatch(e){this.onExistenceFilterMismatchCallbacks.forEach((t=>t(e)))}}let Vd=null;const Bd=new Uu([4294967295,4294967295],0);function jd(e){const t=(new TextEncoder).encode(e),n=new Fu;return n.update(t),new Uint8Array(n.digest())}function $d(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),i=t.getUint32(4,!0),r=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new Uu([n,i],0),new Uu([r,s],0)]}class qd{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new zd(`Invalid padding: ${t}`);if(n<0)throw new zd(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new zd(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new zd(`Invalid padding when bitmap length is 0: ${t}`);this.It=8*e.length-t,this.Tt=Uu.fromNumber(this.It)}Et(e,t,n){let i=e.add(t.multiply(Uu.fromNumber(n)));return 1===i.compare(Bd)&&(i=new Uu([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Tt).toNumber()}At(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}vt(e){if(0===this.It)return!1;const t=jd(e),[n,i]=$d(t);for(let e=0;e<this.hashCount;e++){const t=this.Et(n,i,e);if(!this.At(t))return!1}return!0}static create(e,t,n){const i=e%8==0?0:8-e%8,r=new Uint8Array(Math.ceil(e/8)),s=new qd(r,i,t);return n.forEach((e=>s.insert(e))),s}insert(e){if(0===this.It)return;const t=jd(e),[n,i]=$d(t);for(let e=0;e<this.hashCount;e++){const t=this.Et(n,i,e);this.Rt(t)}}Rt(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class zd extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Hd{constructor(e,t,n,i,r){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=r}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const i=new Map;return i.set(e,Kd.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new Hd(fl.min(),i,new Ol(ll),Yh(),od())}}class Kd{constructor(e,t,n,i,r){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=r}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new Kd(n,t,od(),od(),od())}}class Gd{constructor(e,t,n,i){this.Pt=e,this.removedTargetIds=t,this.key=n,this.bt=i}}class Wd{constructor(e,t){this.targetId=e,this.Vt=t}}class Qd{constructor(e,t,n=Vl.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=i}}class Jd{constructor(){this.St=0,this.Dt=Zd(),this.Ct=Vl.EMPTY_BYTE_STRING,this.xt=!1,this.Nt=!0}get current(){return this.xt}get resumeToken(){return this.Ct}get kt(){return 0!==this.St}get Mt(){return this.Nt}$t(e){e.approximateByteSize()>0&&(this.Nt=!0,this.Ct=e)}Ot(){let e=od(),t=od(),n=od();return this.Dt.forEach(((i,r)=>{switch(r){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:n=n.add(i);break;default:Wu()}})),new Kd(this.Ct,this.xt,e,t,n)}Ft(){this.Nt=!1,this.Dt=Zd()}Bt(e,t){this.Nt=!0,this.Dt=this.Dt.insert(e,t)}Lt(e){this.Nt=!0,this.Dt=this.Dt.remove(e)}qt(){this.St+=1}Ut(){this.St-=1}Kt(){this.Nt=!0,this.xt=!0}}class Xd{constructor(e){this.Gt=e,this.Qt=new Map,this.jt=Yh(),this.zt=Yd(),this.Wt=new Ol(ll)}Ht(e){for(const t of e.Pt)e.bt&&e.bt.isFoundDocument()?this.Jt(t,e.bt):this.Yt(t,e.key,e.bt);for(const t of e.removedTargetIds)this.Yt(t,e.key,e.bt)}Xt(e){this.forEachTarget(e,(t=>{const n=this.Zt(t);switch(e.state){case 0:this.te(t)&&n.$t(e.resumeToken);break;case 1:n.Ut(),n.kt||n.Ft(),n.$t(e.resumeToken);break;case 2:n.Ut(),n.kt||this.removeTarget(t);break;case 3:this.te(t)&&(n.Kt(),n.$t(e.resumeToken));break;case 4:this.te(t)&&(this.ee(t),n.$t(e.resumeToken));break;default:Wu()}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Qt.forEach(((e,n)=>{this.te(n)&&t(n)}))}ne(e){var t;const n=e.targetId,i=e.Vt.count,r=this.se(n);if(r){const s=r.target;if(Fh(s))if(0===i){const e=new vl(s.path);this.Yt(n,e,hh.newNoDocument(e,fl.min()))}else Qu(1===i);else{const r=this.ie(n);if(r!==i){const i=this.re(e,r);if(0!==i){this.ee(n);const e=2===i?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Wt=this.Wt.insert(n,e)}null===(t=Ud.instance)||void 0===t||t.notifyOnExistenceFilterMismatch(function(e,t,n){var i,r,s,o,a,c;const u={localCacheCount:t,existenceFilterCount:n.count},l=n.unchangedNames;return l&&(u.bloomFilter={applied:0===e,hashCount:null!==(i=null==l?void 0:l.hashCount)&&void 0!==i?i:0,bitmapLength:null!==(o=null===(s=null===(r=null==l?void 0:l.bits)||void 0===r?void 0:r.bitmap)||void 0===s?void 0:s.length)&&void 0!==o?o:0,padding:null!==(c=null===(a=null==l?void 0:l.bits)||void 0===a?void 0:a.padding)&&void 0!==c?c:0}),u}(i,r,e.Vt))}}}}re(e,t){const{unchangedNames:n,count:i}=e.Vt;if(!n||!n.bits)return 1;const{bits:{bitmap:r="",padding:s=0},hashCount:o=0}=n;let a,c;try{a=ql(r).toUint8Array()}catch(e){if(e instanceof Ul)return Ku("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),1;throw e}try{c=new qd(a,s,o)}catch(e){return Ku(e instanceof zd?"BloomFilter error: ":"Applying bloom filter failed: ",e),1}return 0===c.It?1:i!==t-this.oe(e.targetId,c)?2:0}oe(e,t){const n=this.Gt.getRemoteKeysForTarget(e);let i=0;return n.forEach((n=>{const r=this.Gt.ue(),s=`projects/${r.projectId}/databases/${r.database}/documents/${n.path.canonicalString()}`;t.vt(s)||(this.Yt(e,n,null),i++)})),i}ce(e){const t=new Map;this.Qt.forEach(((n,i)=>{const r=this.se(i);if(r){if(n.current&&Fh(r.target)){const t=new vl(r.target.path);null!==this.jt.get(t)||this.ae(i,t)||this.Yt(i,t,hh.newNoDocument(t,e))}n.Mt&&(t.set(i,n.Ot()),n.Ft())}}));let n=od();this.zt.forEach(((e,t)=>{let i=!0;t.forEachWhile((e=>{const t=this.se(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(i=!1,!1)})),i&&(n=n.add(e))})),this.jt.forEach(((t,n)=>n.setReadTime(e)));const i=new Hd(e,t,this.Wt,this.jt,n);return this.jt=Yh(),this.zt=Yd(),this.Wt=new Ol(ll),i}Jt(e,t){if(!this.te(e))return;const n=this.ae(e,t.key)?2:0;this.Zt(e).Bt(t.key,n),this.jt=this.jt.insert(t.key,t),this.zt=this.zt.insert(t.key,this.he(t.key).add(e))}Yt(e,t,n){if(!this.te(e))return;const i=this.Zt(e);this.ae(e,t)?i.Bt(t,1):i.Lt(t),this.zt=this.zt.insert(t,this.he(t).delete(e)),n&&(this.jt=this.jt.insert(t,n))}removeTarget(e){this.Qt.delete(e)}ie(e){const t=this.Zt(e).Ot();return this.Gt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}qt(e){this.Zt(e).qt()}Zt(e){let t=this.Qt.get(e);return t||(t=new Jd,this.Qt.set(e,t)),t}he(e){let t=this.zt.get(e);return t||(t=new Ml(ll),this.zt=this.zt.insert(e,t)),t}te(e){const t=null!==this.se(e);return t||zu("WatchChangeAggregator","Detected inactive target",e),t}se(e){const t=this.Qt.get(e);return t&&t.kt?null:this.Gt.le(e)}ee(e){this.Qt.set(e,new Jd),this.Gt.getRemoteKeysForTarget(e).forEach((t=>{this.Yt(e,t,null)}))}ae(e,t){return this.Gt.getRemoteKeysForTarget(e).has(t)}}function Yd(){return new Ol(vl.comparator)}function Zd(){return new Ol(vl.comparator)}const ef={asc:"ASCENDING",desc:"DESCENDING"},tf={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},nf={and:"AND",or:"OR"};class rf{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function sf(e,t){return e.useProto3Json||Al(t)?t:{value:t}}function of(e){return Qu(!!e),fl.fromTimestamp(function(e){const t=jl(e);return new dl(t.seconds,t.nanos)}(e))}function af(e){const t=gl.fromString(e);return Qu(bf(t)),t}function cf(e,t){const n=af(t);if(n.get(1)!==e.databaseId.projectId)throw new Yu(Xu.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Yu(Xu.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new vl(hf(n))}function uf(e,t){return function(e,t){return function(e){return new gl(["projects",e.projectId,"databases",e.database])}(e).child("documents").child(t).canonicalString()}(e.databaseId,t)}function lf(e){return new gl(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function hf(e){return Qu(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function df(e,t){return{documents:[uf(e,t.path)]}}function ff(e,t){const n={structuredQuery:{}},i=t.path;null!==t.collectionGroup?(n.parent=uf(e,i),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=uf(e,i.popLast()),n.structuredQuery.from=[{collectionId:i.lastSegment()}]);const r=function(e){if(0!==e.length)return Ef(wh.create(e,"and"))}(t.filters);r&&(n.structuredQuery.where=r);const s=function(e){if(0!==e.length)return e.map((e=>function(e){return{field:wf(e.field),direction:mf(e.dir)}}(e)))}(t.orderBy);s&&(n.structuredQuery.orderBy=s);const o=sf(e,t.limit);var a;return null!==o&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt={before:(a=t.startAt).inclusive,values:a.position}),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),n}function pf(e){let t=function(e){const t=af(e);return 4===t.length?gl.emptyPath():hf(t)}(e.parent);const n=e.structuredQuery,i=n.from?n.from.length:0;let r=null;if(i>0){Qu(1===i);const e=n.from[0];e.allDescendants?r=e.collectionId:t=t.child(e.collectionId)}let s=[];n.where&&(s=function(e){const t=gf(e);return t instanceof wh&&Eh(t)?t.getFilters():[t]}(n.where));let o=[];n.orderBy&&(o=n.orderBy.map((e=>function(e){return new gh(If(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e))));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,Al(t)?null:t}(n.limit));let c=null;n.startAt&&(c=function(e){const t=!!e.before,n=e.values||[];return new dh(n,t)}(n.startAt));let u=null;return n.endAt&&(u=function(e){const t=!e.before,n=e.values||[];return new dh(n,t)}(n.endAt)),function(e,t,n,i,r,s,o,a){return new Uh(e,t,n,i,r,s,o,a)}(t,r,o,s,a,"F",c,u)}function gf(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=If(e.unaryFilter.field);return vh.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=If(e.unaryFilter.field);return vh.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=If(e.unaryFilter.field);return vh.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const r=If(e.unaryFilter.field);return vh.create(r,"!=",{nullValue:"NULL_VALUE"});default:return Wu()}}(e):void 0!==e.fieldFilter?function(e){return vh.create(If(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Wu()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return wh.create(e.compositeFilter.filters.map((e=>gf(e))),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return Wu()}}(e.compositeFilter.op))}(e):Wu()}function mf(e){return ef[e]}function yf(e){return tf[e]}function vf(e){return nf[e]}function wf(e){return{fieldPath:e.canonicalString()}}function If(e){return yl.fromServerFormat(e.fieldPath)}function Ef(e){return e instanceof vh?function(e){if("=="===e.op){if(oh(e.value))return{unaryFilter:{field:wf(e.field),op:"IS_NAN"}};if(sh(e.value))return{unaryFilter:{field:wf(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(oh(e.value))return{unaryFilter:{field:wf(e.field),op:"IS_NOT_NAN"}};if(sh(e.value))return{unaryFilter:{field:wf(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:wf(e.field),op:yf(e.op),value:e.value}}}(e):e instanceof wh?function(e){const t=e.getFilters().map((e=>Ef(e)));return 1===t.length?t[0]:{compositeFilter:{op:vf(e.op),filters:t}}}(e):Wu()}function bf(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class Tf{constructor(e,t,n,i,r=fl.min(),s=fl.min(),o=Vl.EMPTY_BYTE_STRING,a=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=r,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o,this.expectedCount=a}withSequenceNumber(e){return new Tf(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Tf(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Tf(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Tf(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class _f{constructor(e){this.fe=e}}function Cf(e){const t=pf({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?qh(t,t.limit,"L"):t}class Sf{constructor(){}_e(e,t){this.me(e,t),t.ge()}me(e,t){if("nullValue"in e)this.ye(t,5);else if("booleanValue"in e)this.ye(t,10),t.pe(e.booleanValue?1:0);else if("integerValue"in e)this.ye(t,15),t.pe($l(e.integerValue));else if("doubleValue"in e){const n=$l(e.doubleValue);isNaN(n)?this.ye(t,13):(this.ye(t,15),Nl(n)?t.pe(0):t.pe(n))}else if("timestampValue"in e){const n=e.timestampValue;this.ye(t,20),"string"==typeof n?t.Ie(n):(t.Ie(`${n.seconds||""}`),t.pe(n.nanos||0))}else if("stringValue"in e)this.Te(e.stringValue,t),this.Ee(t);else if("bytesValue"in e)this.ye(t,30),t.Ae(ql(e.bytesValue)),this.Ee(t);else if("referenceValue"in e)this.ve(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.ye(t,45),t.pe(n.latitude||0),t.pe(n.longitude||0)}else"mapValue"in e?uh(e)?this.ye(t,Number.MAX_SAFE_INTEGER):(this.Re(e.mapValue,t),this.Ee(t)):"arrayValue"in e?(this.Pe(e.arrayValue,t),this.Ee(t)):Wu()}Te(e,t){this.ye(t,25),this.be(e,t)}be(e,t){t.Ie(e)}Re(e,t){const n=e.fields||{};this.ye(t,55);for(const e of Object.keys(n))this.Te(e,t),this.me(n[e],t)}Pe(e,t){const n=e.values||[];this.ye(t,50);for(const e of n)this.me(e,t)}ve(e,t){this.ye(t,37),vl.fromName(e).path.forEach((e=>{this.ye(t,60),this.be(e,t)}))}ye(e,t){e.pe(t)}Ee(e){e.pe(2)}}Sf.Ve=new Sf;class kf{constructor(){this.rn=new Af}addToCollectionParentIndex(e,t){return this.rn.add(t),Cl.resolve()}getCollectionParents(e,t){return Cl.resolve(this.rn.getEntries(t))}addFieldIndex(e,t){return Cl.resolve()}deleteFieldIndex(e,t){return Cl.resolve()}getDocumentsMatchingTarget(e,t){return Cl.resolve(null)}getIndexType(e,t){return Cl.resolve(0)}getFieldIndexes(e,t){return Cl.resolve([])}getNextCollectionGroupToUpdate(e){return Cl.resolve(null)}getMinOffset(e,t){return Cl.resolve(Il.min())}getMinOffsetFromCollectionGroup(e,t){return Cl.resolve(Il.min())}updateCollectionGroup(e,t,n){return Cl.resolve()}updateIndexEntries(e,t){return Cl.resolve()}}class Af{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t]||new Ml(gl.comparator),r=!i.has(n);return this.index[t]=i.add(n),r}has(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t];return i&&i.has(n)}getEntries(e){return(this.index[e]||new Ml(gl.comparator)).toArray()}}new Uint8Array(0);class Nf{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new Nf(e,Nf.DEFAULT_COLLECTION_PERCENTILE,Nf.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}Nf.DEFAULT_COLLECTION_PERCENTILE=10,Nf.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Nf.DEFAULT=new Nf(41943040,Nf.DEFAULT_COLLECTION_PERCENTILE,Nf.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Nf.DISABLED=new Nf(-1,0,0);class Df{constructor(e){this.Nn=e}next(){return this.Nn+=2,this.Nn}static kn(){return new Df(0)}static Mn(){return new Df(-1)}}class Rf{constructor(){this.changes=new Jh((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,hh.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?Cl.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Of{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class Pf{constructor(e,t,n,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((i=>(n=i,this.remoteDocumentCache.getEntry(e,t)))).next((e=>(null!==n&&_d(n.mutation,e,Fl.empty(),dl.now()),e)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.getLocalViewOfDocuments(e,t,od()).next((()=>t))))}getLocalViewOfDocuments(e,t,n=od()){const i=nd();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,n).next((e=>{let t=ed();return e.forEach(((e,n)=>{t=t.insert(e,n.overlayedDocument)})),t}))))}getOverlayedDocuments(e,t){const n=nd();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,od())))}populateOverlays(e,t,n){const i=[];return n.forEach((e=>{t.has(e)||i.push(e)})),this.documentOverlayCache.getOverlays(e,i).next((e=>{e.forEach(((e,n)=>{t.set(e,n)}))}))}computeViews(e,t,n,i){let r=Yh();const s=rd(),o=rd();return t.forEach(((e,t)=>{const o=n.get(t.key);i.has(t.key)&&(void 0===o||o.mutation instanceof kd)?r=r.insert(t.key,t):void 0!==o?(s.set(t.key,o.mutation.getFieldMask()),_d(o.mutation,t,o.mutation.getFieldMask(),dl.now())):s.set(t.key,Fl.empty())})),this.recalculateAndSaveOverlays(e,r).next((e=>(e.forEach(((e,t)=>s.set(e,t))),t.forEach(((e,t)=>{var n;return o.set(e,new Of(t,null!==(n=s.get(e))&&void 0!==n?n:null))})),o)))}recalculateAndSaveOverlays(e,t){const n=rd();let i=new Ol(((e,t)=>e-t)),r=od();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>{for(const r of e)r.keys().forEach((e=>{const s=t.get(e);if(null===s)return;let o=n.get(e)||Fl.empty();o=r.applyToLocalView(s,o),n.set(e,o);const a=(i.get(r.batchId)||od()).add(e);i=i.insert(r.batchId,a)}))})).next((()=>{const s=[],o=i.getReverseIterator();for(;o.hasNext();){const i=o.getNext(),a=i.key,c=i.value,u=id();c.forEach((e=>{if(!r.has(e)){const i=bd(t.get(e),n.get(e));null!==i&&u.set(e,i),r=r.add(e)}})),s.push(this.documentOverlayCache.saveOverlays(e,a,u))}return Cl.waitFor(s)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.recalculateAndSaveOverlays(e,t)))}getDocumentsMatchingQuery(e,t,n){return function(e){return vl.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):function(e){return null!==e.collectionGroup}(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n)}getNextDocuments(e,t,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,i).next((r=>{const s=i-r.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,i-r.size):Cl.resolve(nd());let o=-1,a=r;return s.next((t=>Cl.forEach(t,((t,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),r.get(t)?Cl.resolve():this.remoteDocumentCache.getEntry(e,t).next((e=>{a=a.insert(t,e)}))))).next((()=>this.populateOverlays(e,t,r))).next((()=>this.computeViews(e,a,t,od()))).next((e=>({batchId:o,changes:td(e)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new vl(t)).next((e=>{let t=ed();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}getDocumentsMatchingCollectionGroupQuery(e,t,n){const i=t.collectionGroup;let r=ed();return this.indexManager.getCollectionParents(e,i).next((s=>Cl.forEach(s,(s=>{const o=function(e,t){return new Uh(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,s.child(i));return this.getDocumentsMatchingCollectionQuery(e,o,n).next((e=>{e.forEach(((e,t)=>{r=r.insert(e,t)}))}))})).next((()=>r))))}getDocumentsMatchingCollectionQuery(e,t,n){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((r=>(i=r,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i)))).next((e=>{i.forEach(((t,n)=>{const i=n.getKey();null===e.get(i)&&(e=e.insert(i,hh.newInvalidDocument(i)))}));let n=ed();return e.forEach(((e,r)=>{const s=i.get(e);void 0!==s&&_d(s.mutation,r,Fl.empty(),dl.now()),Gh(t,r)&&(n=n.insert(e,r))})),n}))}}class Lf{constructor(e){this.serializer=e,this.cs=new Map,this.hs=new Map}getBundleMetadata(e,t){return Cl.resolve(this.cs.get(t))}saveBundleMetadata(e,t){var n;return this.cs.set(t.id,{id:(n=t).id,version:n.version,createTime:of(n.createTime)}),Cl.resolve()}getNamedQuery(e,t){return Cl.resolve(this.hs.get(t))}saveNamedQuery(e,t){return this.hs.set(t.name,function(e){return{name:e.name,query:Cf(e.bundledQuery),readTime:of(e.readTime)}}(t)),Cl.resolve()}}class Mf{constructor(){this.overlays=new Ol(vl.comparator),this.ls=new Map}getOverlay(e,t){return Cl.resolve(this.overlays.get(t))}getOverlays(e,t){const n=nd();return Cl.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((n,i)=>{this.we(e,t,i)})),Cl.resolve()}removeOverlaysForBatchId(e,t,n){const i=this.ls.get(n);return void 0!==i&&(i.forEach((e=>this.overlays=this.overlays.remove(e))),this.ls.delete(n)),Cl.resolve()}getOverlaysForCollection(e,t,n){const i=nd(),r=t.length+1,s=new vl(t.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const e=o.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===r&&e.largestBatchId>n&&i.set(e.getKey(),e)}return Cl.resolve(i)}getOverlaysForCollectionGroup(e,t,n,i){let r=new Ol(((e,t)=>e-t));const s=this.overlays.getIterator();for(;s.hasNext();){const e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=r.get(e.largestBatchId);null===t&&(t=nd(),r=r.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const o=nd(),a=r.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((e,t)=>o.set(e,t))),!(o.size()>=i)););return Cl.resolve(o)}we(e,t,n){const i=this.overlays.get(n.key);if(null!==i){const e=this.ls.get(i.largestBatchId).delete(n.key);this.ls.set(i.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new Pd(t,n));let r=this.ls.get(t);void 0===r&&(r=od(),this.ls.set(t,r)),this.ls.set(t,r.add(n.key))}}class xf{constructor(){this.fs=new Ml(Ff.ds),this.ws=new Ml(Ff._s)}isEmpty(){return this.fs.isEmpty()}addReference(e,t){const n=new Ff(e,t);this.fs=this.fs.add(n),this.ws=this.ws.add(n)}gs(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.ys(new Ff(e,t))}ps(e,t){e.forEach((e=>this.removeReference(e,t)))}Is(e){const t=new vl(new gl([])),n=new Ff(t,e),i=new Ff(t,e+1),r=[];return this.ws.forEachInRange([n,i],(e=>{this.ys(e),r.push(e.key)})),r}Ts(){this.fs.forEach((e=>this.ys(e)))}ys(e){this.fs=this.fs.delete(e),this.ws=this.ws.delete(e)}Es(e){const t=new vl(new gl([])),n=new Ff(t,e),i=new Ff(t,e+1);let r=od();return this.ws.forEachInRange([n,i],(e=>{r=r.add(e.key)})),r}containsKey(e){const t=new Ff(e,0),n=this.fs.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class Ff{constructor(e,t){this.key=e,this.As=t}static ds(e,t){return vl.comparator(e.key,t.key)||ll(e.As,t.As)}static _s(e,t){return ll(e.As,t.As)||vl.comparator(e.key,t.key)}}class Uf{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.vs=1,this.Rs=new Ml(Ff.ds)}checkEmpty(e){return Cl.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,i){const r=this.vs;this.vs++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new Od(r,t,n,i);this.mutationQueue.push(s);for(const t of i)this.Rs=this.Rs.add(new Ff(t.key,r)),this.indexManager.addToCollectionParentIndex(e,t.key.path.popLast());return Cl.resolve(s)}lookupMutationBatch(e,t){return Cl.resolve(this.Ps(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,i=this.bs(n),r=i<0?0:i;return Cl.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return Cl.resolve(0===this.mutationQueue.length?-1:this.vs-1)}getAllMutationBatches(e){return Cl.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Ff(t,0),i=new Ff(t,Number.POSITIVE_INFINITY),r=[];return this.Rs.forEachInRange([n,i],(e=>{const t=this.Ps(e.As);r.push(t)})),Cl.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Ml(ll);return t.forEach((e=>{const t=new Ff(e,0),i=new Ff(e,Number.POSITIVE_INFINITY);this.Rs.forEachInRange([t,i],(e=>{n=n.add(e.As)}))})),Cl.resolve(this.Vs(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1;let r=n;vl.isDocumentKey(r)||(r=r.child(""));const s=new Ff(new vl(r),0);let o=new Ml(ll);return this.Rs.forEachWhile((e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===i&&(o=o.add(e.As)),!0)}),s),Cl.resolve(this.Vs(o))}Vs(e){const t=[];return e.forEach((e=>{const n=this.Ps(e);null!==n&&t.push(n)})),t}removeMutationBatch(e,t){Qu(0===this.Ss(t.batchId,"removed")),this.mutationQueue.shift();let n=this.Rs;return Cl.forEach(t.mutations,(i=>{const r=new Ff(i.key,t.batchId);return n=n.delete(r),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.Rs=n}))}Cn(e){}containsKey(e,t){const n=new Ff(t,0),i=this.Rs.firstAfterOrEqual(n);return Cl.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,Cl.resolve()}Ss(e,t){return this.bs(e)}bs(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Ps(e){const t=this.bs(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Vf{constructor(e){this.Ds=e,this.docs=new Ol(vl.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,i=this.docs.get(n),r=i?i.size:0,s=this.Ds(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:s}),this.size+=s-r,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return Cl.resolve(n?n.document.mutableCopy():hh.newInvalidDocument(t))}getEntries(e,t){let n=Yh();return t.forEach((e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():hh.newInvalidDocument(e))})),Cl.resolve(n)}getDocumentsMatchingQuery(e,t,n,i){let r=Yh();const s=t.path,o=new vl(s.child("")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:e,value:{document:o}}=a.getNext();if(!s.isPrefixOf(e.path))break;e.path.length>s.length+1||El(wl(o),n)<=0||(i.has(o.key)||Gh(t,o))&&(r=r.insert(o.key,o.mutableCopy()))}return Cl.resolve(r)}getAllFromCollectionGroup(e,t,n,i){Wu()}Cs(e,t){return Cl.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new Bf(this)}getSize(e){return Cl.resolve(this.size)}}class Bf extends Rf{constructor(e){super(),this.os=e}applyChanges(e){const t=[];return this.changes.forEach(((n,i)=>{i.isValidDocument()?t.push(this.os.addEntry(e,i)):this.os.removeEntry(n)})),Cl.waitFor(t)}getFromCache(e,t){return this.os.getEntry(e,t)}getAllFromCache(e,t){return this.os.getEntries(e,t)}}class jf{constructor(e){this.persistence=e,this.xs=new Jh((e=>Mh(e)),xh),this.lastRemoteSnapshotVersion=fl.min(),this.highestTargetId=0,this.Ns=0,this.ks=new xf,this.targetCount=0,this.Ms=Df.kn()}forEachTarget(e,t){return this.xs.forEach(((e,n)=>t(n))),Cl.resolve()}getLastRemoteSnapshotVersion(e){return Cl.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Cl.resolve(this.Ns)}allocateTargetId(e){return this.highestTargetId=this.Ms.next(),Cl.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Ns&&(this.Ns=t),Cl.resolve()}Fn(e){this.xs.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Ms=new Df(t),this.highestTargetId=t),e.sequenceNumber>this.Ns&&(this.Ns=e.sequenceNumber)}addTargetData(e,t){return this.Fn(t),this.targetCount+=1,Cl.resolve()}updateTargetData(e,t){return this.Fn(t),Cl.resolve()}removeTargetData(e,t){return this.xs.delete(t.target),this.ks.Is(t.targetId),this.targetCount-=1,Cl.resolve()}removeTargets(e,t,n){let i=0;const r=[];return this.xs.forEach(((s,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.xs.delete(s),r.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)})),Cl.waitFor(r).next((()=>i))}getTargetCount(e){return Cl.resolve(this.targetCount)}getTargetData(e,t){const n=this.xs.get(t)||null;return Cl.resolve(n)}addMatchingKeys(e,t,n){return this.ks.gs(t,n),Cl.resolve()}removeMatchingKeys(e,t,n){this.ks.ps(t,n);const i=this.persistence.referenceDelegate,r=[];return i&&t.forEach((t=>{r.push(i.markPotentiallyOrphaned(e,t))})),Cl.waitFor(r)}removeMatchingKeysForTargetId(e,t){return this.ks.Is(t),Cl.resolve()}getMatchingKeysForTargetId(e,t){const n=this.ks.Es(t);return Cl.resolve(n)}containsKey(e,t){return Cl.resolve(this.ks.containsKey(t))}}class $f{constructor(e,t){this.$s={},this.overlays={},this.Os=new kl(0),this.Fs=!1,this.Fs=!0,this.referenceDelegate=e(this),this.Bs=new jf(this),this.indexManager=new kf,this.remoteDocumentCache=function(e){return new Vf(e)}((e=>this.referenceDelegate.Ls(e))),this.serializer=new _f(t),this.qs=new Lf(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Fs=!1,Promise.resolve()}get started(){return this.Fs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Mf,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.$s[e.toKey()];return n||(n=new Uf(t,this.referenceDelegate),this.$s[e.toKey()]=n),n}getTargetCache(){return this.Bs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.qs}runTransaction(e,t,n){zu("MemoryPersistence","Starting transaction:",e);const i=new qf(this.Os.next());return this.referenceDelegate.Us(),n(i).next((e=>this.referenceDelegate.Ks(i).next((()=>e)))).toPromise().then((e=>(i.raiseOnCommittedEvent(),e)))}Gs(e,t){return Cl.or(Object.values(this.$s).map((n=>()=>n.containsKey(e,t))))}}class qf extends Tl{constructor(e){super(),this.currentSequenceNumber=e}}class zf{constructor(e){this.persistence=e,this.Qs=new xf,this.js=null}static zs(e){return new zf(e)}get Ws(){if(this.js)return this.js;throw Wu()}addReference(e,t,n){return this.Qs.addReference(n,t),this.Ws.delete(n.toString()),Cl.resolve()}removeReference(e,t,n){return this.Qs.removeReference(n,t),this.Ws.add(n.toString()),Cl.resolve()}markPotentiallyOrphaned(e,t){return this.Ws.add(t.toString()),Cl.resolve()}removeTarget(e,t){this.Qs.Is(t.targetId).forEach((e=>this.Ws.add(e.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.Ws.add(e.toString())))})).next((()=>n.removeTargetData(e,t)))}Us(){this.js=new Set}Ks(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Cl.forEach(this.Ws,(n=>{const i=vl.fromPath(n);return this.Hs(e,i).next((e=>{e||t.removeEntry(i,fl.min())}))})).next((()=>(this.js=null,t.apply(e))))}updateLimboDocument(e,t){return this.Hs(e,t).next((e=>{e?this.Ws.delete(t.toString()):this.Ws.add(t.toString())}))}Ls(e){return 0}Hs(e,t){return Cl.or([()=>Cl.resolve(this.Qs.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gs(e,t)])}}class Hf{constructor(e,t,n,i){this.targetId=e,this.fromCache=t,this.Fi=n,this.Bi=i}static Li(e,t){let n=od(),i=od();for(const e of t.docChanges)switch(e.type){case 0:n=n.add(e.doc.key);break;case 1:i=i.add(e.doc.key)}return new Hf(e,t.fromCache,n,i)}}class Kf{constructor(){this.qi=!1}initialize(e,t){this.Ui=e,this.indexManager=t,this.qi=!0}getDocumentsMatchingQuery(e,t,n,i){return this.Ki(e,t).next((r=>r||this.Gi(e,t,i,n))).next((n=>n||this.Qi(e,t)))}Ki(e,t){if(Bh(t))return Cl.resolve(null);let n=$h(t);return this.indexManager.getIndexType(e,n).next((i=>0===i?null:(null!==t.limit&&1===i&&(t=qh(t,null,"F"),n=$h(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((i=>{const r=od(...i);return this.Ui.getDocuments(e,r).next((i=>this.indexManager.getMinOffset(e,n).next((n=>{const s=this.ji(t,i);return this.zi(t,s,r,n.readTime)?this.Ki(e,qh(t,null,"F")):this.Wi(e,s,t,n)}))))})))))}Gi(e,t,n,i){return Bh(t)||i.isEqual(fl.min())?this.Qi(e,t):this.Ui.getDocuments(e,n).next((r=>{const s=this.ji(t,r);return this.zi(t,s,n,i)?this.Qi(e,t):(qu()<=F.DEBUG&&zu("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Kh(t)),this.Wi(e,s,t,function(e,t){const n=e.toTimestamp().seconds,i=e.toTimestamp().nanoseconds+1,r=fl.fromTimestamp(1e9===i?new dl(n+1,0):new dl(n,i));return new Il(r,vl.empty(),t)}(i,-1)))}))}ji(e,t){let n=new Ml(Wh(e));return t.forEach(((t,i)=>{Gh(e,i)&&(n=n.add(i))})),n}zi(e,t,n,i){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const r="F"===e.limitType?t.last():t.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(i)>0)}Qi(e,t){return qu()<=F.DEBUG&&zu("QueryEngine","Using full collection scan to execute query:",Kh(t)),this.Ui.getDocumentsMatchingQuery(e,t,Il.min())}Wi(e,t,n,i){return this.Ui.getDocumentsMatchingQuery(e,n,i).next((e=>(t.forEach((t=>{e=e.insert(t.key,t)})),e)))}}class Gf{constructor(e,t,n,i){this.persistence=e,this.Hi=t,this.serializer=i,this.Ji=new Ol(ll),this.Yi=new Jh((e=>Mh(e)),xh),this.Xi=new Map,this.Zi=e.getRemoteDocumentCache(),this.Bs=e.getTargetCache(),this.qs=e.getBundleCache(),this.tr(n)}tr(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Pf(this.Zi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Zi.setIndexManager(this.indexManager),this.Hi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ji)))}}async function Wf(e,t){const n=Ju(e);return await n.persistence.runTransaction("Handle user change","readonly",(e=>{let i;return n.mutationQueue.getAllMutationBatches(e).next((r=>(i=r,n.tr(t),n.mutationQueue.getAllMutationBatches(e)))).next((t=>{const r=[],s=[];let o=od();for(const e of i){r.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){s.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return n.localDocuments.getDocuments(e,o).next((e=>({er:e,removedBatchIds:r,addedBatchIds:s})))}))}))}function Qf(e){const t=Ju(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Bs.getLastRemoteSnapshotVersion(e)))}async function Jf(e,t,n){const i=Ju(e),r=i.Ji.get(t),s=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",s,(e=>i.persistence.referenceDelegate.removeTarget(e,r)))}catch(e){if(!Sl(e))throw e;zu("LocalStore",`Failed to update sequence numbers for target ${t}: ${e}`)}i.Ji=i.Ji.remove(t),i.Yi.delete(r.target)}function Xf(e,t,n){const i=Ju(e);let r=fl.min(),s=od();return i.persistence.runTransaction("Execute query","readonly",(e=>function(e,t,n){const i=Ju(e),r=i.Yi.get(n);return void 0!==r?Cl.resolve(i.Ji.get(r)):i.Bs.getTargetData(t,n)}(i,e,$h(t)).next((t=>{if(t)return r=t.lastLimboFreeSnapshotVersion,i.Bs.getMatchingKeysForTargetId(e,t.targetId).next((e=>{s=e}))})).next((()=>i.Hi.getDocumentsMatchingQuery(e,t,n?r:fl.min(),n?s:od()))).next((e=>(function(e,t,n){let i=e.Xi.get(t)||fl.min();n.forEach(((e,t)=>{t.readTime.compareTo(i)>0&&(i=t.readTime)})),e.Xi.set(t,i)}(i,function(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}(t),e),{documents:e,ir:s})))))}class Yf{constructor(){this.activeTargetIds=ad}lr(e){this.activeTargetIds=this.activeTargetIds.add(e)}dr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}hr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Zf{constructor(){this.Hr=new Yf,this.Jr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.Hr.lr(e),this.Jr[e]||"not-current"}updateQueryState(e,t,n){this.Jr[e]=t}removeLocalQueryTarget(e){this.Hr.dr(e)}isLocalQueryTarget(e){return this.Hr.activeTargetIds.has(e)}clearQueryState(e){delete this.Jr[e]}getAllActiveQueryTargets(){return this.Hr.activeTargetIds}isActiveQueryTarget(e){return this.Hr.activeTargetIds.has(e)}start(){return this.Hr=new Yf,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class ep{Yr(e){}shutdown(){}}class tp{constructor(){this.Xr=()=>this.Zr(),this.eo=()=>this.no(),this.so=[],this.io()}Yr(e){this.so.push(e)}shutdown(){window.removeEventListener("online",this.Xr),window.removeEventListener("offline",this.eo)}io(){window.addEventListener("online",this.Xr),window.addEventListener("offline",this.eo)}Zr(){zu("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.so)e(0)}no(){zu("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.so)e(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let np=null;function ip(){return null===np?np=268435456+Math.round(2147483648*Math.random()):np++,"0x"+np.toString(16)}const rp={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class sp{constructor(e){this.ro=e.ro,this.oo=e.oo}uo(e){this.co=e}ao(e){this.ho=e}onMessage(e){this.lo=e}close(){this.oo()}send(e){this.ro(e)}fo(){this.co()}wo(e){this.ho(e)}_o(e){this.lo(e)}}const op="WebChannelConnection";class ap extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http";this.mo=t+"://"+e.host,this.yo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get po(){return!1}Io(e,t,n,i,r){const s=ip(),o=this.To(e,t);zu("RestConnection",`Sending RPC '${e}' ${s}:`,o,n);const a={};return this.Eo(a,i,r),this.Ao(e,o,a,n).then((t=>(zu("RestConnection",`Received RPC '${e}' ${s}: `,t),t)),(t=>{throw Ku("RestConnection",`RPC '${e}' ${s} failed with error: `,t,"url: ",o,"request:",n),t}))}vo(e,t,n,i,r,s){return this.Io(e,t,n,i,r)}Eo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+ju,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((t,n)=>e[n]=t)),n&&n.headers.forEach(((t,n)=>e[n]=t))}To(e,t){const n=rp[e];return`${this.mo}/v1/${t}:${n}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Ao(e,t,n,i){const r=ip();return new Promise(((s,o)=>{const a=new xu;a.setWithCredentials(!0),a.listenOnce(Ru.COMPLETE,(()=>{try{switch(a.getLastErrorCode()){case Du.NO_ERROR:const t=a.getResponseJson();zu(op,`XHR for RPC '${e}' ${r} received:`,JSON.stringify(t)),s(t);break;case Du.TIMEOUT:zu(op,`RPC '${e}' ${r} timed out`),o(new Yu(Xu.DEADLINE_EXCEEDED,"Request time out"));break;case Du.HTTP_ERROR:const n=a.getStatus();if(zu(op,`RPC '${e}' ${r} failed with status:`,n,"response text:",a.getResponseText()),n>0){let e=a.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(Xu).indexOf(t)>=0?t:Xu.UNKNOWN}(t.status);o(new Yu(e,t.message))}else o(new Yu(Xu.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new Yu(Xu.UNAVAILABLE,"Connection failed."));break;default:Wu()}}finally{zu(op,`RPC '${e}' ${r} completed.`)}}));const c=JSON.stringify(i);zu(op,`RPC '${e}' ${r} sending request:`,i),a.send(t,"POST",c,n,15)}))}Ro(e,t,n){const i=ip(),r=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=Au(),o=Nu(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;void 0!==c&&(a.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(a.xmlHttpFactory=new Lu({})),this.Eo(a.initMessageHeaders,t,n),a.encodeInitMessageHeaders=!0;const u=r.join("");zu(op,`Creating RPC '${e}' stream ${i}: ${u}`,a);const l=s.createWebChannel(u,a);let h=!1,d=!1;const f=new sp({ro:t=>{d?zu(op,`Not sending because RPC '${e}' stream ${i} is closed:`,t):(h||(zu(op,`Opening RPC '${e}' stream ${i} transport.`),l.open(),h=!0),zu(op,`RPC '${e}' stream ${i} sending:`,t),l.send(t))},oo:()=>l.close()}),p=(e,t,n)=>{e.listen(t,(e=>{try{n(e)}catch(e){setTimeout((()=>{throw e}),0)}}))};return p(l,Mu.EventType.OPEN,(()=>{d||zu(op,`RPC '${e}' stream ${i} transport opened.`)})),p(l,Mu.EventType.CLOSE,(()=>{d||(d=!0,zu(op,`RPC '${e}' stream ${i} transport closed`),f.wo())})),p(l,Mu.EventType.ERROR,(t=>{d||(d=!0,Ku(op,`RPC '${e}' stream ${i} transport errored:`,t),f.wo(new Yu(Xu.UNAVAILABLE,"The operation could not be completed")))})),p(l,Mu.EventType.MESSAGE,(t=>{var n;if(!d){const r=t.data[0];Qu(!!r);const s=r,o=s.error||(null===(n=s[0])||void 0===n?void 0:n.error);if(o){zu(op,`RPC '${e}' stream ${i} received error:`,o);const t=o.status;let n=function(e){const t=Md[e];if(void 0!==t)return Fd(t)}(t),r=o.message;void 0===n&&(n=Xu.INTERNAL,r="Unknown error status: "+t+" with message "+o.message),d=!0,f.wo(new Yu(n,r)),l.close()}else zu(op,`RPC '${e}' stream ${i} received:`,r),f._o(r)}})),p(o,Ou.STAT_EVENT,(t=>{t.stat===Pu.PROXY?zu(op,`RPC '${e}' stream ${i} detected buffering proxy`):t.stat===Pu.NOPROXY&&zu(op,`RPC '${e}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{f.fo()}),0),f}}function cp(){return"undefined"!=typeof document?document:null}function up(e){return new rf(e,!0)}class lp{constructor(e,t,n=1e3,i=1.5,r=6e4){this.ii=e,this.timerId=t,this.Po=n,this.bo=i,this.Vo=r,this.So=0,this.Do=null,this.Co=Date.now(),this.reset()}reset(){this.So=0}xo(){this.So=this.Vo}No(e){this.cancel();const t=Math.floor(this.So+this.ko()),n=Math.max(0,Date.now()-this.Co),i=Math.max(0,t-n);i>0&&zu("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.So} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.Do=this.ii.enqueueAfterDelay(this.timerId,i,(()=>(this.Co=Date.now(),e()))),this.So*=this.bo,this.So<this.Po&&(this.So=this.Po),this.So>this.Vo&&(this.So=this.Vo)}Mo(){null!==this.Do&&(this.Do.skipDelay(),this.Do=null)}cancel(){null!==this.Do&&(this.Do.cancel(),this.Do=null)}ko(){return(Math.random()-.5)*this.So}}class hp{constructor(e,t,n,i,r,s,o,a){this.ii=e,this.$o=n,this.Oo=i,this.connection=r,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.Fo=0,this.Bo=null,this.Lo=null,this.stream=null,this.qo=new lp(e,t)}Uo(){return 1===this.state||5===this.state||this.Ko()}Ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Go()}async stop(){this.Uo()&&await this.close(0)}Qo(){this.state=0,this.qo.reset()}jo(){this.Ko()&&null===this.Bo&&(this.Bo=this.ii.enqueueAfterDelay(this.$o,6e4,(()=>this.zo())))}Wo(e){this.Ho(),this.stream.send(e)}async zo(){if(this.Ko())return this.close(0)}Ho(){this.Bo&&(this.Bo.cancel(),this.Bo=null)}Jo(){this.Lo&&(this.Lo.cancel(),this.Lo=null)}async close(e,t){this.Ho(),this.Jo(),this.qo.cancel(),this.Fo++,4!==e?this.qo.reset():t&&t.code===Xu.RESOURCE_EXHAUSTED?(Hu(t.toString()),Hu("Using maximum backoff delay to prevent overloading the backend."),this.qo.xo()):t&&t.code===Xu.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.Yo(),this.stream.close(),this.stream=null),this.state=e,await this.listener.ao(t)}Yo(){}auth(){this.state=1;const e=this.Xo(this.Fo),t=this.Fo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([e,n])=>{this.Fo===t&&this.Zo(e,n)}),(t=>{e((()=>{const e=new Yu(Xu.UNKNOWN,"Fetching auth token failed: "+t.message);return this.tu(e)}))}))}Zo(e,t){const n=this.Xo(this.Fo);this.stream=this.eu(e,t),this.stream.uo((()=>{n((()=>(this.state=2,this.Lo=this.ii.enqueueAfterDelay(this.Oo,1e4,(()=>(this.Ko()&&(this.state=3),Promise.resolve()))),this.listener.uo())))})),this.stream.ao((e=>{n((()=>this.tu(e)))})),this.stream.onMessage((e=>{n((()=>this.onMessage(e)))}))}Go(){this.state=5,this.qo.No((async()=>{this.state=0,this.start()}))}tu(e){return zu("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Xo(e){return t=>{this.ii.enqueueAndForget((()=>this.Fo===e?t():(zu("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class dp extends hp{constructor(e,t,n,i,r,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,i,s),this.serializer=r}eu(e,t){return this.connection.Ro("Listen",e,t)}onMessage(e){this.qo.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const i=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:Wu()}(t.targetChange.targetChangeType||"NO_CHANGE"),r=t.targetChange.targetIds||[],s=function(e,t){return e.useProto3Json?(Qu(void 0===t||"string"==typeof t),Vl.fromBase64String(t||"")):(Qu(void 0===t||t instanceof Uint8Array),Vl.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(e){const t=void 0===e.code?Xu.UNKNOWN:Fd(e.code);return new Yu(t,e.message||"")}(o);n=new Qd(i,r,s,a||null)}else if("documentChange"in t){t.documentChange;const i=t.documentChange;i.document,i.document.name,i.document.updateTime;const r=cf(e,i.document.name),s=of(i.document.updateTime),o=i.document.createTime?of(i.document.createTime):fl.min(),a=new lh({mapValue:{fields:i.document.fields}}),c=hh.newFoundDocument(r,s,o,a),u=i.targetIds||[],l=i.removedTargetIds||[];n=new Gd(u,l,c.key,c)}else if("documentDelete"in t){t.documentDelete;const i=t.documentDelete;i.document;const r=cf(e,i.document),s=i.readTime?of(i.readTime):fl.min(),o=hh.newNoDocument(r,s),a=i.removedTargetIds||[];n=new Gd([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const i=t.documentRemove;i.document;const r=cf(e,i.document),s=i.removedTargetIds||[];n=new Gd([],s,r,null)}else{if(!("filter"in t))return Wu();{t.filter;const e=t.filter;e.targetId;const{count:i=0,unchangedNames:r}=e,s=new Ld(i,r),o=e.targetId;n=new Wd(o,s)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return fl.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?fl.min():t.readTime?of(t.readTime):fl.min()}(e);return this.listener.nu(t,n)}su(e){const t={};t.database=lf(this.serializer),t.addTarget=function(e,t){let n;const i=t.target;if(n=Fh(i)?{documents:df(e,i)}:{query:ff(e,i)},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=function(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}(e,t.resumeToken);const i=sf(e,t.expectedCount);null!==i&&(n.expectedCount=i)}else if(t.snapshotVersion.compareTo(fl.min())>0){n.readTime=function(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}(e,t.snapshotVersion.toTimestamp());const i=sf(e,t.expectedCount);null!==i&&(n.expectedCount=i)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Wu()}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.Wo(t)}iu(e){const t={};t.database=lf(this.serializer),t.removeTarget=e,this.Wo(t)}}class fp extends class{}{constructor(e,t,n,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=i,this.lu=!1}fu(){if(this.lu)throw new Yu(Xu.FAILED_PRECONDITION,"The client has already been terminated.")}Io(e,t,n){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,r])=>this.connection.Io(e,t,n,i,r))).catch((e=>{throw"FirebaseError"===e.name?(e.code===Xu.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Yu(Xu.UNKNOWN,e.toString())}))}vo(e,t,n,i){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([r,s])=>this.connection.vo(e,t,n,r,s,i))).catch((e=>{throw"FirebaseError"===e.name?(e.code===Xu.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Yu(Xu.UNKNOWN,e.toString())}))}terminate(){this.lu=!0}}class pp{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.wu=0,this._u=null,this.mu=!0}gu(){0===this.wu&&(this.yu("Unknown"),this._u=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._u=null,this.pu("Backend didn't respond within 10 seconds."),this.yu("Offline"),Promise.resolve()))))}Iu(e){"Online"===this.state?this.yu("Unknown"):(this.wu++,this.wu>=1&&(this.Tu(),this.pu(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.yu("Offline")))}set(e){this.Tu(),this.wu=0,"Online"===e&&(this.mu=!1),this.yu(e)}yu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}pu(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.mu?(Hu(t),this.mu=!1):zu("OnlineStateTracker",t)}Tu(){null!==this._u&&(this._u.cancel(),this._u=null)}}class gp{constructor(e,t,n,i,r){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Eu=[],this.Au=new Map,this.vu=new Set,this.Ru=[],this.Pu=r,this.Pu.Yr((e=>{n.enqueueAndForget((async()=>{_p(this)&&(zu("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=Ju(e);t.vu.add(4),await yp(t),t.bu.set("Unknown"),t.vu.delete(4),await mp(t)}(this))}))})),this.bu=new pp(n,i)}}async function mp(e){if(_p(e))for(const t of e.Ru)await t(!0)}async function yp(e){for(const t of e.Ru)await t(!1)}function vp(e,t){const n=Ju(e);n.Au.has(t.targetId)||(n.Au.set(t.targetId,t),Tp(n)?bp(n):Rp(n).Ko()&&Ip(n,t))}function wp(e,t){const n=Ju(e),i=Rp(n);n.Au.delete(t),i.Ko()&&Ep(n,t),0===n.Au.size&&(i.Ko()?i.jo():_p(n)&&n.bu.set("Unknown"))}function Ip(e,t){if(e.Vu.qt(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(fl.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}Rp(e).su(t)}function Ep(e,t){e.Vu.qt(t),Rp(e).iu(t)}function bp(e){e.Vu=new Xd({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),le:t=>e.Au.get(t)||null,ue:()=>e.datastore.serializer.databaseId}),Rp(e).start(),e.bu.gu()}function Tp(e){return _p(e)&&!Rp(e).Uo()&&e.Au.size>0}function _p(e){return 0===Ju(e).vu.size}function Cp(e){e.Vu=void 0}async function Sp(e){e.Au.forEach(((t,n)=>{Ip(e,t)}))}async function kp(e,t){Cp(e),Tp(e)?(e.bu.Iu(t),bp(e)):e.bu.set("Unknown")}async function Ap(e,t,n){if(e.bu.set("Online"),t instanceof Qd&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const i of t.targetIds)e.Au.has(i)&&(await e.remoteSyncer.rejectListen(i,n),e.Au.delete(i),e.Vu.removeTarget(i))}(e,t)}catch(n){zu("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await Np(e,n)}else if(t instanceof Gd?e.Vu.Ht(t):t instanceof Wd?e.Vu.ne(t):e.Vu.Xt(t),!n.isEqual(fl.min()))try{const t=await Qf(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.Vu.ce(t);return n.targetChanges.forEach(((n,i)=>{if(n.resumeToken.approximateByteSize()>0){const r=e.Au.get(i);r&&e.Au.set(i,r.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach(((t,n)=>{const i=e.Au.get(t);if(!i)return;e.Au.set(t,i.withResumeToken(Vl.EMPTY_BYTE_STRING,i.snapshotVersion)),Ep(e,t);const r=new Tf(i.target,t,n,i.sequenceNumber);Ip(e,r)})),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){zu("RemoteStore","Failed to raise snapshot:",t),await Np(e,t)}}async function Np(e,t,n){if(!Sl(t))throw t;e.vu.add(1),await yp(e),e.bu.set("Offline"),n||(n=()=>Qf(e.localStore)),e.asyncQueue.enqueueRetryable((async()=>{zu("RemoteStore","Retrying IndexedDB access"),await n(),e.vu.delete(1),await mp(e)}))}async function Dp(e,t){const n=Ju(e);n.asyncQueue.verifyOperationInProgress(),zu("RemoteStore","RemoteStore received new credentials");const i=_p(n);n.vu.add(3),await yp(n),i&&n.bu.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.vu.delete(3),await mp(n)}function Rp(e){return e.Su||(e.Su=function(e,t,n){const i=Ju(e);return i.fu(),new dp(t,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(e.datastore,e.asyncQueue,{uo:Sp.bind(null,e),ao:kp.bind(null,e),nu:Ap.bind(null,e)}),e.Ru.push((async t=>{t?(e.Su.Qo(),Tp(e)?bp(e):e.bu.set("Unknown")):(await e.Su.stop(),Cp(e))}))),e.Su}class Op{constructor(e,t,n,i,r){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=i,this.removalCallback=r,this.deferred=new Zu,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}static createAndSchedule(e,t,n,i,r){const s=Date.now()+n,o=new Op(e,t,s,i,r);return o.start(n),o}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Yu(Xu.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Pp(e,t){if(Hu("AsyncQueue",`${t}: ${e}`),Sl(e))return new Yu(Xu.UNAVAILABLE,`${t}: ${e}`);throw e}class Lp{constructor(e){this.comparator=e?(t,n)=>e(t,n)||vl.comparator(t.key,n.key):(e,t)=>vl.comparator(e.key,t.key),this.keyedMap=ed(),this.sortedSet=new Ol(this.comparator)}static emptySet(e){return new Lp(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Lp))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,i=n.getNext().key;if(!e.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new Lp;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class Mp{constructor(){this.Cu=new Ol(vl.comparator)}track(e){const t=e.doc.key,n=this.Cu.get(t);n?0!==e.type&&3===n.type?this.Cu=this.Cu.insert(t,e):3===e.type&&1!==n.type?this.Cu=this.Cu.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.Cu=this.Cu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.Cu=this.Cu.remove(t):1===e.type&&2===n.type?this.Cu=this.Cu.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):Wu():this.Cu=this.Cu.insert(t,e)}xu(){const e=[];return this.Cu.inorderTraversal(((t,n)=>{e.push(n)})),e}}class xp{constructor(e,t,n,i,r,s,o,a,c){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=r,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=c}static fromInitialDocuments(e,t,n,i,r){const s=[];return t.forEach((e=>{s.push({type:0,doc:e})})),new xp(e,t,Lp.emptySet(t),s,n,i,!0,!1,r)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&zh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let e=0;e<t.length;e++)if(t[e].type!==n[e].type||!t[e].doc.isEqual(n[e].doc))return!1;return!0}}class Fp{constructor(){this.Nu=void 0,this.listeners=[]}}class Up{constructor(){this.queries=new Jh((e=>Hh(e)),zh),this.onlineState="Unknown",this.ku=new Set}}function Vp(e,t){const n=Ju(e);let i=!1;for(const e of t){const t=e.query,r=n.queries.get(t);if(r){for(const t of r.listeners)t.$u(e)&&(i=!0);r.Nu=e}}i&&jp(n)}function Bp(e,t,n){const i=Ju(e),r=i.queries.get(t);if(r)for(const e of r.listeners)e.onError(n);i.queries.delete(t)}function jp(e){e.ku.forEach((e=>{e.next()}))}class $p{constructor(e,t,n){this.query=e,this.Ou=t,this.Fu=!1,this.Bu=null,this.onlineState="Unknown",this.options=n||{}}$u(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new xp(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Fu?this.Lu(e)&&(this.Ou.next(e),t=!0):this.qu(e,this.onlineState)&&(this.Uu(e),t=!0),this.Bu=e,t}onError(e){this.Ou.error(e)}Mu(e){this.onlineState=e;let t=!1;return this.Bu&&!this.Fu&&this.qu(this.Bu,e)&&(this.Uu(this.Bu),t=!0),t}qu(e,t){if(!e.fromCache)return!0;const n="Offline"!==t;return(!this.options.Ku||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Lu(e){if(e.docChanges.length>0)return!0;const t=this.Bu&&this.Bu.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}Uu(e){e=xp.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Fu=!0,this.Ou.next(e)}}class qp{constructor(e){this.key=e}}class zp{constructor(e){this.key=e}}class Hp{constructor(e,t){this.query=e,this.Yu=t,this.Xu=null,this.hasCachedResults=!1,this.current=!1,this.Zu=od(),this.mutatedKeys=od(),this.tc=Wh(e),this.ec=new Lp(this.tc)}get nc(){return this.Yu}sc(e,t){const n=t?t.ic:new Mp,i=t?t.ec:this.ec;let r=t?t.mutatedKeys:this.mutatedKeys,s=i,o=!1;const a="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,c="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((e,t)=>{const u=i.get(e),l=Gh(this.query,t)?t:null,h=!!u&&this.mutatedKeys.has(u.key),d=!!l&&(l.hasLocalMutations||this.mutatedKeys.has(l.key)&&l.hasCommittedMutations);let f=!1;u&&l?u.data.isEqual(l.data)?h!==d&&(n.track({type:3,doc:l}),f=!0):this.rc(u,l)||(n.track({type:2,doc:l}),f=!0,(a&&this.tc(l,a)>0||c&&this.tc(l,c)<0)&&(o=!0)):!u&&l?(n.track({type:0,doc:l}),f=!0):u&&!l&&(n.track({type:1,doc:u}),f=!0,(a||c)&&(o=!0)),f&&(l?(s=s.add(l),r=d?r.add(e):r.delete(e)):(s=s.delete(e),r=r.delete(e)))})),null!==this.query.limit)for(;s.size>this.query.limit;){const e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),r=r.delete(e.key),n.track({type:1,doc:e})}return{ec:s,ic:n,zi:o,mutatedKeys:r}}rc(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n){const i=this.ec;this.ec=e.ec,this.mutatedKeys=e.mutatedKeys;const r=e.ic.xu();r.sort(((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Wu()}};return n(e)-n(t)}(e.type,t.type)||this.tc(e.doc,t.doc))),this.oc(n);const s=t?this.uc():[],o=0===this.Zu.size&&this.current?1:0,a=o!==this.Xu;return this.Xu=o,0!==r.length||a?{snapshot:new xp(this.query,e.ec,i,r,e.mutatedKeys,0===o,a,!1,!!n&&n.resumeToken.approximateByteSize()>0),cc:s}:{cc:s}}Mu(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({ec:this.ec,ic:new Mp,mutatedKeys:this.mutatedKeys,zi:!1},!1)):{cc:[]}}ac(e){return!this.Yu.has(e)&&!!this.ec.has(e)&&!this.ec.get(e).hasLocalMutations}oc(e){e&&(e.addedDocuments.forEach((e=>this.Yu=this.Yu.add(e))),e.modifiedDocuments.forEach((e=>{})),e.removedDocuments.forEach((e=>this.Yu=this.Yu.delete(e))),this.current=e.current)}uc(){if(!this.current)return[];const e=this.Zu;this.Zu=od(),this.ec.forEach((e=>{this.ac(e.key)&&(this.Zu=this.Zu.add(e.key))}));const t=[];return e.forEach((e=>{this.Zu.has(e)||t.push(new zp(e))})),this.Zu.forEach((n=>{e.has(n)||t.push(new qp(n))})),t}hc(e){this.Yu=e.ir,this.Zu=od();const t=this.sc(e.documents);return this.applyChanges(t,!0)}lc(){return xp.fromInitialDocuments(this.query,this.ec,this.mutatedKeys,0===this.Xu,this.hasCachedResults)}}class Kp{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class Gp{constructor(e){this.key=e,this.fc=!1}}class Wp{constructor(e,t,n,i,r,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=i,this.currentUser=r,this.maxConcurrentLimboResolutions=s,this.dc={},this.wc=new Jh((e=>Hh(e)),zh),this._c=new Map,this.mc=new Set,this.gc=new Ol(vl.comparator),this.yc=new Map,this.Ic=new xf,this.Tc={},this.Ec=new Map,this.Ac=Df.Mn(),this.onlineState="Unknown",this.vc=void 0}get isPrimaryClient(){return!0===this.vc}}async function Qp(e,t){const n=function(e){const t=Ju(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=Xp.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=ag.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Zp.bind(null,t),t.dc.nu=Vp.bind(null,t.eventManager),t.dc.Pc=Bp.bind(null,t.eventManager),t}(e);let i,r;const s=n.wc.get(t);if(s)i=s.targetId,n.sharedClientState.addLocalQueryTarget(i),r=s.view.lc();else{const e=await function(e,t){const n=Ju(e);return n.persistence.runTransaction("Allocate target","readwrite",(e=>{let i;return n.Bs.getTargetData(e,t).next((r=>r?(i=r,Cl.resolve(i)):n.Bs.allocateTargetId(e).next((r=>(i=new Tf(t,r,"TargetPurposeListen",e.currentSequenceNumber),n.Bs.addTargetData(e,i).next((()=>i)))))))})).then((e=>{const i=n.Ji.get(e.targetId);return(null===i||e.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Ji=n.Ji.insert(e.targetId,e),n.Yi.set(t,e.targetId)),e}))}(n.localStore,$h(t)),s=n.sharedClientState.addLocalQueryTarget(e.targetId);i=e.targetId,r=await async function(e,t,n,i,r){e.Rc=(t,n,i)=>async function(e,t,n,i){let r=t.view.sc(n);r.zi&&(r=await Xf(e.localStore,t.query,!1).then((({documents:e})=>t.view.sc(e,r))));const s=i&&i.targetChanges.get(t.targetId),o=t.view.applyChanges(r,e.isPrimaryClient,s);return ng(e,t.targetId,o.cc),o.snapshot}(e,t,n,i);const s=await Xf(e.localStore,t,!0),o=new Hp(t,s.ir),a=o.sc(s.documents),c=Kd.createSynthesizedTargetChangeForCurrentChange(n,i&&"Offline"!==e.onlineState,r),u=o.applyChanges(a,e.isPrimaryClient,c);ng(e,n,u.cc);const l=new Kp(t,n,o);return e.wc.set(t,l),e._c.has(n)?e._c.get(n).push(t):e._c.set(n,[t]),u.snapshot}(n,t,i,"current"===s,e.resumeToken),n.isPrimaryClient&&vp(n.remoteStore,e)}return r}async function Jp(e,t){const n=Ju(e),i=n.wc.get(t),r=n._c.get(i.targetId);if(r.length>1)return n._c.set(i.targetId,r.filter((e=>!zh(e,t)))),void n.wc.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await Jf(n.localStore,i.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(i.targetId),wp(n.remoteStore,i.targetId),eg(n,i.targetId)})).catch(_l)):(eg(n,i.targetId),await Jf(n.localStore,i.targetId,!0))}async function Xp(e,t){const n=Ju(e);try{const e=await function(e,t){const n=Ju(e),i=t.snapshotVersion;let r=n.Ji;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(e=>{const s=n.Zi.newChangeBuffer({trackRemovals:!0});r=n.Ji;const o=[];t.targetChanges.forEach(((s,a)=>{const c=r.get(a);if(!c)return;o.push(n.Bs.removeMatchingKeys(e,s.removedDocuments,a).next((()=>n.Bs.addMatchingKeys(e,s.addedDocuments,a))));let u=c.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(a)?u=u.withResumeToken(Vl.EMPTY_BYTE_STRING,fl.min()).withLastLimboFreeSnapshotVersion(fl.min()):s.resumeToken.approximateByteSize()>0&&(u=u.withResumeToken(s.resumeToken,i)),r=r.insert(a,u),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(c,u,s)&&o.push(n.Bs.updateTargetData(e,u))}));let a=Yh(),c=od();if(t.documentUpdates.forEach((i=>{t.resolvedLimboDocuments.has(i)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,i))})),o.push(function(e,t,n){let i=od(),r=od();return n.forEach((e=>i=i.add(e))),t.getEntries(e,i).next((e=>{let i=Yh();return n.forEach(((n,s)=>{const o=e.get(n);s.isFoundDocument()!==o.isFoundDocument()&&(r=r.add(n)),s.isNoDocument()&&s.version.isEqual(fl.min())?(t.removeEntry(n,s.readTime),i=i.insert(n,s)):!o.isValidDocument()||s.version.compareTo(o.version)>0||0===s.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(s),i=i.insert(n,s)):zu("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",s.version)})),{nr:i,sr:r}}))}(e,s,t.documentUpdates).next((e=>{a=e.nr,c=e.sr}))),!i.isEqual(fl.min())){const t=n.Bs.getLastRemoteSnapshotVersion(e).next((t=>n.Bs.setTargetsMetadata(e,e.currentSequenceNumber,i)));o.push(t)}return Cl.waitFor(o).next((()=>s.apply(e))).next((()=>n.localDocuments.getLocalViewOfDocuments(e,a,c))).next((()=>a))})).then((e=>(n.Ji=r,e)))}(n.localStore,t);t.targetChanges.forEach(((e,t)=>{const i=n.yc.get(t);i&&(Qu(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?i.fc=!0:e.modifiedDocuments.size>0?Qu(i.fc):e.removedDocuments.size>0&&(Qu(i.fc),i.fc=!1))})),await sg(n,e,t)}catch(e){await _l(e)}}function Yp(e,t,n){const i=Ju(e);if(i.isPrimaryClient&&0===n||!i.isPrimaryClient&&1===n){const e=[];i.wc.forEach(((n,i)=>{const r=i.view.Mu(t);r.snapshot&&e.push(r.snapshot)})),function(e,t){const n=Ju(e);n.onlineState=t;let i=!1;n.queries.forEach(((e,n)=>{for(const e of n.listeners)e.Mu(t)&&(i=!0)})),i&&jp(n)}(i.eventManager,t),e.length&&i.dc.nu(e),i.onlineState=t,i.isPrimaryClient&&i.sharedClientState.setOnlineState(t)}}async function Zp(e,t,n){const i=Ju(e);i.sharedClientState.updateQueryState(t,"rejected",n);const r=i.yc.get(t),s=r&&r.key;if(s){let e=new Ol(vl.comparator);e=e.insert(s,hh.newNoDocument(s,fl.min()));const n=od().add(s),r=new Hd(fl.min(),new Map,new Ol(ll),e,n);await Xp(i,r),i.gc=i.gc.remove(s),i.yc.delete(t),rg(i)}else await Jf(i.localStore,t,!1).then((()=>eg(i,t,n))).catch(_l)}function eg(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const i of e._c.get(t))e.wc.delete(i),n&&e.dc.Pc(i,n);e._c.delete(t),e.isPrimaryClient&&e.Ic.Is(t).forEach((t=>{e.Ic.containsKey(t)||tg(e,t)}))}function tg(e,t){e.mc.delete(t.path.canonicalString());const n=e.gc.get(t);null!==n&&(wp(e.remoteStore,n),e.gc=e.gc.remove(t),e.yc.delete(n),rg(e))}function ng(e,t,n){for(const i of n)i instanceof qp?(e.Ic.addReference(i.key,t),ig(e,i)):i instanceof zp?(zu("SyncEngine","Document no longer in limbo: "+i.key),e.Ic.removeReference(i.key,t),e.Ic.containsKey(i.key)||tg(e,i.key)):Wu()}function ig(e,t){const n=t.key,i=n.path.canonicalString();e.gc.get(n)||e.mc.has(i)||(zu("SyncEngine","New document in limbo: "+n),e.mc.add(i),rg(e))}function rg(e){for(;e.mc.size>0&&e.gc.size<e.maxConcurrentLimboResolutions;){const t=e.mc.values().next().value;e.mc.delete(t);const n=new vl(gl.fromString(t)),i=e.Ac.next();e.yc.set(i,new Gp(n)),e.gc=e.gc.insert(n,i),vp(e.remoteStore,new Tf($h(Vh(n.path)),i,"TargetPurposeLimboResolution",kl.ct))}}async function sg(e,t,n){const i=Ju(e),r=[],s=[],o=[];i.wc.isEmpty()||(i.wc.forEach(((e,a)=>{o.push(i.Rc(a,t,n).then((e=>{if((e||n)&&i.isPrimaryClient&&i.sharedClientState.updateQueryState(a.targetId,(null==e?void 0:e.fromCache)?"not-current":"current"),e){r.push(e);const t=Hf.Li(a.targetId,e);s.push(t)}})))})),await Promise.all(o),i.dc.nu(r),await async function(e,t){const n=Ju(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(e=>Cl.forEach(t,(t=>Cl.forEach(t.Fi,(i=>n.persistence.referenceDelegate.addReference(e,t.targetId,i))).next((()=>Cl.forEach(t.Bi,(i=>n.persistence.referenceDelegate.removeReference(e,t.targetId,i)))))))))}catch(e){if(!Sl(e))throw e;zu("LocalStore","Failed to update sequence numbers: "+e)}for(const e of t){const t=e.targetId;if(!e.fromCache){const e=n.Ji.get(t),i=e.snapshotVersion,r=e.withLastLimboFreeSnapshotVersion(i);n.Ji=n.Ji.insert(t,r)}}}(i.localStore,s))}async function og(e,t){const n=Ju(e);if(!n.currentUser.isEqual(t)){zu("SyncEngine","User change. New user:",t.toKey());const e=await Wf(n.localStore,t);n.currentUser=t,function(e,t){e.Ec.forEach((e=>{e.forEach((e=>{e.reject(new Yu(Xu.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),e.Ec.clear()}(n),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await sg(n,e.er)}}function ag(e,t){const n=Ju(e),i=n.yc.get(t);if(i&&i.fc)return od().add(i.key);{let e=od();const i=n._c.get(t);if(!i)return e;for(const t of i){const i=n.wc.get(t);e=e.unionWith(i.view.nc)}return e}}class cg{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=up(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return function(e,t,n,i){return new Gf(e,t,n,i)}(this.persistence,new Kf,e.initialUser,this.serializer)}createPersistence(e){return new $f(zf.zs,this.serializer)}createSharedClientState(e){return new Zf}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class ug{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>Yp(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=og.bind(null,this.syncEngine),await async function(e,t){const n=Ju(e);t?(n.vu.delete(2),await mp(n)):t||(n.vu.add(2),await yp(n),n.bu.set("Unknown"))}(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new Up}createDatastore(e){const t=up(e.databaseInfo.databaseId),n=(i=e.databaseInfo,new ap(i));var i;return function(e,t,n,i){return new fp(e,t,n,i)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return t=this.localStore,n=this.datastore,i=e.asyncQueue,r=e=>Yp(this.syncEngine,e,0),s=tp.D()?new tp:new ep,new gp(t,n,i,r,s);var t,n,i,r,s}createSyncEngine(e,t){return function(e,t,n,i,r,s,o){const a=new Wp(e,t,n,i,r,s);return o&&(a.vc=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return async function(e){const t=Ju(e);zu("RemoteStore","RemoteStore shutting down."),t.vu.add(5),await yp(t),t.Pu.shutdown(),t.bu.set("Unknown")}(this.remoteStore)}}class lg{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Sc(this.observer.next,e)}error(e){this.observer.error?this.Sc(this.observer.error,e):Hu("Uncaught Error in snapshot listener:",e.toString())}Dc(){this.muted=!0}Sc(e,t){this.muted||setTimeout((()=>{this.muted||e(t)}),0)}}class hg{constructor(e,t,n,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=i,this.user=Bu.UNAUTHENTICATED,this.clientId=ul.A(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async e=>{zu("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(n,(e=>(zu("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user))))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Yu(Xu.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Zu;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=Pp(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function dg(e,t){e.asyncQueue.verifyOperationInProgress(),zu("FirestoreClient","Initializing OfflineComponentProvider");const n=await e.getConfiguration();await t.initialize(n);let i=n.initialUser;e.setCredentialChangeListener((async e=>{i.isEqual(e)||(await Wf(t.localStore,e),i=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e._offlineComponents=t}async function fg(e,t){e.asyncQueue.verifyOperationInProgress();const n=await async function(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){zu("FirestoreClient","Using user provided OfflineComponentProvider");try{await dg(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(e){return"FirebaseError"===e.name?e.code===Xu.FAILED_PRECONDITION||e.code===Xu.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(n))throw n;Ku("Error using user provided cache. Falling back to memory cache: "+n),await dg(e,new cg)}}else zu("FirestoreClient","Using default OfflineComponentProvider"),await dg(e,new cg);return e._offlineComponents}(e);zu("FirestoreClient","Initializing OnlineComponentProvider");const i=await e.getConfiguration();await t.initialize(n,i),e.setCredentialChangeListener((e=>Dp(t.remoteStore,e))),e.setAppCheckTokenChangeListener(((e,n)=>Dp(t.remoteStore,n))),e._onlineComponents=t}async function pg(e){const t=await async function(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(zu("FirestoreClient","Using user provided OnlineComponentProvider"),await fg(e,e._uninitializedComponentsProvider._online)):(zu("FirestoreClient","Using default OnlineComponentProvider"),await fg(e,new ug))),e._onlineComponents}(e),n=t.eventManager;return n.onListen=Qp.bind(null,t.syncEngine),n.onUnlisten=Jp.bind(null,t.syncEngine),n}function gg(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const mg=new Map;function yg(e){if(!vl.isDocumentKey(e))throw new Yu(Xu.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function vg(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Yu(Xu.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=function(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":Wu()}(e);throw new Yu(Xu.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}class wg{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new Yu(Xu.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.cache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Yu(Xu.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,i){if(!0===t&&!0===i)throw new Yu(Xu.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")})(0,e.experimentalForceLongPolling,0,e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=gg(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new Yu(Xu.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new Yu(Xu.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new Yu(Xu.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(t=this.experimentalLongPollingOptions,n=e.experimentalLongPollingOptions,t.timeoutSeconds===n.timeoutSeconds)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams;var t,n}}class Ig{constructor(e,t,n,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new wg({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Yu(Xu.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Yu(Xu.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new wg(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new tl;switch(e.type){case"firstParty":return new sl(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new Yu(Xu.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=mg.get(e);t&&(zu("ComponentProvider","Removing Datastore"),mg.delete(e),t.terminate())}(this),Promise.resolve()}}class Eg{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Tg(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Eg(this.firestore,e,this._key)}}class bg{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new bg(this.firestore,e,this._query)}}class Tg extends bg{constructor(e,t,n){super(e,t,Vh(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Eg(this.firestore,null,new vl(e))}withConverter(e){return new Tg(this.firestore,e,this._path)}}function _g(e,t,...n){if(e=R(e),1===arguments.length&&(t=ul.A()),function(e,t,n){if(!n)throw new Yu(Xu.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}("doc","path",t),e instanceof Ig){const i=gl.fromString(t,...n);return yg(i),new Eg(e,null,new vl(i))}{if(!(e instanceof Eg||e instanceof Tg))throw new Yu(Xu.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=e._path.child(gl.fromString(t,...n));return yg(i),new Eg(e.firestore,e instanceof Tg?e.converter:null,new vl(i))}}class Cg{constructor(){this.Gc=Promise.resolve(),this.Qc=[],this.jc=!1,this.zc=[],this.Wc=null,this.Hc=!1,this.Jc=!1,this.Yc=[],this.qo=new lp(this,"async_queue_retry"),this.Xc=()=>{const e=cp();e&&zu("AsyncQueue","Visibility state changed to "+e.visibilityState),this.qo.Mo()};const e=cp();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Xc)}get isShuttingDown(){return this.jc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Zc(),this.ta(e)}enterRestrictedMode(e){if(!this.jc){this.jc=!0,this.Jc=e||!1;const t=cp();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Xc)}}enqueue(e){if(this.Zc(),this.jc)return new Promise((()=>{}));const t=new Zu;return this.ta((()=>this.jc&&this.Jc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Qc.push(e),this.ea())))}async ea(){if(0!==this.Qc.length){try{await this.Qc[0](),this.Qc.shift(),this.qo.reset()}catch(e){if(!Sl(e))throw e;zu("AsyncQueue","Operation failed with retryable error: "+e)}this.Qc.length>0&&this.qo.No((()=>this.ea()))}}ta(e){const t=this.Gc.then((()=>(this.Hc=!0,e().catch((e=>{this.Wc=e,this.Hc=!1;const t=function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw Hu("INTERNAL UNHANDLED ERROR: ",t),e})).then((e=>(this.Hc=!1,e))))));return this.Gc=t,t}enqueueAfterDelay(e,t,n){this.Zc(),this.Yc.indexOf(e)>-1&&(t=0);const i=Op.createAndSchedule(this,e,t,n,(e=>this.na(e)));return this.zc.push(i),i}Zc(){this.Wc&&Wu()}verifyOperationInProgress(){}async sa(){let e;do{e=this.Gc,await e}while(e!==this.Gc)}ia(e){for(const t of this.zc)if(t.timerId===e)return!0;return!1}ra(e){return this.sa().then((()=>{this.zc.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(const t of this.zc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.sa()}))}oa(e){this.Yc.push(e)}na(e){const t=this.zc.indexOf(e);this.zc.splice(t,1)}}function Sg(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const e of["next","error","complete"])if(e in n&&"function"==typeof n[e])return!0;return!1}(e)}class kg extends Ig{constructor(e,t,n,i){super(e,t,n,i),this.type="firestore",this._queue=new Cg,this._persistenceKey=(null==i?void 0:i.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||Ag(this),this._firestoreClient.terminate()}}function Ag(e){var t,n,i;const r=e._freezeSettings(),s=function(e,t,n,i){return new Gl(e,t,n,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,gg(i.experimentalLongPollingOptions),i.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,r);e._firestoreClient=new hg(e._authCredentials,e._appCheckCredentials,e._queue,s),(null===(n=r.cache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(i=r.cache)||void 0===i?void 0:i._onlineComponentProvider)&&(e._firestoreClient._uninitializedComponentsProvider={_offlineKind:r.cache.kind,_offline:r.cache._offlineComponentProvider,_online:r.cache._onlineComponentProvider})}class Ng{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ng(Vl.fromBase64String(e))}catch(e){throw new Yu(Xu.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new Ng(Vl.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class Dg{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new Yu(Xu.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new yl(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Rg{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Yu(Xu.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Yu(Xu.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ll(this._lat,e._lat)||ll(this._long,e._long)}}const Og=new RegExp("[~\\*/\\[\\]]");function Pg(e,t,n,i,r){const s=i&&!i.isEmpty(),o=void 0!==r;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${i}`),o&&(c+=` in document ${r}`),c+=")"),new Yu(Xu.INVALID_ARGUMENT,a+e+c)}class Lg{constructor(e,t,n,i,r){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=i,this._converter=r}get id(){return this._key.path.lastSegment()}get ref(){return new Eg(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new Mg(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(xg("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class Mg extends Lg{data(){return super.data()}}function xg(e,t){return"string"==typeof t?function(e,t,n){if(t.search(Og)>=0)throw Pg(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new Dg(...t.split("."))._internalPath}catch(i){throw Pg(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}(e,t):t instanceof Dg?t._internalPath:t._delegate._internalPath}class Fg{convertValue(e,t="none"){switch(Jl(e)){case 0:return null;case 1:return e.booleanValue;case 2:return $l(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ql(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw Wu()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return Rl(e,((e,i)=>{n[e]=this.convertValue(i,t)})),n}convertGeoPoint(e){return new Rg($l(e.latitude),$l(e.longitude))}convertArray(e,t){return(e.values||[]).map((e=>this.convertValue(e,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Hl(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Kl(e));default:return null}}convertTimestamp(e){const t=jl(e);return new dl(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=gl.fromString(e);Qu(bf(n));const i=new Wl(n.get(1),n.get(3)),r=new vl(n.popFirst(5));return i.isEqual(t)||Hu(`Document ${r} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),r}}class Ug{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Vg extends Lg{constructor(e,t,n,i,r,s){super(e,t,n,i,s),this._firestore=e,this._firestoreImpl=e,this.metadata=r}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Bg(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(xg("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class Bg extends Vg{data(e={}){return super.data(e)}}class jg{constructor(e,t,n,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Ug(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new Bg(this._firestore,this._userDataWriter,n.key,n,new Ug(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Yu(Xu.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map((n=>{const i=new Bg(e._firestore,e._userDataWriter,n.doc.key,n.doc,new Ug(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:i,oldIndex:-1,newIndex:t++}}))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((e=>t||3!==e.type)).map((t=>{const i=new Bg(e._firestore,e._userDataWriter,t.doc.key,t.doc,new Ug(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let r=-1,s=-1;return 0!==t.type&&(r=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),s=n.indexOf(t.doc.key)),{type:$g(t.type),doc:i,oldIndex:r,newIndex:s}}))}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function $g(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Wu()}}class qg extends Fg{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ng(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Eg(this.firestore,null,t)}}function zg(e,...t){var n,i,r;e=R(e);let s={includeMetadataChanges:!1},o=0;"object"!=typeof t[o]||Sg(t[o])||(s=t[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges};if(Sg(t[o])){const e=t[o];t[o]=null===(n=e.next)||void 0===n?void 0:n.bind(e),t[o+1]=null===(i=e.error)||void 0===i?void 0:i.bind(e),t[o+2]=null===(r=e.complete)||void 0===r?void 0:r.bind(e)}let c,u,l;if(e instanceof Eg)u=vg(e.firestore,kg),l=Vh(e._key.path),c={next:n=>{t[o]&&t[o](function(e,t,n){const i=n.docs.get(t._key),r=new qg(e);return new Vg(e,r,t._key,i,new Ug(n.hasPendingWrites,n.fromCache),t.converter)}(u,e,n))},error:t[o+1],complete:t[o+2]};else{const n=vg(e,bg);u=vg(n.firestore,kg),l=n._query;const i=new qg(u);c={next:e=>{t[o]&&t[o](new jg(u,i,n,e))},error:t[o+1],complete:t[o+2]},function(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new Yu(Xu.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}(e._query)}return function(e,t,n,i){const r=new lg(i),s=new $p(t,r,n);return e.asyncQueue.enqueueAndForget((async()=>async function(e,t){const n=Ju(e),i=t.query;let r=!1,s=n.queries.get(i);if(s||(r=!0,s=new Fp),r)try{s.Nu=await n.onListen(i)}catch(e){const n=Pp(e,`Initialization of query '${Kh(t.query)}' failed`);return void t.onError(n)}n.queries.set(i,s),s.listeners.push(t),t.Mu(n.onlineState),s.Nu&&t.$u(s.Nu)&&jp(n)}(await pg(e),s))),()=>{r.Dc(),e.asyncQueue.enqueueAndForget((async()=>async function(e,t){const n=Ju(e),i=t.query;let r=!1;const s=n.queries.get(i);if(s){const e=s.listeners.indexOf(t);e>=0&&(s.listeners.splice(e,1),r=0===s.listeners.length)}if(r)return n.queries.delete(i),n.onUnlisten(i)}(await pg(e),s)))}}(function(e){return e._firestoreClient||Ag(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}(u),l,a,c)}!function(e,t=!0){!function(e){ju=e}(Ie),me(new O("firestore",((e,{instanceIdentifier:n,options:i})=>{const r=e.getProvider("app").getImmediate(),s=new kg(new il(e.getProvider("auth-internal")),new al(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new Yu(Xu.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Wl(e.options.projectId,t)}(r,n),r);return i=Object.assign({useFetchStreams:t},i),s._setSettings(i),s}),"PUBLIC").setMultipleInstances(!0)),Te(Vu,"3.13.0",e),Te(Vu,"3.13.0","esm2017")}();var Hg,Kg,Gg="name",Wg="",Qg=!0,Jg=Ee({apiKey:"AIzaSyCVjRKS0WeLA_fnynwNi_drATF-e3obPRs",authDomain:"gotcha-game.firebaseapp.com",projectId:"gotcha-game",storageBucket:"gotcha-game.appspot.com",messagingSenderId:"256024212174",appId:"1:256024212174:web:311f96879a83db86d4d69f",measurementId:"G-3BKQPBWZBK"}),Xg=(function(e=be()){const t=ye(e=R(e),Ut);t.isInitialized()?t.getImmediate():function(e,t={}){const n=ye(e,Ut);if(n.isInitialized()){const e=n.getImmediate();if(w(t,n.getOptions()))return e;throw Ht.create("already-initialized")}n.initialize({options:t})}(e)}(Jg),new nr),Yg=function(e=be()){const t=ye(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=ye(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(w(n.getOptions(),null!=t?t:{}))return e;Fn(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:ds,persistence:[Nr,dr,pr]}),i=l("authTokenSyncURL");if(i){const e=(r=i,async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>ms)return;const i=null==t?void 0:t.token;ys!==i&&(ys=i,await fetch(r,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});!function(e,t,n){R(e).beforeAuthStateChanged(t,n)}(n,e,(()=>e(n.currentUser))),function(t,n,i,r){R(t).onIdTokenChanged((t=>e(t)),void 0,void 0)}(n)}var r;const s=a("auth");return s&&function(e,t,n){const i=Bi(e);jn(i._canInitEmulator,i,"emulator-config-failed"),jn(/^https?:\/\//.test(t),i,"invalid-emulator-scheme");const r=!!(null==n?void 0:n.disableWarnings),s=$i(t),{host:o,port:a}=function(e){const t=$i(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const e=r[1];return{host:e,port:qi(i.substr(e.length+1))}}{const[e,t]=i.split(":");return{host:e,port:qi(t)}}}(t),c=null===a?"":`:${a}`;i.config.emulator={url:`${s}//${o}${c}/`},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})}),r||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}(n,`http://${s}`),n}(),Zg=function(e=be(),t=_n){const n=ye(R(e),In).getImmediate({identifier:t}),i=c("functions");return i&&function(e,t,n){!function(e,t,n){e.emulatorOrigin=`http://${t}:${n}`}(R(e),t,n)}(n,...i),n}(Jg),em=function(e,t){const n="string"==typeof e?e:"(default)",i=ye("object"==typeof e?e:be(),"firestore").getImmediate({identifier:n});if(!i._initialized){const e=c("firestore");e&&function(e,t,n,i={}){var s;const o=(e=vg(e,Ig))._getSettings(),a=`${t}:${n}`;if("firestore.googleapis.com"!==o.host&&o.host!==a&&Ku("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},o),{host:a,ssl:!1})),i.mockUserToken){let t,n;if("string"==typeof i.mockUserToken)t=i.mockUserToken,n=Bu.MOCK_USER;else{t=function(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",i=e.iat||0,s=e.sub||e.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},e);return[r(JSON.stringify({alg:"none",type:"JWT"})),r(JSON.stringify(o)),""].join(".")}(i.mockUserToken,null===(s=e._app)||void 0===s?void 0:s.options.projectId);const o=i.mockUserToken.sub||i.mockUserToken.user_id;if(!o)throw new Yu(Xu.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new Bu(o)}e._authCredentials=new nl(new el(t,n))}}(i,...e)}return i}(Jg);function tm(){Dn(Zg,"queryTarget")().then((function(e){null!==e&&null!==e.data?(console.log("Query target result: ",e.data),function(e,t,n,i,r,s,o){document.getElementById("signInTitle").style.display="none",document.getElementById("loading").style.display="none";for(var a=0,c=document.getElementsByClassName("game");a<c.length;a++)c[a].style.display="";for(var u=0,l=document.getElementsByClassName("stats");u<l.length;u++)l[u].style.display="";document.getElementById("round").innerHTML="Round #"+t,e===i?(document.getElementById("alive").innerHTML="Congrats!",document.getElementById("target").innerHTML="You are the last player alive.",document.getElementById("eliminating").style.display="none"):(document.getElementById("alive").innerHTML="You are "+(n?"alive":"out"),n?(document.getElementById("target").innerHTML="Your target is "+r,s?(document.getElementById("eliminate").style.display="none",document.getElementById("eliminating").style.display=""):(document.getElementById("eliminate").style.display="",document.getElementById("eliminating").style.display="none")):(document.getElementById("target").innerHTML="Thanks for playing!",document.getElementById("eliminating").style.display="none")),o&&(document.getElementById("aliveStats").innerHTML="Players Alive: ".concat(o.alive),document.getElementById("eliminatedStats").innerHTML="Players Out: ".concat(o.eliminated),document.getElementById("eliminatedThisRoundStats").innerHTML="Players Eliminated This Round: ".concat(o.eliminatedThisRound))}(e.data.email,e.data.round,e.data.alive,e.data.targetEmail,e.data.targetName,e.data.eliminating,e.data.stats)):console.log("Query target result is null")})).catch((function(e){console.log(e)}))}function nm(){return document.getElementById("newGameForm").style.display="",document.getElementById("creatingNewGame").style.display="none",!1}document.getElementById("signIn").onclick=function(){Hr(Yg,Xg),document.getElementById("signIn").style.display="none",document.getElementById("signingIn").style.display=""},document.getElementById("signOut").onclick=function(){confirm("Are you sure you want to sign out?")&&(document.getElementById("signOut").style.visibility="hidden",document.getElementById("signingOut").style.display="",Hg&&Hg(),Kg&&Kg(),function(e){return R(e).signOut()}(Yg).then((function(){document.getElementById("signingOut").style.display="none"})).catch((function(e){console.log("Error signing out: ",e)})))},function(e,t,n,i){R(e).onAuthStateChanged((function(e){if(e){var t=e.displayName;document.getElementById("name").innerHTML+=t,document.getElementById("signIn").style.display="none",document.getElementById("signingIn").style.display="none",document.getElementById("signOut").style.visibility="",document.getElementById("signingOut").style.display="none",document.getElementById("loading").style.display="",e.getIdTokenResult().then((function(e){if(e.claims.admin)for(var t=0,n=document.getElementsByClassName("admin");t<n.length;t++){var i=n[t];i.id.startsWith("creating")||i.id.startsWith("making")||i.id.startsWith("removing")||(i.style.display="")}})),tm(),Hg&&Hg(),Hg=zg(_g(em,"activeGame",Gg),(function(e){e.metadata.hasPendingWrites||(Wg=e.data()[Gg],Kg&&Kg(),Kg=zg(_g(em,Wg,"update"),(function(e){e.metadata.hasPendingWrites||(Qg?Qg=!1:tm())})))}))}else{console.log("Auth state changed to null. Most likely the user signed out."),document.getElementById("signInTitle").style.display="",document.getElementById("signIn").style.display="",document.getElementById("signingIn").style.display="none",document.getElementById("signOut").style.visibility="hidden",document.getElementById("signingOut").style.display="none";for(var n=0,i=document.getElementsByClassName("game");n<i.length;n++)i[n].style.display="none";document.getElementById("eliminate").style.display="none";for(var r=0,s=document.getElementsByClassName("stats");r<s.length;r++)s[r].style.display="none";for(var o=0,a=document.getElementsByClassName("admin");o<a.length;o++)a[o].style.display="none"}}),void 0,void 0)}(Yg),document.getElementById("eliminate").onclick=function(){confirm("Are you sure you want to eliminate your target?")&&(document.getElementById("eliminate").style.display="none",document.getElementById("eliminating").style.display="",Dn(Zg,"eliminateTarget")().catch((function(e){console.log(e),alert("Error eliminating target: "+e)})))},document.getElementById("newRoundButton").onclick=function(){if(confirm("Are you sure you want to finish this round and start the next round?")){var e=document.getElementById("newRoundRandomize").checked;confirm("Creating a new round with randomization ".concat(e,". Confirm the randomization is correct."))&&(document.getElementById("newRoundButton").style.display="none",document.getElementById("creatingNewRound").style.display="",Dn(Zg,"newRound")({randomize:e}).catch((function(e){alert("Error creating new round: "+e),console.log(e)})).finally((function(){document.getElementById("newRoundButton").style.display="",document.getElementById("creatingNewRound").style.display="none"})))}},document.getElementById("newGameForm").onsubmit=function(){if(document.getElementById("newGameForm").style.display="none",document.getElementById("creatingNewGame").style.display="",!confirm("Are you sure you want to finish this game and start a new game?"))return nm();try{var e=document.getElementById("newGameName").value,t=document.getElementById("emailsField").value,n=document.getElementById("newGameRandomize").checked;if(!e)return alert("Error creating new game: Game name is empty."),nm();if(!t)return alert("Error creating new game: Emails and names are empty."),nm();if(!confirm("Creating a new game with randomization ".concat(n,". Confirm the randomization is correct.")))return nm();var i=t.split("\n");if(!confirm("Creating a new game with ".concat(i.length," players. Confirm the player count is correct.")))return nm();for(var r={},s=0;s<i.length;s++){var o=i[s];if(!o)return alert("Error creating new game: Line ".concat(s+1," is empty.")),nm();var a=o.split("\t");if(a.length>2)return alert("Error creating new game: Line ".concat(s+1," has too many tabs. Check that you only pasted the email and name columns and that there are no tabs except between the email and name.")),nm();if(1===a.length&&(a=o.split(",")),a.length>2)return alert("Error creating new game: Line ".concat(s+1," has too many commas. Check that you only pasted the email and name columns and that there are no commas except between the email and name.")),nm();if(1===a.length)return alert("Error creating new game: Line ".concat(s+1," is missing a comma or tab. Check that you pasted the email and name columns and that the email and name are separated by a comma or tab.")),nm();var c=a[0].trim(),u=a[1].trim();if(!c)return alert("Error creating new game: Line ".concat(s+1," email is empty.")),nm();if(!u)return alert("Error creating new game: Line ".concat(s+1," name is empty.")),nm();if(!c.includes("@")||!c.includes("."))return alert("Error creating new game: Line ".concat(s+1," email is invalid.")),nm();if(r[c])return alert("Error creating new game: Line ".concat(s+1," email already exists. Check for duplicate emails.")),nm();r[c]=u}return console.log("Creating new game with name '".concat(e,"' and players: "),r),Dn(Zg,"newGame")({newGameName:e,emailsAndNames:r,randomize:n}).catch((function(e){console.log(e),alert("Error creating new game: "+e)})).finally((function(){document.getElementById("newGameName").value="",document.getElementById("emailsField").value="",document.getElementById("newGameForm").style.display="",document.getElementById("creatingNewGame").style.display="none"})),!1}catch(e){return console.log(e),alert("Error creating new game: "+e),nm()}},document.getElementById("adminForm").onsubmit=function(){if(!confirm("Are you sure you want to make this user an admin?"))return!1;document.getElementById("adminForm").style.display="none",document.getElementById("makingAdmin").style.display="";var e=document.getElementById("adminUID").value;return Dn(Zg,"makeAdmin")(e).then((function(){console.log("Successfully made admin")})).catch((function(e){console.log(e),alert("Error making admin: "+e)})).finally((function(){document.getElementById("adminForm").style.display="",document.getElementById("makingAdmin").style.display="none"})),!1},document.getElementById("removeAdminForm").onsubmit=function(){if(!confirm("Are you sure you want to remove this user's admin privileges?"))return!1;document.getElementById("removeAdminForm").style.display="none",document.getElementById("removingAdmin").style.display="";var e=document.getElementById("removeAdminUID").value;return Dn(Zg,"removeAdmin")(e).then((function(){console.log("Successfully removed admin")})).catch((function(e){console.log(e),alert("Error removing admin: "+e)})).finally((function(){document.getElementById("removeAdminForm").style.display="",document.getElementById("removingAdmin").style.display="none"})),!1}})();